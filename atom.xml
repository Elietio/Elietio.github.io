<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>é›¶ã®è½¨è¿¹</title>
  
  <subtitle>Sic Parvis Magna</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.elietio.xyz/"/>
  <updated>2020-06-14T02:35:21.561Z</updated>
  <id>https://www.elietio.xyz/</id>
  
  <author>
    <name>Elietio</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¸€æ¬¡druidè¿æ¥æ± è·å–è¿æ¥é”™è¯¯çš„æ’æŸ¥åˆ†æ</title>
    <link href="https://www.elietio.xyz/posts/ceaacf5f.html"/>
    <id>https://www.elietio.xyz/posts/ceaacf5f.html</id>
    <published>2020-03-19T09:02:26.000Z</published>
    <updated>2020-06-14T02:35:21.561Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h3><p>ä¹‹å‰çš„ä¸Šä¸€ç¯‡æ–‡ç«  <a href="https://www.elietio.xyz/posts/fd295ff1.html">keepAliveè§£å†³druidç©ºé—²è¿æ¥socket timeout 15åˆ†é’Ÿ</a>è§£å†³äº†é˜²ç«å¢™å¯¼è‡´çš„ç©ºé—²è¿æ¥socket timeoutçš„é—®é¢˜ï¼Œè€Œè¿™ä¸€æ¬¡åœ¨å¦å¤–ä¸€ä¸ªæ²¡æœ‰é˜²ç«å¢™ç­–ç•¥çš„å†…éƒ¨ç¯å¢ƒå´åˆå‡ºç°äº†å¦å¤–ä¸€ä¸ªæƒ…å†µï¼Œè¿›ç¨‹å¶å‘æ•°æ®åº“æ“ä½œæŠ¥é”™ï¼Œå¹¶ä¸”ä¸ªåˆ«è¿›ç¨‹ä¸€æ®µæ—¶é—´åå§‹ç»ˆæ— æ³•è·å–æ•°æ®åº“è¿æ¥ä¸€ç›´å¤„äºå®•æœºçŠ¶æ€ã€‚<br><a id="more"></a></p><h3 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h3><p>é€šè¿‡å¯¹é”™è¯¯æ—¥å¿—åˆ†æï¼Œå‘ç°å‰æœŸæ•°æ®åº“æŠ¥é”™çš„æ—¥å¿—å››ä¸ªè¿›ç¨‹å‡ºç°çš„æ—¶é—´ç‚¹åŸºæœ¬ä¸€è‡´ï¼Œå› æ­¤æ€€ç–‘æ˜¯å¤–éƒ¨å› ç´ ç½‘ç»œæˆ–è€…æ•°æ®åº“å¯¼è‡´ã€‚éƒ¨åˆ†è¿›ç¨‹ç»´æŒç€å¶å‘æŠ¥é”™çš„æƒ…å†µä¸‹å·¥ä½œï¼Œè€Œæœ‰çš„è¿›ç¨‹åˆ™åœ¨ä¸€æ®µæ—¶é—´åå½»åº•æ— æ³•å·¥ä½œï¼Œä¸€ç›´å‡ºç°æ— æ³•åˆ›å»ºæ•°æ®åº“è¿æ¥ã€‚äºæ˜¯é¦–å…ˆå¯¹æ— æ³•å·¥ä½œçš„è¿›ç¨‹åˆ†ææ’æŸ¥ã€‚<br>é¦–å…ˆï¼ŒæŸ¥çœ‹è¿›ç¨‹ä¸æ•°æ®åº“è¿æ¥çŠ¶æ€ï¼Œå‘ç°å­˜åœ¨<code>ESTABLISHED</code>çŠ¶æ€è¿æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netstat -anp|grep 1521</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)            </span><br><span class="line">tcp6       0      0 172.16.72.25:18704      172.16.71.13:1521       ESTABLISHED 9229/java</span><br></pre></td></tr></table></figure><p> è€Œé”™è¯¯æ—¥å¿—æ˜¾ç¤º<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.PersistenceException: </span><br><span class="line"> Error querying database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis <span class="number">60000</span>, active <span class="number">0</span>, maxActive <span class="number">20</span>, creating <span class="number">1</span> </span><br><span class="line"> .......</span><br><span class="line"> Caused by: java.sql.SQLRecoverableException: IO Error: Connection reset</span><br><span class="line">        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:<span class="number">498</span>)</span><br><span class="line">        at oracle.jdbc.driver.PhysicalConnection.&lt;init&gt;(PhysicalConnection.java:<span class="number">553</span>)</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°å½“å‰æ•°æ®åº“è¿æ¥æ± ä¸­æ²¡æœ‰å¯ç”¨è¿æ¥ï¼Œdruidåœ¨åˆ›å»ºæ–°è¿æ¥çš„æ—¶å€™å‡ºç°å¼‚å¸¸ã€‚<br>æŸ¥çœ‹druidåˆ›å»ºè¿æ¥ç›¸å…³æºç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (maxWait &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    holder = pollLast(nanos); </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    holder = takeLast();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> DruidConnectionHolder <span class="title">pollLast</span><span class="params">(<span class="keyword">long</span> nanos)</span> <span class="keyword">throws</span> InterruptedException, SQLException </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> estimate = nanos;</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (poolingCount == <span class="number">0</span>) &#123;</span><br><span class="line">            emptySignal(); <span class="comment">// send signal to CreateThread create connection</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (failFast &amp;&amp; failContinuous.get()) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> DataSourceNotAvailableException(createError);</span><br><span class="line">            &#125;</span><br><span class="line">            ......</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">long</span> startEstimate = estimate;</span><br><span class="line">                estimate = notEmpty.awaitNanos(estimate); <span class="comment">// signal by</span></span><br><span class="line">                                                          <span class="comment">// recycle or</span></span><br><span class="line">                                                          <span class="comment">// creator</span></span><br><span class="line">              ......  </span><br><span class="line">               <span class="keyword">return</span> last;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“druidçš„è¿æ¥è·å–æ˜¯é€šè¿‡<code>notEmpty</code>å’Œ<code>empty</code>ä¸¤ä¸ªå˜é‡åè°ƒçº¿ç¨‹çš„åŒæ­¥ï¼Œæ‰§è¡Œ<code>pollLast</code>æ–¹æ³•å‘ç°æ²¡å¯ç”¨è¿æ¥æ—¶ï¼Œå°±ä¼š<code>notEmpty.awaitNanos()</code>,åŒæ—¶<code>empty.signal()</code>å»å”¤é†’<code>CreateConnectionThread</code>è¿™ä¸ªçº¿ç¨‹å»åˆ›å»ºè¿æ¥ã€‚</p><p>å› æ­¤ï¼ŒæŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å †æ ˆä¿¡æ¯ï¼Œæ‰¾åˆ°<code>CreateConnectionThread</code>çº¿ç¨‹ã€‚<br>å‘ç°å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">"Druid-ConnectionPool-Create-523528914" #83 daemon prio=5 os_prio=0 tid=0x00007f6d1d8d4800 nid=0x26fb runnable [0x00007f6db3ffd000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">        at java.net.SocketInputStream.socketRead0(Native Method)</span><br><span class="line">        at java.net.SocketInputStream.socketRead(SocketInputStream.java:<span class="number">116</span>)</span><br><span class="line">        at java.net.SocketInputStream.read(SocketInputStream.java:<span class="number">170</span>)</span><br><span class="line">        at java.net.SocketInputStream.read(SocketInputStream.java:<span class="number">141</span>)</span><br><span class="line">   ......</span><br><span class="line">        at oracle.jdbc.driver.T4CSocketInputStreamWrapper.readNextPacket(T4CSocketInputStreamWrapper.java:<span class="number">124</span>)</span><br><span class="line">        at oracle.jdbc.driver.T4CSocketInputStreamWrapper.read(T4CSocketInputStreamWrapper.java:<span class="number">80</span>)</span><br><span class="line">        at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:<span class="number">1137</span>)</span><br><span class="line">    ....</span><br><span class="line">        at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:<span class="number">150</span>)</span><br><span class="line">        at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:<span class="number">1560</span>)</span><br><span class="line">        at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:<span class="number">1623</span>)</span><br><span class="line">        at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:<span class="number">2468</span>)</span><br></pre></td></tr></table></figure><p> è€Œå½“å‰å·¥ä½œçº¿ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">"http-nio-8212-exec-7" #72 daemon prio=5 os_prio=0 tid=0x00007f6d46caa800 nid=0x26ea waiting on condition [0x00007f6db90ea000]</span><br><span class="line">   java.lang.Thread.State: TIMED_WAITING (parking)</span><br><span class="line">        at sun.misc.Unsafe.park(Native Method)</span><br><span class="line">        - parking to wait <span class="keyword">for</span>  &lt;<span class="number">0x00000006c23e65c8</span>&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)</span><br><span class="line">        at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:<span class="number">215</span>)</span><br><span class="line">        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:<span class="number">2078</span>)</span><br><span class="line">        at com.alibaba.druid.pool.DruidDataSource.pollLast(DruidDataSource.java:<span class="number">1946</span>)</span><br><span class="line">        at com.alibaba.druid.pool.DruidDataSource.getConnectionInternal(DruidDataSource.java:<span class="number">1458</span>)</span><br><span class="line">        at com.alibaba.druid.pool.DruidDataSource.getConnectionDirect(DruidDataSource.java:<span class="number">1255</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå·¥ä½œçº¿ç¨‹æ‰§è¡Œ<code>pollLast</code>æ–¹æ³•å»å”¤é†’<code>Druid-ConnectionPool-Create</code>çº¿ç¨‹ï¼Œ<code>Druid-ConnectionPool-Create</code>çº¿ç¨‹å¼€å§‹å°è¯•è¿æ¥æ•°æ®åº“ï¼Œä½†æ˜¯çº¿ç¨‹ä¸€ç›´å‡ºç°äº†   socketRead0é˜»å¡ï¼Œå¯¼è‡´æ— æ³•åˆ›å»ºè¿æ¥ï¼Œå› æ­¤å·¥ä½œçº¿ç¨‹ä¼šä¸€ç›´waitingç›´åˆ°è·å–è¿æ¥è¶…æ—¶æŠ¥é”™ã€‚è€Œ <code>Druid-ConnectionPool-Create</code>çº¿ç¨‹é€šè¿‡jdbcè¿æ¥æ•°æ®åº“æ˜¯ä½¿ç”¨Socketé€šä¿¡çš„ï¼ŒSocketæ²¡æœ‰åŠæ³•æ¢æµ‹åˆ°ç½‘ç»œé”™è¯¯ï¼Œå› æ­¤åº”ç”¨ä¹Ÿæ— æ³•ä¸»åŠ¨å‘ç°è¿æ¥é”™è¯¯ï¼Œå®ƒçš„è¶…æ—¶æ˜¯ç”±Socket Timeoutæ§åˆ¶çš„ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®Socket Timeoutåœ¨æ²¡æœ‰è¿”å›çš„æƒ…å†µä¸‹ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»,æ‰€ä»¥å½“æ•°æ®åº“æˆ–è€…ç½‘ç»œçªç„¶å‡ºç°æ•…éšœï¼Œå°±å¯èƒ½ä¼šå‘ç”Ÿsocketé˜»å¡ï¼Œè€Œå¦‚æœæ²¡æœ‰socket timeoutè®¾ç½®ï¼Œé‚£ä¹ˆé˜»å¡å°†ä¸€ç›´æŒç»­ä¸‹å»ã€‚è¿™æ ·å§‹ç»ˆæ— æ³•åˆ›å»ºè¿æ¥ï¼Œæ‰€ä»¥è¿›ç¨‹ä¸å¯ç”¨ã€‚ï¼ˆä¸€èˆ¬æ¥è¯´LinuxæœåŠ¡å™¨ä¼šæœ‰ç³»ç»Ÿçº§åˆ«çš„socket timeoutï¼Œç”±äºæ²¡æœ‰æƒé™æŸ¥çœ‹ä¸äº†ï¼Œä»ä¸Šé¢ä¿¡æ¯æ¨æµ‹è®¾ç½®çš„å¯èƒ½è¾ƒé•¿ï¼‰</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆæœ‰çš„è¿›ç¨‹åªæ˜¯å¶å‘æ•…éšœï¼Œè€Œåæ¢å¤å‘¢ï¼Ÿé€šè¿‡æ—¥å¿—æŸ¥çœ‹ï¼Œå‘ç°è¿™ç§æƒ…å†µçš„æƒ…å†µåœ¨æŠ¥é”™çš„æ—¶å€™ï¼Œè¿æ¥æ± å½“å‰è¿˜å­˜åœ¨ç€ä¸€ä¸ªè¿æ¥ï¼Œå³ä½¿è¿æ¥æ± åˆ›å»ºæ–°çš„è¿æ¥æŠ¥é”™ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå½±å“è¯¥è¿æ¥ï¼Œæ‰€ä»¥ç½‘ç»œæ¢å¤åï¼Œè¯¥è¿æ¥ä»ç„¶å¯ç”¨ï¼Œåªæ˜¯æ— æ³•å†åˆ›å»ºæ–°çš„è¿æ¥è€Œå·²ï¼Œæ‰€ä»¥è¿›ç¨‹ä½“ç°åœ¨å¶å‘æŠ¥é”™ï¼Œä½†æ˜¯ä»ç„¶å¯ç”¨ã€‚è€Œå½“è¿™ä¸ªè¿æ¥ç©ºé—²å¾ˆé•¿æ—¶é—´æˆ–è€…å› ä¸ºå…¶ä»–åŸå› æ­»äº¡åï¼Œé‚£ä¹ˆè¿æ¥æ± å°†å†æ— è¿æ¥å¯ç”¨ï¼Œä¹Ÿæ— æ³•åˆ›å»ºæ–°çš„è¿æ¥ï¼Œè¿›ç¨‹å˜æˆäº†ä¸å¯ç”¨çŠ¶æ€ã€‚<br>ä»¥ä¸Šå°±æ˜¯åŸºäºæ—¥å¿—åˆ†æã€è¿›ç¨‹å †æ ˆå’Œè¿æ¥ä¿¡æ¯æ’æŸ¥åšå‡ºçš„æ¨æµ‹ã€‚</p><h3 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h3><p>åŸºäºä¸Šé¢æ¨æµ‹ï¼Œé—®é¢˜ä¸»è¦å‡ºç°åœ¨socketé˜»å¡ï¼Œå› æ­¤è§£å†³æ–¹æ¡ˆå°±æ˜¯å°½é‡é¿å…socketé˜»å¡è¿‡é•¿æ—¶é—´ï¼Œå¯¼è‡´é•¿æ—¶é—´ä¸å¯ç”¨ã€‚</p><h4 id="ä¸´æ—¶åº”æ€¥æ“ä½œ"><a href="#ä¸´æ—¶åº”æ€¥æ“ä½œ" class="headerlink" title="ä¸´æ—¶åº”æ€¥æ“ä½œ"></a>ä¸´æ—¶åº”æ€¥æ“ä½œ</h4><p>å¦‚æœå‘ç”Ÿé˜»å¡ï¼Œåªéœ€è¦é‡å¯è¿›ç¨‹å³å¯ä¸´æ—¶è§£å†³é—®é¢˜ï¼Œå¦‚æœä¸æƒ³è¦è¿›ç¨‹é‡å¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡æ€æ‰é˜»å¡çš„socketæ¥é‡è¿æ•°æ®åº“ã€‚</p><p>é¦–å…ˆé€šè¿‡<code>lsof</code> å‘½ä»¤æ‰¾åˆ°è¿›ç¨‹çš„æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦ï¼Œå¹¶ä¸”æ‰¾åˆ°é˜»å¡çš„socketçš„è¿æ¥ï¼Œç„¶å<code>gdb</code>è¿æ¥è¿›ç¨‹ï¼Œ<code>call close</code>æ‰è¿™ä¸ªsocketè¿æ¥ï¼Œè¿™æ ·<code>Druid-ConnectionPool-Create</code>çº¿ç¨‹å¯ä»¥å†é‡æ–°åˆ›å»ºè¿æ¥ã€‚</p><h4 id="è®¾ç½®jdbcçº§åˆ«çš„timeouté˜²æ­¢é•¿æ—¶é—´é˜»å¡"><a href="#è®¾ç½®jdbcçº§åˆ«çš„timeouté˜²æ­¢é•¿æ—¶é—´é˜»å¡" class="headerlink" title="è®¾ç½®jdbcçº§åˆ«çš„timeouté˜²æ­¢é•¿æ—¶é—´é˜»å¡"></a>è®¾ç½®jdbcçº§åˆ«çš„timeouté˜²æ­¢é•¿æ—¶é—´é˜»å¡</h4><p>é•¿ä¹…çš„è§£å†³æ€è·¯è‚¯å®šæ˜¯è®¾ç½®ä¸€ä¸ªåˆé€‚çš„socket timeoutæ¥é¿å…socketé˜»å¡ï¼Œä¸€èˆ¬ä¼šæœ‰ç³»ç»Ÿç¯å¢ƒç›¸å…³è®¾ç½®ï¼Œä¸ºäº†é¢„é˜²ç³»ç»Ÿsocket timeoutè¿‡é•¿æˆ–è€…æ²¡æœ‰è®¾ç½®ï¼Œè¿˜æ˜¯æœ‰å¿…è¦è®¾ç½®ä¸€ä¸ªjdbcçº§åˆ«çš„timeoutã€‚</p><p>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ˜¯é€šè¿‡å¼€å¯<code>keepAlive</code>æ¥è§£å†³é—®é¢˜çš„ï¼Œå…¶ä¸­æˆ‘ä¹Ÿæåˆ°ä¸å»ºè®®é€šè¿‡ä¿®æ”¹ <code>socket timeout</code> å»è§£å†³ã€‚è€Œè¿™æ¬¡çš„è¿™ä¸ªé—®é¢˜å°±å¿…é¡»è¦é€šè¿‡è®¾ç½®ä¸€ä¸ªåˆç†çš„ <code>socket timeout</code>  å‚æ•°æ¥ä¿è¯å½“å‡ºç°å¼‚å¸¸ç½‘è·¯æƒ…å†µä¸‹æœåŠ¡ä¸ä¼šå®•æœºå¤ªä¹…ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶é—´åˆä¸èƒ½è¿‡å°ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¸€äº›è€—æ—¶è¾ƒé•¿çš„æ•°æ®åº“æ“ä½œè¢«è¶…æ—¶ç»ˆæ­¢ï¼Œé…ç½®å‚è€ƒå¦‚ä¸‹ã€‚</p><p>oracleï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">connectionProperties:</span> <span class="string">oracle.net.CONNECT_TIMEOUT=60000;oracle.jdbc.ReadTimeout=300000</span></span><br></pre></td></tr></table></figure><p>mysqlï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="attr">jdbc:mysql://ip:port/db?connectTimeout=60000&amp;socketTimeout=300000</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°&lt;/h3&gt;&lt;p&gt;ä¹‹å‰çš„ä¸Šä¸€ç¯‡æ–‡ç«  &lt;a href=&quot;https://www.elietio.xyz/posts/fd295ff1.html&quot;&gt;keepAliveè§£å†³druidç©ºé—²è¿æ¥socket timeout 15åˆ†é’Ÿ&lt;/a&gt;è§£å†³äº†é˜²ç«å¢™å¯¼è‡´çš„ç©ºé—²è¿æ¥socket timeoutçš„é—®é¢˜ï¼Œè€Œè¿™ä¸€æ¬¡åœ¨å¦å¤–ä¸€ä¸ªæ²¡æœ‰é˜²ç«å¢™ç­–ç•¥çš„å†…éƒ¨ç¯å¢ƒå´åˆå‡ºç°äº†å¦å¤–ä¸€ä¸ªæƒ…å†µï¼Œè¿›ç¨‹å¶å‘æ•°æ®åº“æ“ä½œæŠ¥é”™ï¼Œå¹¶ä¸”ä¸ªåˆ«è¿›ç¨‹ä¸€æ®µæ—¶é—´åå§‹ç»ˆæ— æ³•è·å–æ•°æ®åº“è¿æ¥ä¸€ç›´å¤„äºå®•æœºçŠ¶æ€ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="druid" scheme="https://www.elietio.xyz/tags/druid/"/>
    
      <category term="socket timeout" scheme="https://www.elietio.xyz/tags/socket-timeout/"/>
    
  </entry>
  
  <entry>
    <title>Logback totalSizeCapä¸ç”Ÿæ•ˆçš„ä¸¤ä¸ªbug</title>
    <link href="https://www.elietio.xyz/posts/f6b1711c.html"/>
    <id>https://www.elietio.xyz/posts/f6b1711c.html</id>
    <published>2020-02-26T11:11:44.000Z</published>
    <updated>2020-06-13T08:18:25.218Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="é—®é¢˜æè¿°ï¼š"><a href="#é—®é¢˜æè¿°ï¼š" class="headerlink" title="é—®é¢˜æè¿°ï¼š"></a>é—®é¢˜æè¿°ï¼š</h3><p>çº¿ä¸Šçš„ä¸€ä¸ªæ•°æ®æ¥æ”¶æœåŠ¡æœ€è¿‘æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œæ—¥å¿—ä¹Ÿæ‰“çš„å¾ˆé¢‘ç¹ï¼Œä½†æ˜¯å´å‡ºç°äº†totalSizeCapé…ç½®ä¸ç”Ÿæ•ˆï¼Œæ— æ³•åˆ é™¤æ—¥å¿—æ–‡ä»¶çš„é—®é¢˜ï¼Œæ¯å¤©æ—¥å¿—ä¸€åº¦å›æ»šç´¯è®¡åˆ°å‡ åƒä¸ª ã€‚<br><a id="more"></a></p><p>æ—¥å¿—è®¾ç½®maxHistory 30,maxFileSize 20MB,totalSizeCap 5GB</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">        $&#123;logger.path&#125;/all.%d&#123;yy-MM-dd&#125;.%i.log</span><br><span class="line">    <span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>20MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">totalSizeCap</span>&gt;</span>5GB<span class="tag">&lt;/<span class="name">totalSizeCap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="é—®é¢˜æ’æŸ¥ï¼š"><a href="#é—®é¢˜æ’æŸ¥ï¼š" class="headerlink" title="é—®é¢˜æ’æŸ¥ï¼š"></a>é—®é¢˜æ’æŸ¥ï¼š</h3><p>é¢å‘GoogleæŸ¥è¯¢ç›¸å…³é—®é¢˜ï¼Œçœ‹åˆ°ä¸€ä¸ªlogbackæ— æ³•å¤„ç†totalSizeCap è¶…è¿‡2GBçš„bug</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">capTotalSize</span><span class="params">(Date now)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> totalSize = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> totalRemoved = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> offset = <span class="number">0</span>; offset &lt; maxHistory; offset++) &#123;</span><br><span class="line">        Date date = rc.getEndOfNextNthPeriod(now, -offset);</span><br><span class="line">        File[] matchingFileArray = getFilesInPeriod(date);</span><br><span class="line">        descendingSortByLastModified(matchingFileArray);</span><br><span class="line">        <span class="keyword">for</span> (File f : matchingFileArray) &#123;</span><br><span class="line">            <span class="keyword">long</span> size = f.length();</span><br><span class="line">            <span class="keyword">if</span> (totalSize + size &gt; totalSizeCap) &#123;</span><br><span class="line">                addInfo(<span class="string">"Deleting ["</span> + f + <span class="string">"]"</span> + <span class="string">" of size "</span> + <span class="keyword">new</span> FileSize(size));</span><br><span class="line">                totalRemoved += size;</span><br><span class="line">                f.delete();</span><br><span class="line">            &#125;</span><br><span class="line">            totalSize += size;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    addInfo(<span class="string">"Removed  "</span> + <span class="keyword">new</span> FileSize(totalRemoved) + <span class="string">" of files"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å®šä¹‰äº†totalSizeæ¥ç´¯åŠ å½“å‰æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œä½†æ˜¯æ•°æ®ç±»å‹æ˜¯intï¼Œæˆ‘ä»¬çŸ¥é“intç±»å‹æœ€å¤§å€¼æ˜¯ 2147483647ï¼Œè€Œå¦‚æœtotalSizeè¶…è¿‡äº†2GB <code>totalSize + size &gt; totalSizeCap</code>ä¼šä¸æˆç«‹ã€‚ã€‚ã€‚ã€‚</p><p>æ‰€ä»¥ä¸€æ—¦totalSizeCapè¶…è¿‡2GBï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æ—¥å¿—æ¸…é™¤å¤±æ•ˆã€‚</p><p>è¿™ä¸ªé—®é¢˜æœ‰äººåé¦ˆè¿‡ <a href="https://jira.qos.ch/browse/LOGBACK-1231" target="_blank" rel="noopener">issue</a>ï¼Œè€Œlogbackä¹Ÿåœ¨1.2.0ç‰ˆæœ¬ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ï¼Œ<a href="https://github.com/qos-ch/logback/commit/2240d4253c9f3fa28497e74f34be3bb1edc73078#diff-cb428af44f615094fb61e87a9ca3411a" target="_blank" rel="noopener">è§£å†³æ–¹æ¡ˆæ˜¯ä¿®æ”¹intä¸ºlongç±»å‹</a>ã€‚</p><p><img src="/img/logback-totalSizeCap/commit_2240d42.png" alt="commit_2240d42"></p><p>ä½†æ˜¯è¿™ä¸ªå¹¶ä¸é€‚ç”¨äºçº¿ä¸Šé‡åˆ°çš„æƒ…å†µï¼Œå› ä¸ºæœåŠ¡ä¸­ä½¿ç”¨çš„æ˜¯1.2.3ç‰ˆæœ¬ï¼Œäºæ˜¯ç»§ç»­æŸ¥è¯¢åˆ†æã€‚åˆå‘ç°äº†ä¸€ä¸ª<a href="https://jira.qos.ch/browse/LOGBACK-1500" target="_blank" rel="noopener">ç±»ä¼¼æŠ¥å‘Š</a>ï¼Œè€Œä¸”æŠ¥å‘Šçš„ç‰ˆæœ¬ä¹Ÿæ˜¯1.2.3</p><blockquote><p> Iâ€™m using SizeAndTimeBasedRollingPolicy.<br> When â€˜%iâ€™ file index reaches 999 it stops deleting the old files and totalSizeCap is not respected any more.<br> This soon leads to disk full issues (as logging in my case was fast enough) </p></blockquote><p>è¿™ä¸ªé—®é¢˜æœ‰ç‚¹ç›¸ä¼¼äº†ï¼Œçœ‹ä¸€ä¸‹ç”Ÿäº§ç¯å¢ƒçš„æ—¥å¿—æ–‡ä»¶ï¼Œå‰å‡ å¤©éƒ½æ˜¯åªä¿ç•™äº†åç¼€1000ä»¥ä¸Šçš„ï¼Œå½“å¤©çš„ä¿ç•™äº†700ä»¥ä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤äº†ä¸€éƒ¨åˆ†ï¼Œåé¢æœªåˆ é™¤ï¼Œè€Œä¸”æ„Ÿè§‰å’Œè¿™ä¸ª999åˆå¾ˆå¤§å…³ç³»ï¼Œè¿™ä¸ªissueé‡Œé¢æ²¡æœ‰ç›¸å…³å›å¤ï¼Œé‚£æˆ‘ä»¬è‡ªå·±ä¸€è¾¹æŸ¥çœ‹æºç ä¸€èˆ¬ç»§ç»­Googleå§ï¼Œä¸Šé¢çš„æºç æˆ‘ä»¬å·²ç»çœ‹åˆ°æ˜¯æ—¥å¿—å¤§å°å›æ»šçš„å®ç°ï¼Œ<code>File[] matchingFileArray = getFilesInPeriod(date)</code>ï¼Œè¿™ä¸€æ­¥åº”è¯¥æ˜¯è·å–ç›¸å…³çš„æ–‡ä»¶æ•°ç»„ï¼Œæˆ‘ä»¬è¿›å»ç»§ç»­æŸ¥çœ‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> File[] getFilesInPeriod(Date dateOfPeriodToClean) &#123;</span><br><span class="line">        File archive0 = <span class="keyword">new</span> File(fileNamePattern.convertMultipleArguments(dateOfPeriodToClean, <span class="number">0</span>));</span><br><span class="line">        File parentDir = getParentDir(archive0);</span><br><span class="line">        String stemRegex = createStemRegex(dateOfPeriodToClean);</span><br><span class="line">        File[] matchingFileArray = FileFilterUtil.filesInFolderMatchingStemRegex(parentDir, stemRegex);</span><br><span class="line">        <span class="keyword">return</span> matchingFileArray;</span><br><span class="line">    &#125;</span><br><span class="line"> <span class="function"><span class="keyword">private</span> String <span class="title">createStemRegex</span><span class="params">(<span class="keyword">final</span> Date dateOfPeriodToClean)</span> </span>&#123;</span><br><span class="line">        String regex = fileNamePattern.toRegexForFixedDate(dateOfPeriodToClean);</span><br><span class="line">        <span class="keyword">return</span> FileFilterUtil.afterLastSlash(regex);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸€å—çš„é€»è¾‘æ˜¯ç”Ÿæˆä¸€ä¸ªæ­£åˆ™å»å’Œæ—¥å¿—ç›®å½•ä¸‹çš„æ—¥å¿—åŒ¹é…è·å–æ—¥å¿—æ–‡ä»¶ï¼Œä¸‹é¢çš„ä»£ç å°±æ˜¯å…·ä½“æ‹¼æ¥æ­£åˆ™çš„å®ç°<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Given date, convert this instance to a regular expression.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Used to compute sub-regex when the pattern has both %d and %i, and the</span></span><br><span class="line"><span class="comment">     * date is known.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date - known date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toRegexForFixedDate</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        StringBuilder buf = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        Converter&lt;Object&gt; p = headTokenConverter;</span><br><span class="line">        <span class="keyword">while</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p <span class="keyword">instanceof</span> LiteralConverter) &#123;</span><br><span class="line">                buf.append(p.convert(<span class="keyword">null</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> IntegerTokenConverter) &#123;</span><br><span class="line">                buf.append(<span class="string">"(\\d&#123;1,3&#125;)"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> DateTokenConverter) &#123;</span><br><span class="line">                buf.append(p.convert(date));</span><br><span class="line">            &#125;</span><br><span class="line">            p = p.getNext();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> buf.toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>çœ‹åˆ°è¿™ä¸€å—æœç„¶å‘ç°ä¸€ä¸ªé—®é¢˜<code>buf.append(&quot;(\\d{1,3})&quot;)</code>ï¼Œè¿™ä¸ªæ­£åˆ™æ˜¯åŒ¹é…1ä½åˆ°3ä½çš„æ•°å­—ï¼Œè¿™ä¸åˆšå¥½ï¼Œåªèƒ½è¯†åˆ«æ—¥å¿—æ–‡ä»¶åç¼€1-999ï¼Œ999ä»¥ä¸Šå°±æ— æ³•åŒ¹é…äº†ã€‚</p><p>åŒæ ·æˆ‘ä»¬ä¹Ÿæ‰¾åˆ°äº†ç›¸å…³çš„<a href="https://jira.qos.ch/browse/LOGBACK-1297" target="_blank" rel="noopener">issue</a></p><blockquote><p>I found cause.</p><p>Check the <strong>toRegexForFixedDate()</strong> method in <strong>ch.qos.logback.core.rolling.helper.FileNamePattern.java</strong></p><p>Regular expression hardcoded like this:</p><p><strong><em>buf.append(â€œ(\ \d{1,3})â€);</em></strong></p><p>So, files indexed more than 3-digit number are not visible to deleteâ€¦</p><p>I donâ€™t know why the expression hardcoded.</p><p>Anyway, youâ€™d better modify the source.</p></blockquote><p>æœ‰äººæåˆ°äº†ç°åœ¨å·²ç»ä¿®å¤</p><blockquote><p>this issue fixed in 1.3.0-alpha1</p><p><a href="https://jira.qos.ch/browse/LOGBACK-1175" target="_blank" rel="noopener">https://jira.qos.ch/browse/LOGBACK-1175</a></p></blockquote><p>æœç„¶è¿™é‡Œå­˜åœ¨é—®é¢˜ï¼Œ<a href="https://github.com/qos-ch/logback/commit/f264607fb450" target="_blank" rel="noopener">1.3.0-alpha1ç‰ˆæœ¬ä¿®å¤è¿™ä¸ª</a></p><p><img src="/img/logback-totalSizeCap/commit_f264607.png" alt="commit_f264607"></p><p>ä½†æ˜¯ä¸ºä»€ä¹ˆå‡ºç°äº†å‰å‡ å¤©æ—¥å¿—æ–‡ä»¶ä¿ç•™äº†åç¼€999ä»¥ä¸Šï¼Œå½“å¤©å­˜åœ¨éƒ¨åˆ†ä½äº999çš„å‘¢ï¼Ÿå…¶å®è¿™ä¸ªä¹Ÿå¾ˆå¥½ç†è§£ï¼Œè¿˜æ˜¯ä¸Šé¢æºç ï¼Œå…ˆæ­£åˆ™åŒ¹é…åˆ°æ–‡ä»¶ä¹‹åå¾ªç¯ç´¯åŠ å¤§å°ï¼ŒmaxFileSize =20MB,totalSizeCap =5GB= 5120MBï¼Œç­‰äº256ä¸ªæ–‡ä»¶ï¼Œ256ä¸èƒ½è¢«999æ•´é™¤ï¼Œè¿˜ä¼šå‰©ä½™231ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸€å¤©æ¸…ç†äº†768ä¸ªæ–‡ä»¶åï¼Œå‰©ä½™  231 * 20MB&lt;5120MB ,æ‰€ä»¥ä¸ä¼šæ¸…ç†æ‰ï¼Œç¬¬äºŒå¤©æ‰ä¼šç»§ç»­ç´¯åŠ è¿™éƒ¨åˆ†ï¼Œç„¶ååˆ é™¤ä¸Šä¸€å¤©å‰©ä½™çš„åç¼€å°äº1000çš„æ—¥å¿—æ–‡ä»¶ï¼Œè¿™æ ·å°±å¯¼è‡´æ¯å¤©å¯èƒ½å‰©ä½™ä¸€å®šé‡çš„åç¼€å°äº1000çš„æ—¥å¿—æ–‡ä»¶ï¼Œç›´åˆ°ç¬¬äºŒå¤©è¢«æ¸…ç†ï¼Œè¿™å’Œæˆ‘ä»¬çš„å®é™…æƒ…å†µæ˜¯ç›¸ç¬¦çš„ã€‚</p><p>é¡ºä¾¿åæ§½ä¸€ä¸‹ï¼Œä»GitHubçš„æ–‡ä»¶historyæ¥çœ‹ï¼Œ2012å¹´ä½œè€…å·²ç»æ”¹è¿‡ä¸€æ¬¡è¿™ä¸ªæ­£åˆ™äº†ï¼ŒæŠŠ<a href="https://github.com/qos-ch/logback/commit/608ed4c58717296b8182006e35aff52ca2ecb598#diff-80c6c7b6b5e9e46b2e5afd6ec7eb07fd" target="_blank" rel="noopener">d{1,2}æ”¹æˆ d{1,3}</a> ï¼ŒçœŸæ˜¯é†‰äº†â”‘(ï¿£Ğ” ï¿£)â”</p><p><img src="/img/logback-totalSizeCap/commit_608ed4c.png" alt="commit_608ed4c"></p><h3 id="é—®é¢˜è§£å†³ï¼š"><a href="#é—®é¢˜è§£å†³ï¼š" class="headerlink" title="é—®é¢˜è§£å†³ï¼š"></a>é—®é¢˜è§£å†³ï¼š</h3><p>é—®é¢˜å·²ç»æ‰¾å‡ºï¼Œé‚£ä¹ˆè§£å†³å°±å¾ˆç®€å•ï¼Œå‡çº§logbackç‰ˆæœ¬å°±è¡Œï¼Œå½“ç„¶æˆ‘è§‰å¾—é¦–å…ˆè¿™ä¸ªæ—¥å¿—æ‰“å°é—®é¢˜å°±å¾ˆå¤§ï¼Œä¸€å¤©æ‰“å°ä¸Šåƒä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œå¤§å°å‡ åGï¼Œè¿™æ ¹æœ¬æ²¡æœ‰æ—¥å¿—çš„æ„ä¹‰äº†ï¼Œçº¯å±æµªè´¹èµ„æºã€‚</p><blockquote class="question"><br>å‚è€ƒğŸ“šï¼š<br><i class="fa fa-hand-o-right" aria-hidden="true"></i>   <a href="https://tidyko.com/posts/589711b0.html" target="_blank" rel="noopener">https://tidyko.com/posts/589711b0.html</a><br> <i class="fa fa-hand-o-right" aria-hidden="true"></i>   <a href="https://jira.qos.ch/browse/LOGBACK-1500" target="_blank" rel="noopener">https://jira.qos.ch/browse/LOGBACK-1500</a><br> <i class="fa fa-hand-o-right" aria-hidden="true"></i>   <a href="https://jira.qos.ch/browse/LOGBACK-1297" target="_blank" rel="noopener">https://jira.qos.ch/browse/LOGBACK-1297</a><br></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°ï¼š&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°ï¼š&lt;/h3&gt;&lt;p&gt;çº¿ä¸Šçš„ä¸€ä¸ªæ•°æ®æ¥æ”¶æœåŠ¡æœ€è¿‘æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œæ—¥å¿—ä¹Ÿæ‰“çš„å¾ˆé¢‘ç¹ï¼Œä½†æ˜¯å´å‡ºç°äº†totalSizeCapé…ç½®ä¸ç”Ÿæ•ˆï¼Œæ— æ³•åˆ é™¤æ—¥å¿—æ–‡ä»¶çš„é—®é¢˜ï¼Œæ¯å¤©æ—¥å¿—ä¸€åº¦å›æ»šç´¯è®¡åˆ°å‡ åƒä¸ª ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="æ’é”™" scheme="https://www.elietio.xyz/tags/%E6%8E%92%E9%94%99/"/>
    
      <category term="Logback" scheme="https://www.elietio.xyz/tags/Logback/"/>
    
      <category term="totalSizeCap" scheme="https://www.elietio.xyz/tags/totalSizeCap/"/>
    
      <category term="999" scheme="https://www.elietio.xyz/tags/999/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•é‡å®šå‘ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„æ ‡å‡†è¾“å‡º</title>
    <link href="https://www.elietio.xyz/posts/b1ce4d2d.html"/>
    <id>https://www.elietio.xyz/posts/b1ce4d2d.html</id>
    <published>2020-02-22T02:17:54.000Z</published>
    <updated>2020-06-13T08:18:25.218Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>å¦‚ä½•åœ¨Linuxç³»ç»Ÿä¸­æ›´æ”¹ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°å…¶ä»–æ–‡ä»¶ï¼Ÿäº‹æƒ…çš„åœºæ™¯æ˜¯è¿™æ ·çš„ï¼Œç”±äºåŒäº‹çš„ç–å¿½ï¼Œå¿˜äº†å…³é—­ä¸€ä¸ªspringbootå¾®æœåŠ¡çš„æ§åˆ¶å°æ—¥å¿—è¾“å‡ºï¼Œè€Œè¿™ä¸ªè¿›ç¨‹å¯åŠ¨ååˆä¼šæŠŠæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºå†™åˆ°ä¸€ä¸ªprocess.logçš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œç”±äºæ§åˆ¶å°ä¿¡æ¯è¾“å‡ºå¤ªå¤šï¼Œå¯¼è‡´é•¿æ—¶é—´æ—¥å¿—ç£ç›˜å ç”¨è¿‡å¤§ï¼Œè¿™æ—¶å€™åˆæ¥äº†ä¸€ä¸ªéªšæ“ä½œï¼Œç›´æ¥æŠŠè¿™ä¸ªæ—¥å¿—æ–‡ä»¶åˆ é™¤æ‰äº†ğŸ˜“ã€‚<br><a id="more"></a><br>ç›´æ¥åˆ é™¤æ–‡ä»¶è¿™ä¸ªè‚¯å®šæ˜¯æ²¡ç”¨çš„ï¼Œé€šè¿‡rmåˆ é™¤æ–‡ä»¶å°†ä¼šä»æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ç»“æ„ä¸Šè§£é™¤é“¾æ¥(unlink)ï¼Œç„¶è€Œå¦‚æœæ–‡ä»¶æ˜¯è¢«æ‰“å¼€çš„ï¼ˆæœ‰è¿›ç¨‹æ­£åœ¨ä½¿ç”¨ï¼‰ï¼Œé‚£ä¹ˆè¿›ç¨‹å°†ä»ç„¶å¯ä»¥è¯»å–è¯¥æ–‡ä»¶ï¼Œç£ç›˜ç©ºé—´ä¹Ÿä¸€ç›´è¢«å ç”¨ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´åˆ é™¤äº†æ–‡ä»¶ï¼Œä½†æ˜¯ç£ç›˜ç©ºé—´å´æœªè¢«é‡Šæ”¾ï¼Œå¤§é‡çš„æ–‡ä»¶å¥æŸ„æ— æ³•é‡Šæ”¾ã€‚<br>æ‰§è¡Œ <code>lsof|grep [pid]|grep deleted</code> æŸ¥çœ‹ï¼Œç¡®å®å‡ºç°äº†æ–‡ä»¶å¥æŸ„æ³„éœ²ğŸ˜²<br><img src="/img/redirect-stdout/lsof.png" alt="lsof"><br>ç„¶åæŸ¥çœ‹å¯¹åº”è¿›ç¨‹çš„æ–‡ä»¶æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼šfile descriptorï¼‰<br><code>ls -l /proc/[pid]/fd</code><br><img src="/img/redirect-stdout/proc.png" alt="proc"><br>å¯ä»¥çœ‹åˆ°æ–‡ä»¶æè¿°ç¬¦1å’Œ2éƒ½æŒ‡å‘äº†è¢«åˆ é™¤çš„æ—¥å¿—æ–‡ä»¶<br>é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæ€æ‰è¿›ç¨‹æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼Œä½†å¦‚æœä¸é‡å¯å‘¢ï¼Ÿä»ä¸Šé¢fdè¡¨ä¸Šæˆ‘ä»¬çœ‹åˆ°1å’Œ2æŒ‡å‘åˆ é™¤æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½æ›´æ”¹è¿™ä¸ªæŒ‡å‘ï¼Œé‡å®šå‘åˆ°/dev/nullä¸¢æ‰è¾“å‡ºå‘¢â”<br>ç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œä¸»è¦ä¾èµ–äºLinux çš„ close()ã€open()ã€dup2()å‡½æ•°ã€‚ï¼ˆopenå‡½æ•°ä¹Ÿå¯ç”¨creatå‡½æ•°æ›¿æ¢ï¼‰<br>closeå‡½æ•°ç”¨äºå…³é—­ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">close</span><span class="params">(<span class="keyword">int</span> filedes)</span></span>;</span><br><span class="line">è¿”å›å€¼ï¼šè‹¥æˆåŠŸåˆ™è¿”å›<span class="number">0</span>ï¼Œå‡ºé”™åˆ™è¿”å›<span class="number">-1</span></span><br><span class="line">å‚æ•°ï¼šfiledesæ˜¯æ–‡ä»¶æè¿°ç¬¦ã€‚</span><br></pre></td></tr></table></figure></p><p>openå‡½æ•°å¯ä»¥æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">open</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *pathname, <span class="keyword">int</span> flags)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">open</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *pathname, <span class="keyword">int</span> flags, <span class="keyword">mode_t</span> mode)</span></span>;</span><br><span class="line">è¿”å›å€¼ï¼šæˆåŠŸè¿”å›æ–°åˆ†é…çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå‡ºé”™è¿”å›<span class="number">-1</span>å¹¶è®¾ç½®errno</span><br><span class="line">å‚æ•°ï¼špathnameå‚æ•°æ˜¯è¦æ‰“å¼€æˆ–åˆ›å»ºçš„æ–‡ä»¶åï¼Œflagså‚æ•°æœ‰ä¸€ç³»åˆ—å¸¸æ•°å€¼ï¼Œå…·ä½“ä¸åœ¨æ­¤å¤„ä»‹ç»</span><br></pre></td></tr></table></figure></p><p>dup2å‡½æ•°å¯ä»¥å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶çš„æè¿°ç¬¦ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dup2</span><span class="params">( <span class="keyword">int</span> oldfd, <span class="keyword">int</span> targetfd )</span></span></span><br><span class="line">è¿”å›å€¼ï¼šç›®æ ‡çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">å‚æ•°ï¼šoldfdæºæè¿°ç¬¦ï¼Œtargetfdç›®æ ‡æè¿°ç¬¦</span><br></pre></td></tr></table></figure></p><p>ç®€å•æ¥è¯´ï¼Œcloseå…³é—­ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œopenæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œdup2å°†ç›®æ ‡æ–‡ä»¶æè¿°ç¬¦å˜æˆæºæ–‡ä»¶æè¿°ç¬¦çš„ä¸€ä¸ªå¤åˆ¶ï¼Œå³ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦éƒ½æŒ‡å‘äº†æºæ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„æ–‡ä»¶ä¸Šå»ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…³é—­æ‰æ ‡å‡†è¾“å‡ºfd1ï¼Œç„¶åopen /dev/nullè·å¾—ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå†å°†fd1æŒ‡å‘/dev/nullï¼Œè¿™æ ·å°±å®Œæˆäº†é‡å®šå‘ä¸€ä¸ªæ ‡å‡†è¾“å‡ºã€‚<br>OKï¼Œæˆ‘ä»¬ç”¨GDBå°è¯•ä¸€ä¸‹ï¼Œé¦–å…ˆ<code>gdb -p [pid]</code>è¿›å…¥gdbè°ƒè¯•ğŸ’»<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p close(1)</span><br><span class="line"><span class="variable">$1</span> = 0</span><br><span class="line">(gdb) p dup2(open(<span class="string">"/dev/null"</span>, 2), 1)    //2è¡¨ç¤ºO_RDWR 0x0002</span><br><span class="line"><span class="variable">$2</span> = 1</span><br><span class="line">(gdb) quit</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·å°±å®Œæˆæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°/dev/nullï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºä¾æ­¤ç±»æ¨<br>å†æ¬¡æŸ¥çœ‹å¯¹åº”è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨ï¼Œ1å’Œ2éƒ½æˆåŠŸæŒ‡å‘äº†/dev/nullï¼Œå¹¶ä¸”æ–‡ä»¶å¥æŸ„ä¹Ÿè¢«é‡Šæ”¾æ‰âœŒ<br><img src="/img/redirect-stdout/proc1.png" alt="proc1"><br>ä¸ä»…ä»…é€‚ç”¨äºè¿™ä¸ªåœºæ™¯ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿå¯ä»¥æŠŠä¸€ä¸ªå¿˜è®°äº†nohupå¯åŠ¨çš„è¿›ç¨‹æ”¾ç½®åˆ°åå°è¿è¡Œç­‰ç­‰å…¶ä»–æ–¹é¢ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¦‚ä½•åœ¨Linuxç³»ç»Ÿä¸­æ›´æ”¹ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°å…¶ä»–æ–‡ä»¶ï¼Ÿäº‹æƒ…çš„åœºæ™¯æ˜¯è¿™æ ·çš„ï¼Œç”±äºåŒäº‹çš„ç–å¿½ï¼Œå¿˜äº†å…³é—­ä¸€ä¸ªspringbootå¾®æœåŠ¡çš„æ§åˆ¶å°æ—¥å¿—è¾“å‡ºï¼Œè€Œè¿™ä¸ªè¿›ç¨‹å¯åŠ¨ååˆä¼šæŠŠæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºå†™åˆ°ä¸€ä¸ªprocess.logçš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œç”±äºæ§åˆ¶å°ä¿¡æ¯è¾“å‡ºå¤ªå¤šï¼Œå¯¼è‡´é•¿æ—¶é—´æ—¥å¿—ç£ç›˜å ç”¨è¿‡å¤§ï¼Œè¿™æ—¶å€™åˆæ¥äº†ä¸€ä¸ªéªšæ“ä½œï¼Œç›´æ¥æŠŠè¿™ä¸ªæ—¥å¿—æ–‡ä»¶åˆ é™¤æ‰äº†ğŸ˜“ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Linux" scheme="https://www.elietio.xyz/categories/Linux/"/>
    
    
      <category term="linux" scheme="https://www.elietio.xyz/tags/linux/"/>
    
      <category term="gdb" scheme="https://www.elietio.xyz/tags/gdb/"/>
    
      <category term="é‡å®šå‘æ ‡å‡†è¾“å‡ºï¼Œæ–‡ä»¶æè¿°ç¬¦" scheme="https://www.elietio.xyz/tags/%E9%87%8D%E5%AE%9A%E5%90%91%E6%A0%87%E5%87%86%E8%BE%93%E5%87%BA%EF%BC%8C%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¡-Djava.ext.diré…ç½®ä¸å½“çš„é—®é¢˜</title>
    <link href="https://www.elietio.xyz/posts/e1ec9d49.html"/>
    <id>https://www.elietio.xyz/posts/e1ec9d49.html</id>
    <published>2020-01-07T12:26:54.000Z</published>
    <updated>2020-06-13T08:18:25.217Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="é—®é¢˜æè¿°ï¼š"><a href="#é—®é¢˜æè¿°ï¼š" class="headerlink" title="é—®é¢˜æè¿°ï¼š"></a>é—®é¢˜æè¿°ï¼š</h3><p>æœåŠ¡æ–°å¢ä¸€ä¸ªåŠ è§£å¯†æ¨¡å—å,æœ¬åœ°è°ƒè¯•OKéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒå¯åŠ¨å¼€å§‹åŠŸèƒ½æµ‹è¯•ï¼Œå´å‘ç°ç›¸å…³åŠŸèƒ½å¼‚å¸¸ï¼ŒæŸ¥çœ‹æœåŠ¡æ—¥å¿—å‘ç°ä»¥ä¸‹å¼‚å¸¸<br><a id="more"></a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java.security.NoSuchAlgorithmException: Algorithm HmacSHA256 not available</span><br><span class="line">        at javax.crypto.Mac.getInstance(Mac.java:<span class="number">181</span>)</span><br><span class="line">        ......</span><br></pre></td></tr></table></figure><h3 id="é—®é¢˜æ’æŸ¥ï¼š"><a href="#é—®é¢˜æ’æŸ¥ï¼š" class="headerlink" title="é—®é¢˜æ’æŸ¥ï¼š"></a>é—®é¢˜æ’æŸ¥ï¼š</h3><p>æœåŠ¡æ˜¯springbootçš„é¡¹ç›®ï¼Œç›´æ¥æ‰“åŒ…æˆjaråŒ…ï¼Œå¯åŠ¨è„šæœ¬ä¸­ä½¿ç”¨<code>java -jar</code>çš„å½¢å¼å¯åŠ¨ã€‚ç”±äºç”¨åˆ°äº†ä¸€äº›å…¬å¸å†…éƒ¨å°è£…çš„ä¾èµ–jaråŒ…ï¼Œè€Œè¿™äº›jarå¿…é¡»å¤–éƒ¨åŠ è½½ä¸èƒ½æ‰“è¿›jaré‡Œé¢å¯åŠ¨ï¼Œæ‰€ä»¥ä½¿ç”¨äº†<code>-Djava.ext.dirs</code>å»åŠ è½½å¤–éƒ¨ä¾èµ–jaråŒ…ï¼Œè¿™æ—¶ä¸€ä¸ªé™·é˜±å°±å‡ºç°äº†ï¼Œ<code>-Djava.ext.dirs</code>ä¼šè¦†ç›–æ‰javaæœ¬èº«çš„extè®¾ç½®ï¼Œ<code>java.ext.dirs</code>æŒ‡å®šçš„ç›®å½•ç”±ExtClassLoaderåŠ è½½å™¨åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè¯¥ç³»ç»Ÿå±æ€§ï¼Œé‚£ä¹ˆè¯¥åŠ è½½å™¨é»˜è®¤åŠ è½½<code>$JAVA_HOME/jre/lib/ext</code>ç›®å½•ä¸‹çš„æ‰€æœ‰jaræ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-rwxr-xr-x 1    3860502 Mar 15  2017 cldrdata.jar</span><br><span class="line">-rwxr-xr-x 1       8286 Mar 15  2017 dnsns.jar</span><br><span class="line">-rwxr-xr-x 1      44516 Mar 15  2017 jaccess.jar</span><br><span class="line">-rwxr-xr-x 1   18490072 Mar 15  2017 jfxrt.jar</span><br><span class="line">-rwxr-xr-x 1    1179093 Mar 15  2017 localedata.jar</span><br><span class="line">-rwxr-xr-x 1       1269 Mar 15  2017 meta-index</span><br><span class="line">-rwxr-xr-x 1    2022531 Mar 15  2017 nashorn.jar</span><br><span class="line">-rwxr-xr-x 1      42154 Mar 15  2017 sunec.jar</span><br><span class="line">-rwxr-xr-x 1     280161 Mar 15  2017 sunjce_provider.jar</span><br><span class="line">-rwxr-xr-x 1     251327 Mar 15  2017 sunpkcs11.jar</span><br><span class="line">-rwxr-xr-x 1      68924 Mar 15  2017 zipfs.jar</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œåªå•å•æŒ‡å®šäº†é¢å¤–ä¾èµ–çš„jaråŒ…åï¼Œå°±ä¼šå¯¼è‡´extç›®å½•ä¸‹çš„jaråŒ…æ— æ³•åŠ è½½ï¼Œè€Œè¿™æ¬¡æˆ‘ä»¬æ–°å¢çš„åŠ è§£å¯†æ¨¡å—ä½¿ç”¨äº†<code>HmacSHA256</code>ç®—æ³•ï¼Œä¾èµ–äº<code>sunjce_provider.jar</code>åŒ…çš„å†…å®¹ï¼Œå½“æˆ‘ä»¬åœ¨æœ¬åœ°ç¯å¢ƒè°ƒè¯•æ—¶ï¼Œç›´æ¥IDEAå¯åŠ¨ï¼Œæ²¡æœ‰å‡ºç°ä¾èµ–åŠ è½½é”™è¯¯çš„é—®é¢˜ï¼Œè€Œå½“åœ¨æµ‹è¯•ç¯å¢ƒä½¿ç”¨å¯åŠ¨è„šæœ¬å¯åŠ¨å¹¶ä¸”æŒ‡å®šäº†<code>-Djava.ext.dirs</code>å°±å¯¼è‡´äº†ä¾èµ–å‡ºé”™ã€‚</p><h3 id="é—®é¢˜è§£å†³ï¼š"><a href="#é—®é¢˜è§£å†³ï¼š" class="headerlink" title="é—®é¢˜è§£å†³ï¼š"></a>é—®é¢˜è§£å†³ï¼š</h3><p>é—®é¢˜å·²ç»æ‰¾å‡ºï¼Œé‚£ä¹ˆè§£å†³å°±å¾ˆç®€å•ï¼Œ<code>-Djava.ext.dirs</code>å¼•å…¥å¤šä¸ªè·¯å¾„åŠ å…¥Javaè‡ªå¸¦extè·¯å¾„å³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java  -Djava.ext.dirs=../lib:$JAVA_HOME/jre/lib/ext -jar</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°ï¼š&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°ï¼š&lt;/h3&gt;&lt;p&gt;æœåŠ¡æ–°å¢ä¸€ä¸ªåŠ è§£å¯†æ¨¡å—å,æœ¬åœ°è°ƒè¯•OKéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒå¯åŠ¨å¼€å§‹åŠŸèƒ½æµ‹è¯•ï¼Œå´å‘ç°ç›¸å…³åŠŸèƒ½å¼‚å¸¸ï¼ŒæŸ¥çœ‹æœåŠ¡æ—¥å¿—å‘ç°ä»¥ä¸‹å¼‚å¸¸&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="æ’é”™" scheme="https://www.elietio.xyz/tags/%E6%8E%92%E9%94%99/"/>
    
      <category term="å¼‚å¸¸" scheme="https://www.elietio.xyz/tags/%E5%BC%82%E5%B8%B8/"/>
    
      <category term="java.ext.dirs" scheme="https://www.elietio.xyz/tags/java-ext-dirs/"/>
    
  </entry>
  
  <entry>
    <title>Mybatisä¸€å¯¹å¤šã€å¤šå¯¹å¤šæŸ¥è¯¢æ—¶æ•°æ®è¦†ç›–é—®é¢˜</title>
    <link href="https://www.elietio.xyz/posts/3f3f23ec.html"/>
    <id>https://www.elietio.xyz/posts/3f3f23ec.html</id>
    <published>2019-12-21T13:25:23.000Z</published>
    <updated>2020-06-14T02:27:33.017Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="é—®é¢˜æè¿°ï¼š"><a href="#é—®é¢˜æè¿°ï¼š" class="headerlink" title="é—®é¢˜æè¿°ï¼š"></a>é—®é¢˜æè¿°ï¼š</h3><p>åœ¨ä½¿ç”¨mybatisæŸ¥è¯¢ä¸€å¯¹å¤šç»“æœè¿”å›å¯¹è±¡çš„åœºæ™¯ä¸­ï¼Œå½“ä¸»è¡¨å…³è”çš„å¤šæ¡æ•°æ®å®Œå…¨ä¸€è‡´æ—¶ï¼Œè¿”å›çš„å¯¹è±¡åªæœ‰ç¬¬ä¸€æ¡æ•°æ®<br><a id="more"></a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  A.ID,</span><br><span class="line">  A.USER_ID,</span><br><span class="line">  B.RESULT_ID,</span><br><span class="line">  B.RATE</span><br><span class="line"><span class="keyword">from</span> TABLEA A</span><br><span class="line">  <span class="keyword">left</span> <span class="keyword">join</span> TABLEAB B</span><br><span class="line">    <span class="keyword">on</span> A.ID = B.ID</span><br></pre></td></tr></table></figure><table><thead><tr><th>ID</th><th>USER_ID</th><th>RESULT_ID</th><th>RATE</th></tr></thead><tbody><tr><td>100000000000001892</td><td>abc</td><td>10000001</td><td>111</td></tr><tr><td>100000000000001892</td><td>abc</td><td>10000001</td><td>111</td></tr><tr><td>100000000000001892</td><td>abc</td><td>10000001</td><td>111</td></tr></tbody></table><p>æ˜ å°„çš„xmlå¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">type</span>=<span class="string">"xxx"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"ID"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"USER_ID"</span> <span class="attr">property</span>=<span class="string">"userID"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"resultList"</span> <span class="attr">ofType</span>=<span class="string">"xxx"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"RESULT_ID"</span> <span class="attr">property</span>=<span class="string">"resultID"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"RATE"</span> <span class="attr">property</span>=<span class="string">"rate"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æŒ‰ç…§è®¾æƒ³ï¼Œè¿”å›çš„ ID=100000000000001892çš„å¯¹è±¡é‡Œé¢çš„resultListåº”è¯¥åŒ…å«ä¸‰æ¡å®Œå…¨ä¸€æ ·çš„æ•°æ®ï¼Œä½†æ˜¯å®é™…çš„ç»“æœå´æ˜¯åªæœ‰ä¸€æ¡</p><h3 id="é—®é¢˜æ’æŸ¥ï¼š"><a href="#é—®é¢˜æ’æŸ¥ï¼š" class="headerlink" title="é—®é¢˜æ’æŸ¥ï¼š"></a>é—®é¢˜æ’æŸ¥ï¼š</h3><p>resultMapä¸­å¦‚æœä¸å®šä¹‰ç±»ä¼¼ä¸»é”®ä¹‹ç±»çš„èƒ½å¤ŸåŒºåˆ†æ¯ä¸€æ¡ç»“æœé›†çš„å­—æ®µçš„è¯ï¼Œå½“æ•°æ®å®Œå…¨ä¸€è‡´çš„æ—¶å€™ä¼šå¼•èµ·åé¢ä¸€æ¡æ•°æ®è¦†ç›–å‰é¢ä¸€æ¡æ•°æ®çš„ç°è±¡</p><h3 id="é—®é¢˜è§£å†³ï¼š"><a href="#é—®é¢˜è§£å†³ï¼š" class="headerlink" title="é—®é¢˜è§£å†³ï¼š"></a>é—®é¢˜è§£å†³ï¼š</h3><p>æŸ¥è¯¢æ—¶å°†ä¸€å¯¹å¤šçš„å¤šè¡¨çš„è‡ªå¢ä¸»é”®IDä¹ŸæŸ¥è¯¢å‡ºæ¥ï¼Œè¿™æ ·resultMapæ˜ å°„çš„æ•°æ®å°±ä¸ä¼šå®Œå…¨ä¸€è‡´ï¼Œé¿å…äº†è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨mybatisæŸ¥è¯¢çš„æ—¶å€™æœ€å¥½å°†è¡¨çš„ä¸»é”®IDæŸ¥è¯¢å‡ºæ¥ï¼Œå¦‚æœä¸éœ€è¦è¿”å›IDå­—æ®µï¼Œå¯ä»¥åœ¨ä»£ç å±‚é¢å®ä½“ç±»è½¬æ¢JSONè¿”å›å±è”½æ‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°ï¼š&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°ï¼š&lt;/h3&gt;&lt;p&gt;åœ¨ä½¿ç”¨mybatisæŸ¥è¯¢ä¸€å¯¹å¤šç»“æœè¿”å›å¯¹è±¡çš„åœºæ™¯ä¸­ï¼Œå½“ä¸»è¡¨å…³è”çš„å¤šæ¡æ•°æ®å®Œå…¨ä¸€è‡´æ—¶ï¼Œè¿”å›çš„å¯¹è±¡åªæœ‰ç¬¬ä¸€æ¡æ•°æ®&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="æ’é”™" scheme="https://www.elietio.xyz/tags/%E6%8E%92%E9%94%99/"/>
    
      <category term="mybatis" scheme="https://www.elietio.xyz/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>keepAliveè§£å†³druidç©ºé—²è¿æ¥socket timeout 15åˆ†é’Ÿ</title>
    <link href="https://www.elietio.xyz/posts/fd295ff1.html"/>
    <id>https://www.elietio.xyz/posts/fd295ff1.html</id>
    <published>2019-12-06T12:26:54.000Z</published>
    <updated>2020-06-13T08:18:25.217Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="é—®é¢˜æè¿°ï¼š"><a href="#é—®é¢˜æè¿°ï¼š" class="headerlink" title="é—®é¢˜æè¿°ï¼š"></a>é—®é¢˜æè¿°ï¼š</h3><p>æµ‹è¯•ç¯å¢ƒå‘ç°äº†ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„ç°è±¡ï¼Œä¸€å°æœåŠ¡å™¨å‡ºç°äº†è¯·æ±‚å¡é¡¿15åˆ†é’Ÿç„¶åæ‰æ‰§è¡ŒSQLè¿”å›ç»“æœçš„ç°è±¡<br><a id="more"></a></p><h3 id="é—®é¢˜æ’æŸ¥ï¼š"><a href="#é—®é¢˜æ’æŸ¥ï¼š" class="headerlink" title="é—®é¢˜æ’æŸ¥ï¼š"></a>é—®é¢˜æ’æŸ¥ï¼š</h3><p>æœ€å¼€å§‹æˆ‘ä»¬è®¤ä¸ºæ˜¯ç½‘ç»œé—®é¢˜ï¼Œå› ä¸ºè¿™å°æœåŠ¡å™¨ç½‘ç»œç¯å¢ƒæ¯”è¾ƒç‰¹æ®Šï¼Œæ­£å¸¸æˆ‘ä»¬ç¯å¢ƒçš„åº”ç”¨æœåŠ¡å™¨å’Œæ•°æ®åº“æœåŠ¡å™¨æ˜¯åŒä¸€ç½‘æ®µçš„ï¼Œè€Œè¿™å°æœåŠ¡å™¨å’Œæ•°æ®åº“æœåŠ¡å™¨å¹¶ä¸åœ¨åŒä¸€ç½‘æ®µï¼Œå­˜åœ¨é˜²ç«å¢™ç­–ç•¥ï¼Œä½†æ˜¯åæ¥å‘ç°èƒ½å¤Ÿç¨³å®šå¤ç°ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½æ˜¯å‘ç”Ÿåœ¨æœåŠ¡ç©ºé—²ä¸€æ®µæ—¶é—´åç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯druidï¼Œäºæ˜¯æŸ¥è¯¢äº†ç›¸å…³é—®é¢˜ï¼Œæœç„¶ç½‘ç»œä¸Šå·²ç»æœ‰äº†å¾ˆå¤šç›¸å…³çš„æè¿°</p><p><a href="https://my.oschina.net/u/3434392/blog/3017866" target="_blank" rel="noopener">druidä¸‹è«åå…¶å¦™hold15åˆ†é’Ÿ+ã€‚ç–‘æ˜¯socket timeoutè¶…æ—¶15åˆ†é’Ÿåï¼Œé‡å»ºäº†æ–°è¿æ¥å¯¼è‡´</a></p><p><a href="https://github.com/alibaba/druid/issues/2905" target="_blank" rel="noopener">ä»è¿æ¥æ± ä¸­è·å–åˆ°å¤±æ•ˆè¿æ¥ï¼Œåœ¨æ£€éªŒè¿æ¥æœ‰æ•ˆæ€§æ—¶å‡ºç°é•¿æ—¶é—´ç­‰å¾…ï¼Œå¤§æ¦‚15åˆ†é’Ÿ #2905</a></p><p>å¤§è‡´åŸå› æ˜¯è¿™æ ·ï¼Œå½“åº”ç”¨æœåŠ¡å™¨å’Œæ•°æ®åº“æœåŠ¡å™¨ç›´æ¥å­˜åœ¨é˜²ç«å¢™ç­–ç•¥æ—¶ï¼Œå¦‚æœæœåŠ¡ç©ºé—²æ—¶é—´è¿‡é•¿ï¼Œä¼šè¢«é˜²ç«å¢™ä¸»åŠ¨æ–­å¼€æ•°æ®åº“è¿æ¥ï¼Œä½†æ˜¯æ­¤æ—¶druidå¹¶æœªæ„ŸçŸ¥ï¼Œæ­¤æ—¶å½“æœ‰è¯·æ±‚è¿‡æ¥æ—¶ï¼Œå¦‚æœdruidé…ç½®äº†<code>testWhileIdle</code>ï¼ˆç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äº<code>timeBetweenEvictionRunsMillis</code>ï¼Œæ‰§è¡Œ<code>validationQuery</code>æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚ï¼‰ï¼Œé‚£ä¹ˆå°†è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œæ£€æµ‹çš„æ–¹å¼ä¹Ÿæ˜¯æ ¹æ®é…ç½®çš„ç­–ç•¥ï¼Œä¸€èˆ¬æ˜¯<code>select 1 from dual</code> ï¼Œç”±äºè¿™ä¸ªè¿æ¥å·²ç»è¢«é˜²ç«å¢™æ–­æ‰ï¼Œæ ¹æœ¬åˆ°è¾¾ä¸äº†æ•°æ®åº“ï¼Œè€Œdruidè¿™è¾¹åˆ™åœ¨ä¸€ç›´ç­‰å¾…ï¼Œè€Œè¿™ä¸ªç­‰å¾…çš„è¶…æ—¶å—åˆ°<code>socket timeout</code>é™åˆ¶ï¼Œè€Œæˆ‘ä»¬æœåŠ¡å™¨æœ¬èº«çš„ç³»ç»Ÿ<code>socket timeout</code>è®¾ç½®å°±æ˜¯15åˆ†é’Ÿï¼Œæ‰€ä»¥druidä¼šä¸€ç›´hold15åˆ†é’Ÿï¼Œç›´åˆ°è§¦å‘è¶…æ—¶é‡æ–°å»ºç«‹è¿æ¥ã€‚æ‰€ä»¥é—®é¢˜å°±å‡ºç°äº†druidæ— æ³•ä¸»åŠ¨æ¢å¤é˜²ç«å¢™ä¸»åŠ¨æ–­å¼€çš„è¿æ¥ï¼Œåªæœ‰å½“è§¦å‘è¶…æ—¶æ‰èƒ½è¿›è¡Œé‡å»ºè¿æ¥ã€‚</p><h3 id="é—®é¢˜è§£å†³ï¼š"><a href="#é—®é¢˜è§£å†³ï¼š" class="headerlink" title="é—®é¢˜è§£å†³ï¼š"></a>é—®é¢˜è§£å†³ï¼š</h3><p>é—®é¢˜è§£å†³çš„æ€è·¯æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€é’Ÿæ€è·¯ï¼Œæ›´æ”¹jdbcçš„<code>socke timeout</code>ï¼Œä½†æ˜¯ä¸å»ºè®®ï¼Œå› ä¸ºå¦‚æœè¦èƒ½å¤Ÿå¿«é€Ÿé‡è¿ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>socket timeout</code>å°±éœ€è¦é…ç½®å¾ˆçŸ­ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶é—´å¾ˆçŸ­ä¼šå¯¼è‡´æ‰§è¡Œè¿‡é•¿çš„SQLæ— æ³•è¿”å›ç»“æœï¼Œ<code>socket timeout</code>å¿…é¡»å¤§äº<code>statement timeout</code>ï¼Œå¦åˆ™<code>socket timeout</code>å…ˆç”Ÿæ•ˆåˆ™<code>statement timeout</code>æ¯«æ— æ„ä¹‰ï¼Œæ‰€ä»¥å³ä½¿é…ç½®å‡ åˆ†é’Ÿè¿˜æ˜¯ä¼šå‡ºç°è¯·æ±‚holdçš„ç°è±¡ï¼Œå› æ­¤ä¸åˆé€‚ã€‚</p><p>ç¬¬äºŒç§æ€è·¯ï¼Œæ—¢ç„¶é•¿æ—¶é—´ç©ºé—²åè¿æ¥ä¼šè¢«é˜²ç«å¢™æ–­å¼€ï¼Œé‚£ä¹ˆç»´æŒä¸€ä¸ªå¿ƒè·³ï¼Œä¸è®©è¿æ¥è¢«é˜²ç«å¢™æ–­å¼€å³å¯ï¼Œå› æ­¤ï¼Œéœ€è¦å¼•å…¥druidçš„<code>keepAlive</code></p><p>å¼•å…¥<a href="https://github.com/alibaba/druid/wiki/KeepAlive_cn" target="_blank" rel="noopener">druid GitHub</a>ä¸Šå¯¹æ­¤é…ç½®çš„è§£é‡Š</p><blockquote><p>åœ¨Druid-1.0.27ä¹‹å‰çš„ç‰ˆæœ¬ï¼ŒDruidDataSourceå»ºè®®ä½¿ç”¨TestWhileIdleæ¥ä¿è¯è¿æ¥çš„æœ‰æ•ˆæ€§ï¼Œä½†ä»æœ‰å¾ˆå¤šåœºæ™¯éœ€è¦å¯¹è¿æ¥è¿›è¡Œä¿æ´»å¤„ç†ã€‚åœ¨1.0.28ç‰ˆæœ¬ä¹‹åï¼Œæ–°åŠ å…¥keepAliveé…ç½®ï¼Œç¼ºçœå…³é—­ã€‚ä½¿ç”¨keepAliveåŠŸèƒ½ï¼Œå»ºè®®ä½¿ç”¨1.1.16æˆ–è€…æ›´é«˜ç‰ˆæœ¬</p><h1 id="æ‰“å¼€KeepAliveä¹‹åçš„æ•ˆæœ"><a href="#æ‰“å¼€KeepAliveä¹‹åçš„æ•ˆæœ" class="headerlink" title="æ‰“å¼€KeepAliveä¹‹åçš„æ•ˆæœ"></a>æ‰“å¼€KeepAliveä¹‹åçš„æ•ˆæœ</h1><ol><li>åˆå§‹åŒ–è¿æ¥æ± æ—¶ä¼šå¡«å……åˆ°minIdleæ•°é‡ã€‚</li><li>è¿æ¥æ± ä¸­çš„minIdleæ•°é‡ä»¥å†…çš„è¿æ¥ï¼Œç©ºé—²æ—¶é—´è¶…è¿‡minEvictableIdleTimeMillisï¼Œåˆ™ä¼šæ‰§è¡ŒkeepAliveæ“ä½œã€‚</li><li>å½“ç½‘ç»œæ–­å¼€ç­‰åŸå› äº§ç”Ÿçš„ç”±ExceptionSorteræ£€æµ‹å‡ºæ¥çš„æ­»è¿æ¥è¢«æ¸…é™¤åï¼Œè‡ªåŠ¨è¡¥å……è¿æ¥åˆ°minIdleæ•°é‡ã€‚</li></ol></blockquote><p>å¼€å¯è¿æ¥ä¿æ´»é…ç½®<code>keepAlive</code>,å¯¹äº<code>minIdle</code>ä»¥å†…çš„è¿æ¥ï¼ŒæŒ‰ç…§<code>timeBetweenEvictionRunsMillis</code>é—´éš”è¿›è¡Œä¿æ´»æ£€æµ‹ï¼Œå½“ç©ºé—²æ—¶é—´å¤§äº<code>minEvictableIdleTimeMillis</code>ï¼Œå‘é€å¿ƒè·³ä¿æŒè¿æ¥æ´»è·ƒï¼Œåªè¦å‘é€ä¿æ´»å¿ƒè·³çš„æ—¶é—´é—´éš”å°äºé˜²ç«å¢™æ–­å¼€ç©ºé—²è¿æ¥çš„æ—¶é—´å³å¯ã€‚å¯¹äºä¸‹é¢é…ç½®ï¼Œåªæœ‰1ä¸ªç©ºé—²è¿æ¥åœ¨ç©ºé—²çŠ¶æ€ä¸‹ä¼šåœ¨5åˆ†é’Ÿå·¦å³è¿›è¡Œå¿ƒè·³ï¼Œä¿æŒé•¿æ—¶é—´å­˜æ´»ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">minIdle:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line"><span class="attr">validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line"><span class="attr">validationQueryTimeout:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">keepAlive:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line"><span class="string">....</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°ï¼š&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°ï¼š&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°ï¼š&lt;/h3&gt;&lt;p&gt;æµ‹è¯•ç¯å¢ƒå‘ç°äº†ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„ç°è±¡ï¼Œä¸€å°æœåŠ¡å™¨å‡ºç°äº†è¯·æ±‚å¡é¡¿15åˆ†é’Ÿç„¶åæ‰æ‰§è¡ŒSQLè¿”å›ç»“æœçš„ç°è±¡&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="socketRead0" scheme="https://www.elietio.xyz/tags/socketRead0/"/>
    
      <category term="keepAlive" scheme="https://www.elietio.xyz/tags/keepAlive/"/>
    
      <category term="druid" scheme="https://www.elietio.xyz/tags/druid/"/>
    
      <category term="socket timeout" scheme="https://www.elietio.xyz/tags/socket-timeout/"/>
    
  </entry>
  
  <entry>
    <title>è°·æ­ŒSLOT A/Bæœºåˆ¶ä¸‹å®‰å“åˆ·å…¥TWRPå’ŒMagiskä»¥åŠOTAçš„ä¸€äº›æ–¹æ³•</title>
    <link href="https://www.elietio.xyz/posts/d1df635e.html"/>
    <id>https://www.elietio.xyz/posts/d1df635e.html</id>
    <published>2019-10-12T14:14:49.000Z</published>
    <updated>2020-06-13T08:18:25.217Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>A/B ç³»ç»Ÿåˆ†åŒºæ˜¯ Google åœ¨ Android 7.0 æ—¶ä»£å¼•å…¥çš„æ–°æœºåˆ¶ï¼Œé‡‡ç”¨è¿™ä¸ªæœºåˆ¶çš„è®¾å¤‡æ‹¥æœ‰ Aã€B ä¸¤å¥—ç³»ç»Ÿåˆ†åŒºï¼Œç”¨æˆ·æ•°æ®åˆ™èƒ½å¤Ÿåœ¨è¿™ä¸¤å¥—ç³»ç»Ÿåˆ†åŒºä¹‹é—´å…±ç”¨ã€‚<br><a id="more"></a><br>è¿™ç§åˆ†åŒºæœºåˆ¶å¸¦æ¥çš„æœ€å¤§å¥½å¤„æ˜¯æ— ç¼ç³»ç»Ÿæ›´æ–°ï¼ˆseemless updatesï¼‰ï¼Œå½“æˆ‘ä»¬åœ¨ A ç³»ç»Ÿä¸­è¿›è¡Œ OTA æ›´æ–°æ—¶ï¼Œè€Œå®é™…æ›´æ–°çš„æ˜¯å¦ä¸ªä¸€å¹¶æœªå¯ç”¨çš„ B ç³»ç»Ÿã€‚æ‰‹æœºé‡å¯åï¼Œç³»ç»Ÿåˆ†åŒºä» A åˆ‡æ¢åˆ° Bæ–°ç³»ç»Ÿï¼Œä»‹äºæ­¤æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°OTAå‡çº§åä»ç„¶ä¿ç•™Magiskçš„Rootæƒé™ã€‚ç”±äºä½¿ç”¨äº† A/B åˆ†åŒºï¼Œå› æ­¤æ²¡æœ‰ç‹¬ç«‹çš„ Recovery åˆ†åŒºï¼›Recovery ç°åœ¨æ˜¯ Boot çš„ä¸€éƒ¨åˆ†ã€‚æ‰€ä»¥è¦é€šè¿‡ fastboot boot å®ç°ä¸´æ—¶ä»æŒ‡å®šé•œåƒå¯åŠ¨ï¼Œä»è€Œè¿›å…¥ TWRPï¼Œå¹¶é€šè¿‡åˆ·å…¥ twrp-installer å®ç°å¯¹ TWRP çš„æŒä¹…åŒ–ã€‚</p><h2 id="è§£é”Bootloader"><a href="#è§£é”Bootloader" class="headerlink" title="è§£é”Bootloader"></a>è§£é”Bootloader</h2><ol><li>åœ¨ã€Œè®¾ç½® - å…³äºæ‰‹æœºã€ä¸­ç‚¹å‡» 5 æ¬¡ã€Œç‰ˆæœ¬å·ã€å¯ç”¨å¼€å‘è€…é€‰é¡¹,å‰å¾€ã€Œè®¾ç½® - ç³»ç»Ÿ - å¼€å‘è€…é€‰é¡¹ã€ï¼Œåˆ†åˆ«å¯ç”¨ã€ŒOEM è§£é”ã€å’Œã€Œé«˜çº§é‡å¯ã€ </li><li>é•¿æŒ‰ç”µæºé”®ï¼Œä»ç”µæºèœå•ä¸­é€‰æ‹©ã€Œå¼•å¯¼å™¨æ¨¡å¼ã€ï¼Œæ‰‹æœºå°†ä¼šè‡ªåŠ¨é‡å¯è¿›å…¥ Bootloader æ¨¡å¼ã€‚</li><li><p>è¿æ¥ç”µè„‘ï¼Œåœ¨cmdçª—å£å†…è¾“å…¥adbå‘½ä»¤ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fastboot devices # æ£€æŸ¥è®¾å¤‡æ˜¯å¦è¿æ¥</span><br><span class="line">fastboot oem unlock</span><br></pre></td></tr></table></figure><p>å›è½¦ï¼Œæ‰‹æœºå³å‡ºç°è§£é”ç¡®è®¤ç•Œé¢ï¼ŒéŸ³é‡é”®è¿›è¡Œé€‰æ‹©-ã€ŒUNLOCK THE BOOTLOADERã€ï¼ŒæŒ‰ç”µæºé”®ç¡®è®¤ï¼Œæ‰‹æœºé‡å¯å¼€å§‹è§£é”</p></li></ol><h2 id="åˆ·å…¥-TWRP"><a href="#åˆ·å…¥-TWRP" class="headerlink" title="åˆ·å…¥ TWRP"></a>åˆ·å…¥ TWRP</h2><p>éœ€è¦å¦‚ä¸‹ï¼š</p><ul><li>ä¸‹è½½ <a href="https://twrp.me/Devices/" target="_blank" rel="noopener">TWRP</a></li><li>éœ€è¦ twrp.img å’Œ twrp-installer.zip ä¸¤ä¸ªæ–‡ä»¶</li></ul><p>æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li>æ‰§è¡Œ <code>adb reboot bootloader</code> è¿›å…¥ Bootloader ç•Œé¢</li><li>æ‰§è¡Œ <code>fastboot boot twrp.img</code> è¿›å…¥ä¸´æ—¶ TWRP</li><li>åœ¨TWRPä¸­åˆ·å…¥twrp-installer.zipä½¿TWRPæŒä¹…åŒ–ï¼Œå®‰è£…åŒ…ä¼šåœ¨ AB ä¸¤ä¸ªåˆ†åŒºä¸­éƒ½å®‰è£…ä¸€æ¬¡ TWRPï¼Œè¿™æ ·æ— è®ºæ‰‹æœºä»å“ªä¸ªåˆ†åŒºå¯åŠ¨éƒ½å¯ä»¥è¿›å…¥ TWRPã€‚</li></ol><h2 id="åˆ·å…¥Magiskè·å–Root"><a href="#åˆ·å…¥Magiskè·å–Root" class="headerlink" title="åˆ·å…¥Magiskè·å–Root"></a>åˆ·å…¥Magiskè·å–Root</h2><h3 id="å®‰è£…-Magiskï¼ˆä½¿ç”¨å›ºåŒ–TWRPï¼‰"><a href="#å®‰è£…-Magiskï¼ˆä½¿ç”¨å›ºåŒ–TWRPï¼‰" class="headerlink" title="å®‰è£… Magiskï¼ˆä½¿ç”¨å›ºåŒ–TWRPï¼‰"></a>å®‰è£… Magiskï¼ˆä½¿ç”¨å›ºåŒ–TWRPï¼‰</h3><p>éœ€è¦å¦‚ä¸‹ï¼š</p><ul><li>ä¸‹è½½<a href="https://forum.xda-developers.com/apps/magisk/official-magisk-v7-universal-systemless-t3473445" target="_blank" rel="noopener">Magisk-vX.X.zip åˆ·æœºåŒ…åŠ Magisk Manager.apk</a></li></ul><p>æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li>é‡å¯è¿›å»TERP</li><li>åœ¨ TWRP ä¸­åˆ·å…¥ä½ ä¸‹è½½çš„ Magisk å®‰è£…åŒ…ï¼ŒæˆåŠŸåé‡æ–°å¯åŠ¨æ‰‹æœº</li><li>å®‰è£… Magisk Manager çš„ apkï¼Œç¡®è®¤ Magisk å·²æˆåŠŸæ¿€æ´»</li></ol><h3 id="å®‰è£…-Magiskï¼ˆä½¿ç”¨ä¸´æ—¶-TWRPï¼‰"><a href="#å®‰è£…-Magiskï¼ˆä½¿ç”¨ä¸´æ—¶-TWRPï¼‰" class="headerlink" title="å®‰è£… Magiskï¼ˆä½¿ç”¨ä¸´æ—¶ TWRPï¼‰"></a>å®‰è£… Magiskï¼ˆä½¿ç”¨ä¸´æ—¶ TWRPï¼‰</h3><p>éœ€è¦å¦‚ä¸‹ï¼š</p><ul><li>ä¸‹è½½<a href="https://forum.xda-developers.com/apps/magisk/official-magisk-v7-universal-systemless-t3473445" target="_blank" rel="noopener">Magisk-vX.X.zip åˆ·æœºåŒ…åŠ Magisk Manager.apk</a></li><li>ä¸‹è½½ <a href="https://twrp.me/Devices/" target="_blank" rel="noopener">TWRP</a></li></ul><p>æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li>æ‰§è¡Œ <code>adb reboot bootloader</code> è¿›å…¥ Bootloader ç•Œé¢</li><li>æ‰§è¡Œ <code>fastboot boot TWRP.img</code> è¿›å…¥ä¸´æ—¶ TWRP</li><li>åœ¨ TWRP ä¸­åˆ·å…¥ä½ ä¸‹è½½çš„ Magisk å®‰è£…åŒ…<br>å¯é€‰æ‹©Sideload æ¨¡å¼ï¼ŒTWRP ä¸­è¾“å…¥æ­£ç¡®å¯†ç è§£å¯†åˆ†åŒºï¼Œå¹¶é€‰æ‹© Advanced -&gt; ADB Sideloadã€‚<br>æ‰§è¡Œ <code>adb sideload Magisk-vX.X.zip</code></li><li><code>fastboot reboot</code>é‡æ–°å¯åŠ¨æ‰‹æœº</li><li>å®‰è£… Magisk Manager çš„ apkï¼Œç¡®è®¤ Magisk å·²æˆåŠŸæ¿€æ´»</li></ol><h3 id="å®‰è£…-Magiskï¼ˆå…-TWRPï¼‰"><a href="#å®‰è£…-Magiskï¼ˆå…-TWRPï¼‰" class="headerlink" title="å®‰è£… Magiskï¼ˆå… TWRPï¼‰"></a>å®‰è£… Magiskï¼ˆå… TWRPï¼‰</h3><p>éœ€è¦å¦‚ä¸‹ï¼š</p><ul><li>ä¸‹è½½æˆ–æå–ROM æ‰€å¯¹åº”çš„ boot.img</li><li>ä¸‹è½½<a href="https://forum.xda-developers.com/apps/magisk/official-magisk-v7-universal-systemless-t3473445" target="_blank" rel="noopener">Magisk Manager.apk</a></li></ul><p>æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li>å®‰è£… Magisk Manager çš„ apkã€‚</li><li>ç”¨ Magisk Manager ç»™ boot.img æ‰‹åŠ¨è¡¥ä¸ï¼ˆ<code>install â€”â€” ä¿®è¡¥ boot é•œåƒæ–‡ä»¶</code>ï¼‰ï¼Œå°†è·å¾—çš„ <code>magisk_patched.img</code> ä¼ å›ç”µè„‘ã€‚</li><li><p>å†æ¬¡è¿›å…¥ Bootloaderï¼Œè¾“å…¥</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fastboot boot magisk_patched.img</span><br><span class="line">fastboot flash boot magisk_patched.img #å¦‚æœä¸Šé¢å‘½ä»¤ä¸ç”Ÿæ•ˆå¯ä»¥ä½¿ç”¨è¿™ä¸ªï¼ŒAndroid <span class="number">10</span></span><br></pre></td></tr></table></figure><p>æ¥åŠ è½½ç”Ÿæˆåçš„ boot åˆ†åŒºæ–‡ä»¶è·å–<strong>ä¸´æ—¶ root</strong> </p><ul><li>å¯ä½¿ç”¨<code>fastboot flash recovery magisk_patched.img</code>ä¿®å¤recovery image</li></ul></li><li>é‡å¯å¼€æœºåï¼ŒMagisk Manager æš‚æ—¶æœ‰äº† Root æƒé™ï¼Œæ­¤æ—¶å¯ä»¥åœ¨ Magisk Manager ä¸­æ­£å¼å®‰è£… Magiskï¼ˆ<code>å®‰è£…ï¼ˆinstallï¼‰â€”â€”installâ€”â€”Direct Installï¼ˆç›´æ¥å®‰è£…ï¼‰</code>ï¼‰ã€‚</li></ol><h2 id="OTAæ—¶çš„æ“ä½œ"><a href="#OTAæ—¶çš„æ“ä½œ" class="headerlink" title="OTAæ—¶çš„æ“ä½œ"></a>OTAæ—¶çš„æ“ä½œ</h2><h3 id="ä¿ç•™-TWRP"><a href="#ä¿ç•™-TWRP" class="headerlink" title="ä¿ç•™ TWRP"></a>ä¿ç•™ TWRP</h3><p>åœ¨ Magisk Manager ä¸­ä¸‹è½½å¹¶å®‰è£…æ’ä»¶ TWRP A/B Retenion Script</p><h3 id="ä¿ç•™-Root"><a href="#ä¿ç•™-Root" class="headerlink" title="ä¿ç•™ Root"></a>ä¿ç•™ Root</h3><ul><li>èƒ½æ£€æµ‹åˆ° OTA æ›´æ–°åï¼Œç‚¹å‡»è¿›å…¥ Magisk Manager åº”ç”¨ï¼Œæ‰¾åˆ°ä½äºä¸»ç•Œé¢çš„ã€Œå¸è½½ Magiskã€é€‰é¡¹ï¼Œç„¶åç‚¹å‡»ã€Œè¿˜åŸåŸå‚é•œåƒã€ï¼Œä¸è¦é‡å¯ç›´æ¥OTA(æˆ–è®¸ä¸éœ€è¦è¿˜åŸè¿™ä¸€æ­¥ï¼Ÿä½†æ˜¯magisk<a href="https://topjohnwu.github.io/Magisk/tutorials.html#ota-installation" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>æœ‰æåŠ)</li></ul><ol><li>ä½¿ç”¨ OTA æ›´æ–°å¹¶å®‰è£…ï¼ˆè‡ªåŠ¨ä¸‹è½½å…¨é‡åŒ…ï¼‰ï¼Œå®‰è£…å®Œæˆåä¸è¦é‡å¯</li><li>åœ¨ Magisk Manager ä¸­ã€Œå®‰è£… Magiskã€</li><li>é€‰æ‹©ã€Œå®‰è£…åˆ°æœªä½¿ç”¨çš„æ§½ä½ (OTA å)ã€(<code>Install to Inactive Slot (After OTA)</code>)</li><li>å†™å…¥å®Œæˆåé‡å¯å³å¯</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;A/B ç³»ç»Ÿåˆ†åŒºæ˜¯ Google åœ¨ Android 7.0 æ—¶ä»£å¼•å…¥çš„æ–°æœºåˆ¶ï¼Œé‡‡ç”¨è¿™ä¸ªæœºåˆ¶çš„è®¾å¤‡æ‹¥æœ‰ Aã€B ä¸¤å¥—ç³»ç»Ÿåˆ†åŒºï¼Œç”¨æˆ·æ•°æ®åˆ™èƒ½å¤Ÿåœ¨è¿™ä¸¤å¥—ç³»ç»Ÿåˆ†åŒºä¹‹é—´å…±ç”¨ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="https://www.elietio.xyz/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="å®‰å“" scheme="https://www.elietio.xyz/tags/%E5%AE%89%E5%8D%93/"/>
    
      <category term="ROOT" scheme="https://www.elietio.xyz/tags/ROOT/"/>
    
  </entry>
  
  <entry>
    <title>socketRead0é˜»å¡å¯¼è‡´çº¿ç¨‹å¡æ­»é—®é¢˜åˆ†ææ’æŸ¥</title>
    <link href="https://www.elietio.xyz/posts/774f1877.html"/>
    <id>https://www.elietio.xyz/posts/774f1877.html</id>
    <published>2019-10-11T12:26:54.000Z</published>
    <updated>2020-06-13T08:18:25.217Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯"><a href="#é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯" class="headerlink" title="é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯"></a>é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯</h3><p>æ¨¡æ‹Ÿç¯å¢ƒä¸­æˆ‘ä»¬å‘ç°ä¸€å°ä¸»å¤‡çš„Consumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯ï¼Œé¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹æœåŠ¡è®¢é˜…æƒ…å†µï¼Œå‘ç°æœåŠ¡è®¢é˜…æ­£å¸¸ï¼Œæ—¥å¿—æ˜¾ç¤ºæ­£å¸¸æ”¶åˆ°æ¶ˆæ¯ï¼Œä½†æ˜¯Listeneræ”¶åˆ°æ¶ˆæ¯åä¸šåŠ¡ä»£ç æœªæ‰§è¡Œï¼Œå¯¼è‡´è§¦å‘æ¶ˆæ¯è¶…æ—¶åé¦ˆã€‚<br><a id="more"></a></p><h3 id="é—®é¢˜æ’æŸ¥ï¼š"><a href="#é—®é¢˜æ’æŸ¥ï¼š" class="headerlink" title="é—®é¢˜æ’æŸ¥ï¼š"></a>é—®é¢˜æ’æŸ¥ï¼š</h3><p>ä¸ºä»€ä¹ˆä¸šåŠ¡ä»£ç ä¸æ‰§è¡Œå‘¢ï¼ŸæŸ¥çœ‹ä¸šåŠ¡ä»£ç æ—¥å¿—ï¼Œå‘ç°åœ¨ä¸€æ¬¡å¤„ç†ä¸­ï¼Œæ‰§è¡Œäº†ä¸€æ¬¡Restè¯·æ±‚åï¼Œå‰©ä½™ä»£ç æœªæ‰§è¡Œï¼Œæ•´ä¸ªçº¿ç¨‹holdä½äº†ï¼Œæ˜¯å¦ç”±äºè¯¥çº¿ç¨‹é˜»å¡å¯¼è‡´Listeneræ”¶åˆ°æ¶ˆæ¯åæ— æ³•å¤„ç†å‘¢ï¼Ÿæ¢³ç†äº†ä¸€ä¸‹ä»£ç é€»è¾‘ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯Guava EventBusçš„äº‹ä»¶ç›‘å¬å’Œå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œä¸šåŠ¡æ–¹æ³•ä½¿ç”¨@Subscribeè®¢é˜…åˆ°æ¶ˆæ¯åè¿›è¡Œå¤„ç†ï¼Œè€Œè®¢é˜…è€…å¯¹è±¡åœ¨å¤„ç†äº‹ä»¶æ—¶æ˜¯ä½¿ç”¨äº†synchronizedåŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯å› ä¸ºé”ä¸€ç›´æœªé‡Šæ”¾å¯¼è‡´å…¶ä»–æ¶ˆæ¯æ— æ³•è®¢é˜…å¤„ç†å—ï¼Ÿä¸ºä»€ä¹ˆçº¿ç¨‹ä¼šå¡ä½å‘¢ï¼Ÿ</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨JDKçš„jstackå·¥å…·æ‰“å°å‡ºæœåŠ¡çš„çº¿ç¨‹å †æ ˆä¿¡æ¯ï¼Œç¡®å®å‘ç°æœ‰çº¿ç¨‹Blockedå¹¶ä¸”ç­‰å¾…é”çš„æƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"IMT_328b84d5-3364-46cf-acfe-5e78de9f9cce_BL"</span> prio=<span class="number">10</span> tid=<span class="number">0xada04400</span> nid=<span class="number">0x7816</span> waiting <span class="keyword">for</span> monitor entry [<span class="number">0x9d1fe000</span>]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">at com.google.common.eventbus.Subscriber$SynchronizedSubscriber.invokeSubscriberMethod(Subscriber.java:<span class="number">150</span>)</span><br><span class="line">- waiting to lock &lt;<span class="number">0xb73e5c58</span>&gt; (a com.google.common.eventbus.Subscriber$SynchronizedSubscriber)</span><br><span class="line">at com.google.common.eventbus.Subscriber$<span class="number">1</span>.run(Subscriber.java:<span class="number">76</span>)</span><br><span class="line">    ......</span><br></pre></td></tr></table></figure><p><code>waiting to lock &lt;0xb73e5c58&gt; (a com.google.common.eventbus.Subscriber$SynchronizedSubscriber)</code><br>ä»è¿™ä¸ªä¿¡æ¯çœ‹ç¡®å®æ˜¯Subscribeçš„åŒæ­¥é”ï¼Œé‚£ä¹ˆç»§ç»­å¯»æ‰¾å½“å‰å æœ‰é”çš„çº¿ç¨‹ï¼Œå‘ç°å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"IMT_0945732d-7dc7-4d12-8e5f-c4f7e9f9f295_BL"</span> prio=<span class="number">10</span> tid=<span class="number">0xa7d02c00</span> nid=<span class="number">0x68ce</span> runnable [<span class="number">0x9e9fc000</span>]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">at java.net.SocketInputStream.socketRead0(Native Method)</span><br><span class="line">at java.net.SocketInputStream.read(SocketInputStream.java:<span class="number">152</span>)</span><br><span class="line">at java.net.SocketInputStream.read(SocketInputStream.java:<span class="number">122</span>)</span><br><span class="line">at org.apache.http.impl.io.AbstractSessionInputBuffer.fillBuffer(AbstractSessionInputBuffer.java:<span class="number">158</span>)</span><br><span class="line">at org.apache.http.impl.io.SocketInputBuffer.fillBuffer(SocketInputBuffer.java:<span class="number">82</span>)</span><br><span class="line">at org.apache.http.impl.io.AbstractSessionInputBuffer.readLine(AbstractSessionInputBuffer.java:<span class="number">271</span>)</span><br><span class="line">at org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:<span class="number">140</span>)</span><br><span class="line">at org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:<span class="number">57</span>)</span><br><span class="line">at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:<span class="number">259</span>)</span><br><span class="line">at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:<span class="number">281</span>)</span><br><span class="line">at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:<span class="number">259</span>)</span><br><span class="line">at org.apache.http.impl.conn.ManagedClientConnectionImpl.receiveResponseHeader(ManagedClientConnectionImpl.java:<span class="number">209</span>)</span><br><span class="line">at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:<span class="number">273</span>)</span><br><span class="line">at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:<span class="number">125</span>)</span><br><span class="line">at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:<span class="number">686</span>)</span><br><span class="line">at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:<span class="number">488</span>)</span><br><span class="line">at org.apache.http.impl.client.AbstractHttpClient.doExecute(AbstractHttpClient.java:<span class="number">884</span>)</span><br><span class="line">at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:<span class="number">82</span>)</span><br><span class="line">at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:<span class="number">107</span>)</span><br><span class="line">at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:<span class="number">55</span>)</span><br><span class="line">at com.netflix.loadbalancer.PingUrl.isAlive(PingUrl.java:<span class="number">126</span>)</span><br><span class="line">at com.netflix.loadbalancer.BaseLoadBalancer$SerialPingStrategy.pingServers(BaseLoadBalancer.java:<span class="number">902</span>)</span><br><span class="line">at com.netflix.loadbalancer.BaseLoadBalancer$Pinger.runPinger(BaseLoadBalancer.java:<span class="number">672</span>)</span><br><span class="line">at com.netflix.loadbalancer.BaseLoadBalancer.forceQuickPing(BaseLoadBalancer.java:<span class="number">814</span>)</span><br><span class="line">at com.netflix.loadbalancer.DynamicServerListLoadBalancer.updateAllServerList(DynamicServerListLoadBalancer.java:<span class="number">268</span>)</span><br><span class="line">at com.netflix.loadbalancer.DynamicServerListLoadBalancer.updateListOfServers(DynamicServerListLoadBalancer.java:<span class="number">250</span>)</span><br><span class="line">at com.netflix.loadbalancer.DynamicServerListLoadBalancer.restOfInit(DynamicServerListLoadBalancer.java:<span class="number">144</span>)</span><br><span class="line">at com.netflix.loadbalancer.DynamicServerListLoadBalancer.&lt;init&gt;(DynamicServerListLoadBalancer.java:<span class="number">95</span>)</span><br><span class="line">at com.netflix.loadbalancer.ZoneAwareLoadBalancer.&lt;init&gt;(ZoneAwareLoadBalancer.java:<span class="number">82</span>)</span><br><span class="line">at org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration.ribbonLoadBalancer(RibbonClientConfiguration.java:<span class="number">140</span>)</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>ä»ä»¥ä¸Šä¿¡æ¯å¯ä»¥çœ‹åˆ°ï¼Œçº¿ç¨‹ä¸€ç›´runnableçŠ¶æ€ï¼Œé”é‡Šæ”¾ä¸äº†ï¼Œä»£ç æœ€åæ‰§è¡Œåˆ°<code>java.net.SocketInputStream.socketRead0</code> å‘ç”Ÿé˜»å¡ï¼Œç»§ç»­å‘ä¸‹çœ‹ï¼Œç”±Apache Httpclientè°ƒç”¨ï¼Œå†å¾€åæ˜¯Ribbonã€‚è€Œæˆ‘ä»¬çš„æœåŠ¡ç¡®å®æ˜¯é€šè¿‡Ribbonç®¡ç†ç›®æ ‡æœåŠ¡IPå‘é€Restè¯·æ±‚ï¼Œç”±äºæœ¬æœåŠ¡å™¨ç½‘ç»œç‰¹æ®Šï¼Œå¹¶æœªæ³¨å†Œåˆ°Eurekaç®¡ç†ï¼Œè€Œæ˜¯ç›´æ¥æŠŠå¤šæ´»çš„ç›®æ ‡æœåŠ¡åˆ—è¡¨å†™åœ¨é…ç½®ä¸­ç»´æŠ¤ï¼ŒåŠ ä¸Šä¹‹å‰æ—¥å¿—çš„åˆ†æï¼Œçº¿ç¨‹ç¡®å®æ˜¯å¡åœ¨Restè¯·æ±‚ä¸Šï¼Œè¿™å°±å¾ˆå¥‡æ€ªäº†ï¼ŒConnection Timeoutå’ŒRead Timeoutæˆ‘ä»¬éƒ½æœ‰è®¾ç½®ï¼Œä¸ºä½•æœªç”Ÿæ•ˆï¼Ÿè€Œä¸”è¿™ä¸ªé—®é¢˜åªåœ¨æœ¬ç¯å¢ƒå‘ç”Ÿï¼Œå¹¶ä¸”é‡å¯åä¾ç„¶ç¨³å®šå¤ç°ã€‚é¦–å…ˆå¯¹è®¿é—®çš„ç›®æ ‡æœåŠ¡å™¨ç«¯å£telnetï¼Œä¸€åˆ‡æ­£å¸¸ï¼Œè€Œæ‰§è¡ŒnetstatæŸ¥çœ‹æœåŠ¡å™¨çš„ç½‘ç»œè¿æ¥ï¼Œå‘ç°æœ¬æœºä¸ä¸€ä¸ªç›®æ ‡æœåŠ¡ç«¯å£ä¸€ç›´å­˜åœ¨ä¸€ä¸ªESTABLISHEDçš„tcpè¿æ¥ï¼Œæ˜¯å¦è¿™ä¸ªä¸€ç›´é˜»å¡ç€ï¼Ÿ</p><p>æŸ¥é˜…äº†ä¸€ä¸‹socketRead0é˜»å¡çš„é—®é¢˜ï¼Œä»ç½‘ä¸Šèµ„æ–™çœ‹ï¼Œè¿™ä¸ªé—®é¢˜ç¡®å®æœ‰å­˜åœ¨ï¼Œå¹¶ä¸”ä»ä¸€ç¯‡åšå®¢<a href="https://suclogger.me/a-not-running-runnable/" target="_blank" rel="noopener">ä»é”æ­»çš„RUNNABLEçº¿ç¨‹è°ˆUNIXçš„I/Oæ¨¡å‹</a>ä¸­å‘ç°è¿™æ ·å†™é“ï¼ŒJAVA IOåº“ï¼ˆjava version â€œ1.8.0_131â€ï¼‰çš„ä¸€ä¸ªå‘ã€‚</p><blockquote><p>ç”±äºæŸäº›è¯·æ±‚çš„TCPåŒ…ä¼ è¾“è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸å¯¼è‡´<code>poll</code>åœ¨æ²¡æœ‰çœŸå®å¯è¯»æ•°æ®æƒ…å†µä¸‹è¿”å›å¯è¯»æ ‡è¯†ï¼Œä½¿å¾—é˜»å¡çš„<code>recv</code>æ–¹æ³•æ°¸è¿œé˜»å¡ä¸‹å»ï¼Œä»è€Œä½¿å¾—å½“å‰çº¿ç¨‹ä¸€ç›´å¤„äº<code>RUNNABLE</code>ï¼Œå½“çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹éƒ½è¢«è¿™ç§çº¿ç¨‹å æ®ä¹‹åï¼Œå°±å†ä¹Ÿæ— æ³•å¤„ç†æ–°æäº¤çš„ä»»åŠ¡äº†ã€‚</p></blockquote><p>ç°åœ¨<a href="https://bugs.openjdk.java.net/browse/JDK-8075484" target="_blank" rel="noopener">open jdk</a>å·²ç»ä¿®å¤äº†è¿™ä¸€bug <code>SocketInputStream.socketRead0 can hang even with soTimeout set</code></p><p>ä½†æ˜¯ä»è¿™ä¸ªæ¥çœ‹ï¼Œå‘ç”Ÿçš„æ¦‚ç‡åº”è¯¥å¾ˆä½çš„ï¼Œè€Œæˆ‘ä»¬æœåŠ¡å´æ˜¯ç™¾åˆ†ç™¾å‘ç”Ÿï¼Œé‡å¯åä¾æ—§ï¼Œæ‰€ä»¥ç»§ç»­ä»å †æ ˆä¿¡æ¯ä¸Šåˆ†æã€‚</p><p>ä»å †æ ˆä¿¡æ¯ä¸Šåˆ†æå¯çŸ¥Ribbonåœ¨æ›´æ–°æœåŠ¡åˆ—è¡¨updateAllServerListï¼Œç„¶åæ‰§è¡Œäº†PingUrlçš„isAliveï¼Œè°ƒç”¨äº†HttpClientå‘ç”Ÿäº†é˜»å¡ã€‚é»˜è®¤æƒ…å†µä¸‹æœåŠ¡å¯åŠ¨åRibbonå¹¶ä¸ä¼šç›´æ¥åŠ è½½æœåŠ¡åˆ—è¡¨ï¼Œè€Œæ˜¯å½“ç¬¬ä¸€æ¬¡Restè¯·æ±‚è°ƒç”¨æ—¶ï¼ŒRibbonä¼šå»åŠ è½½æœåŠ¡åˆ—è¡¨ï¼Œå¹¶ä¸”æ‰§è¡Œè®¾ç½®çš„PingUrlæ–¹æ³•åˆ¤æ–­æœåŠ¡èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ï¼ŒåŠ è½½å¥½æœåŠ¡åˆ—è¡¨ä¹‹åæ ¹æ®è®¾ç½®çš„Loadbalanceç­–ç•¥è°ƒç”¨æœåŠ¡èŠ‚ç‚¹ï¼Œè¯¥çº¿ç¨‹åº”è¯¥æ˜¯holdåœ¨PingUrlè¿™ä¸€æ­¥ä¸Šã€‚</p><p>PingUrlæ˜¯æœåŠ¡ä¸­Ribboné»˜è®¤è®¾ç½®çš„ribbonPingå®ç°ï¼Œç”¨äºæ£€æµ‹æœåŠ¡IPåˆ—è¡¨ã€‚ç¿»çœ‹PingUrlä¸­isAliveæ–¹æ³•çš„æºç ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">String urlStr   = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">if</span> (isSecure)&#123;</span><br><span class="line">       urlStr = <span class="string">"https://"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       urlStr = <span class="string">"http://"</span>;</span><br><span class="line">&#125;</span><br><span class="line">urlStr += server.getId();</span><br><span class="line">urlStr += getPingAppendString();</span><br><span class="line"><span class="keyword">boolean</span> isAlive = <span class="keyword">false</span>;</span><br><span class="line">HttpClient httpClient = <span class="keyword">new</span> DefaultHttpClient();</span><br><span class="line">HttpUriRequest getRequest = <span class="keyword">new</span> HttpGet(urlStr);</span><br><span class="line">String content=<span class="keyword">null</span>;</span><br><span class="line">httpResponse response = httpClient.execute(getRequest);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºå®é™…ä¸Šå°±æ˜¯è°ƒç”¨httpClinetå‘é€äº†ä¸€æ¬¡GETè¯·æ±‚ï¼Œè¯·æ±‚çš„URLå°±æ˜¯æœåŠ¡åˆ—è¡¨çš„æ¯ä¸€ä¸ªæœåŠ¡ç«¯å£+æŒ‡å®šçš„URLã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ¨¡æ‹ŸåŒæ ·çš„GETè¯·æ±‚ï¼Œæ‰§è¡Œcurlå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET 'http://server:port'</span><br></pre></td></tr></table></figure><p>æœç„¶ï¼Œæœ‰ä¸€å°ç›®æ ‡æœåŠ¡å™¨æ²¡æœ‰å“åº”ï¼Œä¸€ç›´å¡ä½ï¼Œè¿™å°æœåŠ¡å™¨æ­£æ˜¯ä¸Šé¢tcpä¸€ç›´å¤„äºESTABLISHEDçŠ¶æ€çš„æœåŠ¡å™¨ã€‚çœ‹æ¥é—®é¢˜åº”è¯¥æ˜¯ç”±äºè¿™å°æœåŠ¡å™¨å¯¼è‡´çš„ï¼Œç™»é™†è¿™å°æœåŠ¡å™¨ä¹‹åï¼Œdf -hç›´æ¥å¡ä½ä¸æ˜¾ç¤ºç»“æœï¼Œæ€€ç–‘ç”¨æˆ·ç›®å½•ä¸‹å…±äº«å­˜å‚¨å‡ºé—®é¢˜äº†ï¼Œcdåˆ°ç”¨æˆ·ç›®å½•ä¸‹ï¼Œæ‰§è¡Œlsä¾ç„¶å¡ä½æœªè¿”å›ï¼Œæ‰¾è¿ç»´åŒå­¦å¤„ç†åï¼Œå†æ¬¡æ‰§è¡Œcurlåæ­£å¸¸ï¼Œè€ŒæœåŠ¡è¿˜æ˜¯é˜»å¡çŠ¶æ€ï¼Œé‡å¯åESTABLISHEDçŠ¶æ€tcpè¿æ¥é‡Šæ”¾ï¼ŒæœåŠ¡æ¢å¤ï¼Œæ­£å¸¸å¤„ç†æ¶ˆæ¯ã€‚</p><h3 id="é—®é¢˜è¿˜åŸï¼š"><a href="#é—®é¢˜è¿˜åŸï¼š" class="headerlink" title="é—®é¢˜è¿˜åŸï¼š"></a>é—®é¢˜è¿˜åŸï¼š</h3><p>ç”±äºä¸€å°æœåŠ¡å™¨å…±äº«å­˜å‚¨æŒ‚äº†ï¼Œå¯¼è‡´æœåŠ¡å™¨ä¸ŠtomcatæœåŠ¡æ— æ³•å¤„ç†è¿œç¨‹çš„è¯·æ±‚ï¼Œæ²¡æœ‰ä»»ä½•è¿”å›ï¼Œè¿æ¥ä¸€ç›´å¤„äºESTABLISHEDçŠ¶æ€æœªé‡Šæ”¾,è™½ç„¶telnetæœåŠ¡ç«¯å£æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯httpè¯·æ±‚ä¼šholdä½æ— å“åº”ã€‚è€ŒconsumeræœåŠ¡ä½¿ç”¨Ribbonç®¡ç†ç›®æ ‡æœåŠ¡èŠ‚ç‚¹ï¼Œå½“æœåŠ¡é‡å¯åï¼Œç¬¬ä¸€æ¬¡æ‰§è¡ŒRestè¯·æ±‚ï¼ŒRibbonä¼šå»åŠ è½½æœåŠ¡åˆ—è¡¨å¹¶è¿›è¡ŒribbonPingæ£€æµ‹æ‰€æœ‰çš„ç›®æ ‡èŠ‚ç‚¹æ˜¯å¦å¼‚å¸¸ï¼Œé»˜è®¤æ˜¯é€šè¿‡ä¸€ä¸ªGETè¯·æ±‚ï¼Œå› æ­¤å½“æ£€æµ‹åˆ°æ•…éšœçš„ç›®æ ‡èŠ‚ç‚¹åï¼Œè¿æ¥é‡Šæ”¾ä¸äº†ï¼Œçº¿ç¨‹ä¸€ç›´holdï¼Œè€ŒSubscribeçš„åŒæ­¥é”ä¹Ÿä¸€ç›´è¢«çº¿ç¨‹å ç”¨æ— æ³•é‡Šæ”¾ï¼Œå¯¼è‡´å…¶ä»–æ¶ˆæ¯è¿‡æ¥æ—¶æ— æ³•å¤„ç†ä»è€Œè¶…æ—¶ï¼Œè€Œé‡å¯åä¾ç„¶é‡ç°è¿™ä¸€è¿‡ç¨‹å¯¼è‡´é—®é¢˜ä¾æ—§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°ï¼šConsumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯&lt;/h3&gt;&lt;p&gt;æ¨¡æ‹Ÿç¯å¢ƒä¸­æˆ‘ä»¬å‘ç°ä¸€å°ä¸»å¤‡çš„Consumerè¿›ç¨‹æ— æ³•å¤„ç†æ¶ˆæ¯ï¼Œé¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹æœåŠ¡è®¢é˜…æƒ…å†µï¼Œå‘ç°æœåŠ¡è®¢é˜…æ­£å¸¸ï¼Œæ—¥å¿—æ˜¾ç¤ºæ­£å¸¸æ”¶åˆ°æ¶ˆæ¯ï¼Œä½†æ˜¯Listeneræ”¶åˆ°æ¶ˆæ¯åä¸šåŠ¡ä»£ç æœªæ‰§è¡Œï¼Œå¯¼è‡´è§¦å‘æ¶ˆæ¯è¶…æ—¶åé¦ˆã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="æ’é”™" scheme="https://www.elietio.xyz/tags/%E6%8E%92%E9%94%99/"/>
    
      <category term="å¼‚å¸¸" scheme="https://www.elietio.xyz/tags/%E5%BC%82%E5%B8%B8/"/>
    
      <category term="socketRead0" scheme="https://www.elietio.xyz/tags/socketRead0/"/>
    
  </entry>
  
  <entry>
    <title>Oracleæ‰¹é‡æ’å…¥æ•°æ®å¼‚å¸¸ java.lang.ArrayIndexOutOfBoundsException</title>
    <link href="https://www.elietio.xyz/posts/e6c1ebcb.html"/>
    <id>https://www.elietio.xyz/posts/e6c1ebcb.html</id>
    <published>2019-08-28T12:14:49.000Z</published>
    <updated>2020-06-14T02:32:54.322Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>ä»Šå¤©æµ‹è¯•è¿‡ç¨‹ä¸­ä¸€ä¸ªOracle mybatisæ‰¹é‡æ’å…¥æ•°æ®çš„ä»£ç æŠ¥å‡ºäº†ä¸€ä¸ªå¼‚å¸¸<br> <code>Caused by: java.lang.ArrayIndexOutOfBoundsException: -32768</code><br><a id="more"></a><br>å…·ä½“å¼‚å¸¸å †æ ˆä¿¡æ¯å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.ArrayIndexOutOfBoundsException: -<span class="number">32768</span></span><br><span class="line">        at oracle.jdbc.driver.OraclePreparedStatement.setupBindBuffers(OraclePreparedStatement.java:<span class="number">2673</span>)</span><br><span class="line">        at oracle.jdbc.driver.OraclePreparedStatement.processCompletedBindRow(OraclePreparedStatement.java:<span class="number">2206</span>)</span><br><span class="line">        at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:<span class="number">3365</span>)</span><br><span class="line">        at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:<span class="number">3476</span>)</span><br><span class="line">        at com.alibaba.druid.filter.FilterChainImpl.preparedStatement_execute(FilterChainImpl.java:<span class="number">3409</span>)</span><br><span class="line">        at com.alibaba.druid.wall.WallFilter.preparedStatement_execute(WallFilter.java:<span class="number">619</span>)</span><br><span class="line">        at com.alibaba.druid.filter.FilterChainImpl.preparedStatement_execute(FilterChainImpl.java:<span class="number">3407</span>)</span><br><span class="line">        at com.alibaba.druid.filter.FilterAdapter.preparedStatement_execute(FilterAdapter.java:<span class="number">1080</span>)</span><br><span class="line">        at com.alibaba.druid.filter.FilterChainImpl.preparedStatement_execute(FilterChainImpl.java:<span class="number">3407</span>)</span><br><span class="line">        at com.alibaba.druid.filter.FilterEventAdapter.preparedStatement_execute(FilterEventAdapter.java:<span class="number">440</span>)</span><br><span class="line">        at com.alibaba.druid.filter.FilterChainImpl.preparedStatement_execute(FilterChainImpl.java:<span class="number">3407</span>)</span><br><span class="line">        at com.alibaba.druid.proxy.jdbc.PreparedStatementProxyImpl.execute(PreparedStatementProxyImpl.java:<span class="number">167</span>)</span><br><span class="line">        at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:<span class="number">498</span>)</span><br></pre></td></tr></table></figure></p><p>æ„Ÿè§‰å¾ˆå¥‡æ€ªï¼ŒæŸ¥çœ‹æ—¥å¿—SQLæ‰“å°ï¼Œè¿™ä¸ªæ–¹ä¹Ÿå°±æ‹¼æ¥äº†400æ¡SQLï¼Œå‚æ•°ä¹Ÿä¸æ˜¯å¾ˆå¤šï¼Œäºæ˜¯ä»æ—¥å¿—é‡Œé¢copyäº†ä¸€ä¸‹æ¥å£å…¥å‚åœ¨æœ¬åœ°ç”¨Postman debugäº†ä¸€ä¸‹ï¼Œç»“æœç¬¬ä¸€æ¬¡å±…ç„¶å…¥åº“æˆåŠŸï¼Œå†æ‰§è¡Œä¸€æ¬¡ï¼Œå‡ºç°äº†åŒæ ·çš„é”™è¯¯ï¼Œå†æ‰§è¡Œï¼ŒåˆæˆåŠŸâ€¦â€¦åå¤å¦‚æ­¤ï¼Œé¡¿æ—¶æ‡µé€¼ã€‚çœ‹å¼‚å¸¸ä¿¡æ¯ï¼Œæ‰§è¡ŒojdbcåŒ…å†…çš„<code>oracle.jdbc.driver.OraclePreparedStatement.setupBindBuffers</code>æ–¹æ³•æ•°ç»„ä¸‹æ ‡è¶Šç•Œï¼Œå¥½å§ï¼Œæ”¾Googleæœä¸€ä¸‹ï¼Œå‘ç°ä¸€æ®µè¿™æ ·æè¿°</p><blockquote><p>The 10g driver apparently keeps a global serialnumber for all parameters in the entire batch, with a â€œshortâ€variable. So you can have at most 32768 parameters in the batch. I was havingthe same exception because I have a INSERT statement with 42 parameters and mybatches can be as big as 1000 records, so 42000 &gt; 32768 and this overflowsto a negative index. I reduced the batch factor to 100 to be safe, and all iswell. I guess your update DML should have a larger number of parameters perrecord, right? (My diagnostic of the bug is just deduction from the symptoms)<br><a href="https://community.oracle.com/thread/599441?start=15&amp;tstart=0&gt;" target="_blank" rel="noopener">https://community.oracle.com/thread/599441?start=15&amp;tstart=0&gt;</a></p></blockquote><p>è¯´æ˜¯10g driver statementæœ€å¤§å…è®¸å‚æ•°ä¸ªæ•°ä¸º32768ï¼Œè¶…è¿‡ä¼šæŠ¥é”™ã€‚ä¼¼ä¹æœ‰ç‚¹ç±»ä¼¼ï¼Œä½†æ˜¯æˆ‘åªæ’å…¥äº†400æ¡å•Šï¼Œè€Œä¸”æ¯ä¸ªSQLå‚æ•°åªæœ‰9ä¸ªï¼Œä¹Ÿå°±æ˜¯3600ä¸ªå‚æ•°ï¼Œè¿œå°äº32768ã€‚<br>è¿˜æœ‰å¦å¤–ä¸€ä¸ªè¯´æ³•</p><blockquote><p>In Oracle Metalink (Oracleâ€™s support site - Note ID 736273.1) I found that this is a bug in JDBC adapter (version 10.2.0.0.0 to 11.1.0.7.0) that when you call preparedStatement with more than 7 positional parameters then JDBC will throw this error.<br><a href="https://stackoverflow.com/questions/277744/jdbc-oracle-arrayindexoutofboundsexception" target="_blank" rel="noopener">https://stackoverflow.com/questions/277744/jdbc-oracle-arrayindexoutofboundsexception</a></p></blockquote><p>æ„Ÿè§‰ä¹Ÿä¸ç¬¦åˆï¼Œä½†æ˜¯ä»æœç´¢çš„ç»“æœçœ‹ï¼Œ10g çš„ ojdbcä¼¼ä¹ç¡®å®æœ‰äº›é—®é¢˜ï¼Œäºæ˜¯çœ‹äº†ä¸‹pomï¼Œä¹–ä¹–<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ojdbc14<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ojdbc14<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>10.2.0.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>é‚£ä¹ˆæ¢ä¸ªç‰ˆæœ¬å§ï¼Œæˆ‘ä»¬æ•°æ®åº“æ˜¯11.2gçš„ï¼Œäºæ˜¯æ¢äº†ä¸ªojdbc6<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.oracle<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ojdbc6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>11.2.0.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>å—¯ï¼Œè¿™æ¬¡å¾ˆé¡ºåˆ©ï¼Œæ²¡æœ‰å†å‡ºç°å¼‚å¸¸ï¼Œçœ‹æ¥ojdbc14ç¡®å®æœ‰äº›é—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯æ¯”è¾ƒç–‘æƒ‘ï¼Œå•å•400æ¡æ•°æ®ï¼Œæ¯æ¡9ä¸ªå‚æ•°å°±å·²ç»è¶…è¿‡é™åˆ¶äº†å—ï¼Ÿ<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertBatch"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.List"</span>&gt;</span></span><br><span class="line">        INSERT INTO table (a, b, c, d ......</span><br><span class="line">        )</span><br><span class="line">        SELECT SEQ.nextval,A.* FROM (</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">separator</span>=<span class="string">"union all"</span>&gt;</span></span><br><span class="line">            SELECT</span><br><span class="line">            #&#123;item.a&#125;,#&#123;item.b&#125;,#&#123;item.c&#125;,#&#123;item.d&#125;......</span><br><span class="line">            FROM dual</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span>) A</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>æ‹¼æ¥ä¸‹æ¥å®é™…SQLå¦‚ä¸‹ï¼Œç±»ä¼¼äºinsert  into tableA select * from tableB<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span> (a, b, c, d ......)</span><br><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">    SEQ.nextval,</span><br><span class="line">    A.*</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">( <span class="keyword">SELECT</span> ?, ?, ?, ?, ?, ?, ?, ? <span class="keyword">FROM</span> dual </span><br><span class="line"> <span class="keyword">union</span> all </span><br><span class="line">   <span class="keyword">SELECT</span> ?, ?, ?, ?, ?, ?, ?, ? <span class="keyword">FROM</span> dual </span><br><span class="line"> <span class="keyword">union</span> all </span><br><span class="line">      <span class="keyword">SELECT</span> ?, ?, ?, ?, ?, ?, ?, ? <span class="keyword">FROM</span> dual</span><br><span class="line"> <span class="keyword">union</span> all </span><br><span class="line"> ......</span><br><span class="line">    ) A</span><br></pre></td></tr></table></figure></p><p>å®é™…debugäº†ä¸€ä¸‹ï¼Œç¡®å®å‡ºå¼‚å¸¸çš„æ—¶å€™OraclePreparedStatement.setupBindBuffersæ–¹æ³•shortæ•°ç»„ bindIndicatorså¤§å°è¶…è¿‡äº†32768ï¼Œæ¢æˆojdbc6çš„æ—¶å€™è¯¥æ–¹æ³•æœªè°ƒç”¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¤©æµ‹è¯•è¿‡ç¨‹ä¸­ä¸€ä¸ªOracle mybatisæ‰¹é‡æ’å…¥æ•°æ®çš„ä»£ç æŠ¥å‡ºäº†ä¸€ä¸ªå¼‚å¸¸&lt;br&gt; &lt;code&gt;Caused by: java.lang.ArrayIndexOutOfBoundsException: -32768&lt;/code&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="Java" scheme="https://www.elietio.xyz/tags/Java/"/>
    
      <category term="å¼‚å¸¸" scheme="https://www.elietio.xyz/tags/%E5%BC%82%E5%B8%B8/"/>
    
      <category term="Oracle" scheme="https://www.elietio.xyz/tags/Oracle/"/>
    
  </entry>
  
  <entry>
    <title>æƒ¨ç—›ï¼Œç¬”è®°æœ¬æœºæ¢°ç¡¬ç›˜çªç„¶è·ªäº†</title>
    <link href="https://www.elietio.xyz/posts/8f7990e0.html"/>
    <id>https://www.elietio.xyz/posts/8f7990e0.html</id>
    <published>2019-08-14T12:37:06.000Z</published>
    <updated>2020-06-13T08:18:25.217Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>æ„Ÿè§‰å¯èƒ½æ˜¨å¤©éƒ½è·ªäº†ï¼Œä¸€ç›´æ²¡æ³¨æ„ï¼Œä»Šå¤©æ™šä¸Šæ‰å‘ç°åªå‰©ä¸€ä¸ªå›ºæ€Cç›˜äº†ï¼Œè®¾å¤‡ç®¡ç†å™¨ä¹Ÿæ‰¾ä¸åˆ°æœºæ¢°ç¡¬ç›˜ï¼Œæ‹”äº†é‡æ’ä¹Ÿä¸è½¬ï¼Œå¿ƒå¡ï¼Œæ˜æ˜è¿™å—1Tæ—¥ç«‹ä¹Ÿå°±2å¹´å¤šå•Šï¼Œé€šç”µä¹Ÿå°±6000hï¼Œæˆ‘å¯¹æ—¥ç«‹è¿˜ç‰¹æœ‰å¥½æ„Ÿçš„è¯´ï¼Œä¹°äº†å¥½å‡ å—äº†ï¼Œ<br>æƒ³åˆ°å¥½å¤šä¸œè¥¿ä¹Ÿæ²¡å¤‡ä»½å°±è›‹ç–¼</p> <a id="more"></a><p>ä»å„ä¸ªè®ºå›æ”¶é›†çš„æ­Œæ›²ã€å›¾åŒ…ã€æ¼«ç”»ï¼Œè¿˜æœ‰å„ç§è½¯ä»¶ã€æ–‡æ¡£ã€é…ç½®ç­‰ç­‰ï¼Œè™½ç„¶ä¸€éƒ¨åˆ†ç½‘ç›˜æœ‰å¤‡ä»½ï¼Œä½†æ˜¯å…¨éƒ¨æ‹–ä¸‹æ¥ä¹Ÿå¾—è´¹ä¸å°‘åŠŸå¤«ï¼Œè€Œä¸”æœ‰äº›ä¸œè¥¿å®Œå…¨æƒ³ä¸èµ·äº†ã€‚ã€‚ã€‚å”¯ä¸€åº†å¹¸çš„æ˜¯åšå®¢çš„ä¹‹å‰å¤‡ä»½äº†ä¸€ä»½åˆ°Gitä¸Šï¼Œ<a href="https://www.elietio.xyz/2019/04/hexo-themes-subtree.html">hexoå’Œä¸»é¢˜å¤šè®¾å¤‡åŒæ­¥</a>ï¼Œo(ï¸¶ï¸¿ï¸¶)o å”‰ï¼Œä»¥åè¿˜æ˜¯å¤šåšå¤‡ä»½å§ã€‚</p><p>æ–°ä¹°çš„2Tè¥¿æ•°è“ç›˜ï¼Œç©ºç©ºå¦‚ä¹Ÿã€‚</p><p><img src="/img/hdd/hdd.png" alt="hdd"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ„Ÿè§‰å¯èƒ½æ˜¨å¤©éƒ½è·ªäº†ï¼Œä¸€ç›´æ²¡æ³¨æ„ï¼Œä»Šå¤©æ™šä¸Šæ‰å‘ç°åªå‰©ä¸€ä¸ªå›ºæ€Cç›˜äº†ï¼Œè®¾å¤‡ç®¡ç†å™¨ä¹Ÿæ‰¾ä¸åˆ°æœºæ¢°ç¡¬ç›˜ï¼Œæ‹”äº†é‡æ’ä¹Ÿä¸è½¬ï¼Œå¿ƒå¡ï¼Œæ˜æ˜è¿™å—1Tæ—¥ç«‹ä¹Ÿå°±2å¹´å¤šå•Šï¼Œé€šç”µä¹Ÿå°±6000hï¼Œæˆ‘å¯¹æ—¥ç«‹è¿˜ç‰¹æœ‰å¥½æ„Ÿçš„è¯´ï¼Œä¹°äº†å¥½å‡ å—äº†ï¼Œ&lt;br&gt;æƒ³åˆ°å¥½å¤šä¸œè¥¿ä¹Ÿæ²¡å¤‡ä»½å°±è›‹ç–¼&lt;/p&gt;
    
    </summary>
    
      <category term="éšç¬”" scheme="https://www.elietio.xyz/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="ç¡¬ç›˜" scheme="https://www.elietio.xyz/tags/%E7%A1%AC%E7%9B%98/"/>
    
  </entry>
  
  <entry>
    <title>Jedis Unexpected end of stream å¼‚å¸¸</title>
    <link href="https://www.elietio.xyz/posts/ab6869b3.html"/>
    <id>https://www.elietio.xyz/posts/ab6869b3.html</id>
    <published>2019-05-12T11:37:06.000Z</published>
    <updated>2020-06-14T02:29:54.279Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>è¿™å‘¨æœ«ç‰ˆæœ¬å‡çº§é‡åˆ°ä¸€ä¸ªJediså¼‚å¸¸ï¼Œå…¶ä¸­ä¸€æ­¥æ˜¯ä»Mysqlä¸­çš„ä¸´æ—¶è¡¨æŸ¥æ‰¾æ•°æ®ç„¶åæ‹¼è£…keyä»Redisä¸­æŸ¥æ‰¾å¯¹åº”çš„ç¼“å­˜æ•°æ®å¹¶ä¿®æ”¹ã€‚ç„¶è€Œå‡çº§è¿‡ç¨‹ä¸­ä¿®æ•°ç¨‹åºå´æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸<code>Unexpected end of stream</code>æ„å¤–åœæ­¢ã€‚<br><a id="more"></a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">redis.clients.jedis.exceptions.JedisConnectionException: Unexpected end of stream.</span><br><span class="line">    at redis.clients.util.RedisInputStream.ensureFill(RedisInputStream.java:<span class="number">199</span>)</span><br><span class="line">    at redis.clients.util.RedisInputStream.readByte(RedisInputStream.java:<span class="number">40</span>)</span><br><span class="line">    at redis.clients.jedis.Protocol.process(Protocol.java:<span class="number">151</span>)</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>Redisé‡‡ç”¨çš„æ˜¯codisæ­å»ºçš„é›†ç¾¤ï¼Œæˆ‘ä»¬ç«‹å³Telnetè®¿é—®çš„ç«¯å£ï¼Œå¹¶åœ¨æœåŠ¡å™¨ä½¿ç”¨Redis-cliç›´æ¥è¿æ¥ï¼Œç»“æœéƒ½æœªå‘ç°å¼‚å¸¸ã€‚äºæ˜¯ç«‹å³å»ç½‘ä¸ŠæŸ¥æ‰¾ç›¸å…³èµ„æ–™ï¼Œç½‘ä¸Šéƒ½è¿™æ ·æè¿°æ­¤å¼‚å¸¸ã€‚</p><p>å®¢æˆ·ç«¯ç¼“å†²åŒºå¼‚å¸¸<br>è¿™ä¸ªå¼‚å¸¸æ˜¯å®¢æˆ·ç«¯ç¼“å†²åŒºå¼‚å¸¸ï¼Œäº§ç”Ÿè¿™ä¸ªé—®é¢˜å¯èƒ½æœ‰ä¸‰ä¸ªåŸå› ï¼š</p><ol><li><p>å¤šä¸ªçº¿ç¨‹ä½¿ç”¨ä¸€ä¸ªJedisè¿æ¥ã€‚</p></li><li><p>å®¢æˆ·ç«¯ç¼“å†²åŒºæ»¡äº†,Redisæœ‰ä¸‰ç§å®¢æˆ·ç«¯ç¼“å†²åŒºï¼š<br> æ™®é€šå®¢æˆ·ç«¯ç¼“å†²åŒº(normal)ï¼šç”¨äºæ¥å—æ™®é€šçš„å‘½ä»¤ï¼Œä¾‹å¦‚getã€setã€msetã€hgetallã€zrangeç­‰ã€‚<br> slaveå®¢æˆ·ç«¯ç¼“å†²åŒº(slave)ï¼šç”¨äºåŒæ­¥masterèŠ‚ç‚¹çš„å†™å‘½ä»¤ï¼Œå®Œæˆå¤åˆ¶ã€‚<br> å‘å¸ƒè®¢é˜…ç¼“å†²åŒº(pubsub)ï¼špubsubä¸æ˜¯æ™®é€šçš„å‘½ä»¤ï¼Œå› æ­¤æœ‰å•ç‹¬çš„ç¼“å†²åŒºã€‚<br> Rediså®¢æˆ·ç«¯ç¼“å†²åŒºé…ç½®çš„æ ¼å¼æ˜¯ï¼š</p> <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">client-output-buffer-limit</span> <span class="string">&lt;class&gt;</span> <span class="string">&lt;hard</span> <span class="string">limit&gt;</span> <span class="string">&lt;soft</span> <span class="string">limit&gt;</span> <span class="string">&lt;soft</span> <span class="string">seconds&gt;</span></span><br></pre></td></tr></table></figure><p>  class: å®¢æˆ·ç«¯ç±»å‹ï¼šå¯é€‰å€¼ä¸ºnormalã€slaveå’Œpubsubã€‚<br>  hard limit: å¦‚æœå®¢æˆ·ç«¯ä½¿ç”¨çš„è¾“å‡ºç¼“å†²åŒºå¤§äºhard limitï¼Œå®¢æˆ·ç«¯ä¼šè¢«ç«‹å³å…³é—­ï¼Œå•ä½ä¸ºç§’ã€‚<br>  soft limitå’Œsoft seconds: å¦‚æœå®¢æˆ·ç«¯ä½¿ç”¨çš„è¾“å‡ºç¼“å†²åŒºè¶…è¿‡äº†soft limitå¹¶ä¸”æŒç»­äº†soft limitç§’ï¼Œå®¢æˆ·ç«¯ä¼šè¢«ç«‹å³å…³é—­ï¼Œå•ä½ä¸ºç§’ã€‚</p></li><li><p>é•¿æ—¶é—´é—²ç½®è¿æ¥ä¼šè¢«æœåŠ¡ç«¯ä¸»åŠ¨æ–­å¼€ï¼Œå¯ä»¥æŸ¥è¯¢timeouté…ç½®çš„è®¾ç½®ä»¥åŠè‡ªèº«è¿æ¥æ± é…ç½®ç¡®å®šæ˜¯å¦éœ€è¦åšç©ºé—²æ£€æµ‹ã€‚</p></li></ol><p>äºæ˜¯æˆ‘ä»¬ç«‹å³å¯¹é…ç½®è¿›è¡Œäº†æ£€æŸ¥ï¼Œå¹¶æœªå‘ç°æœ‰ç›¸å…³é—®é¢˜ï¼Œtimeouté»˜è®¤è®¾ç½®ä¸º0ï¼Œå®¢æˆ·ç«¯ç¼“å†²åŒºä¸´æ—¶ä¿®æ”¹ä¸ºä¸é™åˆ¶ä¹Ÿæœªè§ç”Ÿæ•ˆã€‚</p><p>è¿™ä¸‹çŠ¯æ„äº†ï¼Œç”±äºè¿™ä¸ªç¨‹åºå‡ ä¹æ²¡æœ‰æ—¥å¿—ï¼Œä»£ç ä¹Ÿä¸æ˜¯æˆ‘ä»¬ç¼–å†™ï¼Œè€Œæ˜¯ä¸€ä½å¤–åœ°çš„åŒäº‹æä¾›çš„ã€‚åªèƒ½ä¸€æ³¢äººç´§æ€¥åˆ†æä»£ç ï¼Œä¸€æ³¢äººç»§ç»­æŸ¥è¯¢é”™è¯¯æ—¥å¿—ï¼Œä»å¼‚å¸¸çš„å †æ ˆä¸­æˆ‘ä»¬å‘ç°å¼‚å¸¸æ˜¯ä»æ‰§è¡Œredisçš„ä¸€ä¸ªgetæ–¹æ³•æŠ›å‡ºçš„ï¼Œéš¾é“æ˜¯getæŸä¸ªkeyçš„æ—¶å€™å‡ºç°äº†å¼‚å¸¸ï¼Ÿç”±äºæ—¥å¿—ä¸­æ²¡æœ‰æ‰“å°å…·ä½“çš„keyä¿¡æ¯ï¼Œæ‰€ä»¥ä¹Ÿä¸æ¸…æ¥šå…·ä½“æƒ…å†µï¼Œéš¾é“æ˜¯æŸä¸ªkeyçš„ä½“ç§¯è¿‡å¤§ï¼Œå¯¼è‡´æŸ¥è¯¢çš„æ—¶å€™è¶…è¿‡äº†é™åˆ¶ï¼Ÿäºæ˜¯ç«‹å³ä½¿ç”¨bigkeysæŸ¥è¯¢äº†ä¸€ä¸‹Redisçš„å¤§ä½“ç§¯keyï¼Œç»“æœæœ€å¤§çš„ä¹Ÿåªæœ‰åå‡ kbï¼Œå¾ˆæ˜¾ç„¶è¿™ä¹Ÿä¸æ˜¯åŸå› ã€‚å¤§å®¶æ­£åœ¨ä¸€ç­¹è«å±•ï¼Œå‡†å¤‡æŠŠç¨‹åºåŠ ä¸Šè¯¦ç»†çš„æ—¥å¿—å†å…·ä½“åˆ†æï¼Œä½†æ˜¯ç”Ÿäº§ç¯å¢ƒåšç´§æ€¥å˜æ›´äº¤ä»˜ç‰©æ˜¯å¾ˆå›°éš¾çš„ï¼Œä¹‹å‰æˆ‘ä»¬å·²ç»åœ¨æ¨¡æ‹Ÿç¯å¢ƒåŒæ­¥ç”Ÿäº§æ•°æ®æµ‹äº†å¥½å‡ è½®ï¼Œéƒ½æœªå‘ç°é—®é¢˜ï¼Œä¸ºä½•ç”Ÿäº§å°±å‡ºç°é—®é¢˜äº†å‘¢ï¼Ÿ</p><p>ç»§ç»­çœ‹codis porxyçš„æ—¥å¿—ï¼Œå‘ç°äº†ä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹ï¼Œå®¢æˆ·ç«¯å»ºç«‹çš„è¿æ¥æ¯æ¬¡éƒ½æ˜¯ç»è¿‡60såè¢«æ–­å¼€ï¼Œæ˜¾ç¤ºEOFé”™è¯¯ï¼Œä»£è¡¨å®¢æˆ·ç«¯å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€ï¼Œäºæ˜¯æˆ‘ä»¬ç«‹å³æŸ¥æ‰¾ç›¸å…³é…ç½®ï¼Œæ˜¯å¦å­˜åœ¨60sçš„é…ç½®ï¼Œè¿™æ—¶å€™è¿ç»´åŒå­¦æåˆ°äº†ä¸€ä»¶äº‹ï¼Œcodis-porxyä½¿ç”¨äº†nginxåšè´Ÿè½½å‡è¡¡ä»£ç†ï¼Œnginxåº”è¯¥åšäº†è¶…æ—¶é…ç½®ï¼Œäºæ˜¯æˆ‘ä»¬ç¿»çœ‹äº†nginxé…ç½®ï¼Œæœç„¶å­˜åœ¨ä¸€ä¸ª60sçš„è¶…æ—¶é…ç½®ï¼Œè€Œè¿™æ—¶å€™æˆ‘ä»¬å†å»ç¿»çœ‹ä»£ç é€»è¾‘ï¼Œå‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œé¦–å…ˆç¨‹åºä½¿ç”¨jediså»ºç«‹ä¸€ä¸ªredisè¿æ¥ï¼Œç„¶åä»MySQLä»æŸ¥æ‰¾ä¸´æ—¶è¡¨æ‰€æœ‰æ•°æ®ï¼Œç„¶åä¿®æ”¹redisç¼“å­˜ã€‚è€Œæˆ‘ä»¬çš„ä¸´æ—¶è¡¨æ•°æ®è¿‡äºåºå¤§ï¼Œè€Œä¸”ç¼ºä¹ç´¢å¼•ï¼Œæ‰€ä»¥æŸ¥è¯¢è¿™ä¸€æ­¥èŠ±è´¹äº†å¾ˆé•¿æ—¶é—´ï¼Œå·²ç»è¶…è¿‡60sï¼Œç­‰æ•°æ®æŸ¥è¯¢å®Œæ¯•ï¼Œå†æ‰§è¡Œredisæ“ä½œï¼Œæ­¤æ—¶ä¸€ç›´ç©ºé—²çš„è¿æ¥å·²ç»è¢«nginxå½“ä½œè¶…æ—¶ç»™æ–­å¼€äº†ã€‚ä¸ºä½•ä¹‹å‰æ¨¡æ‹Ÿç¯å¢ƒå¹¶æœªå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Ÿåº”è¯¥æ˜¯æœ€è¿‘å¾…ä¿®çš„æ•°æ®åˆå¢åŠ äº†å¾ˆå¤šï¼Œåˆšå¥½è¶…è¿‡60sï¼Œå¯¼è‡´è¿™ä¸ªé—®é¢˜å¹¶æœªåœ¨æ¨¡æ‹Ÿé˜¶æ®µå‘ç°ã€‚</p><p>äºæ˜¯æˆ‘ä»¬åœ¨æ¨¡æ‹Ÿç¯å¢ƒå¤ç°è¯¥é—®é¢˜ï¼Œå¹¶ä¸´æ—¶æŠŠnginxé…ç½®ä¿®æ”¹ä¸º600sï¼Œäºæ˜¯ä¿®æ•°ç¨‹åºæ­£å¸¸æ‰§è¡Œï¼Œæ²¡æœ‰å¼‚å¸¸ï¼Œé—®é¢˜åˆ°æ­¤è§£å†³ï¼Œäºæ˜¯ç”Ÿäº§åŒæ­¥æ“ä½œï¼Œæœ€ç»ˆå®Œæˆäº†å‡çº§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™å‘¨æœ«ç‰ˆæœ¬å‡çº§é‡åˆ°ä¸€ä¸ªJediså¼‚å¸¸ï¼Œå…¶ä¸­ä¸€æ­¥æ˜¯ä»Mysqlä¸­çš„ä¸´æ—¶è¡¨æŸ¥æ‰¾æ•°æ®ç„¶åæ‹¼è£…keyä»Redisä¸­æŸ¥æ‰¾å¯¹åº”çš„ç¼“å­˜æ•°æ®å¹¶ä¿®æ”¹ã€‚ç„¶è€Œå‡çº§è¿‡ç¨‹ä¸­ä¿®æ•°ç¨‹åºå´æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸&lt;code&gt;Unexpected end of stream&lt;/code&gt;æ„å¤–åœæ­¢ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="Redis" scheme="https://www.elietio.xyz/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>Nintendo Switchæ›´æ¢å†…å­˜å¡</title>
    <link href="https://www.elietio.xyz/posts/9f2531c3.html"/>
    <id>https://www.elietio.xyz/posts/9f2531c3.html</id>
    <published>2019-04-30T14:39:27.000Z</published>
    <updated>2020-06-13T08:18:25.216Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>NSå…¥æ‰‹ä¸€å¹´å¤šäº†ï¼Œä¸€ç›´æ‹¿å¼ 32Gçš„microSDå¡å‡‘åˆç€ï¼Œå› ä¸ºå…¥æ‰‹æ¸¸æˆä¸å¤šï¼Œåˆéƒ½æ˜¯å®ä½“ç‰ˆï¼Œæ‰€ä»¥ä¸‹è½½å‡ ä¸ªDLCä¹Ÿå®Œå…¨å¤Ÿäº†ï¼Œä¸è¿‡è€ƒè™‘åˆ°å®ä½“ç‰ˆæ¢å¡è¿˜æ˜¯éº»çƒ¦ï¼Œè€Œä¸”ä»Šå¹´æ„Ÿå…´è¶£çš„æ¸¸æˆä¹Ÿä¸å°‘ï¼Œæœ‰äº›ä¸æ‰“ç®—ä¹°å®ä½“äº†ï¼Œæ‰€ä»¥ä¸€ç›´æƒ³æ‰¾ä¸ªæœºä¼šæ¢å¼ å¤§ä¸€ç‚¹çš„microSDå¡ï¼Œæ­£å¥½ç‹—ä¸œ200Gé—ªè¿ªå¡æ´»åŠ¨195ï¼Œä»·æ ¼è¿˜ç®—OKï¼Œäºæ˜¯å…¥æ‰‹æ¢ä¹‹ã€‚<br><a id="more"></a> </p><h4 id="å‡†å¤‡ï¼š"><a href="#å‡†å¤‡ï¼š" class="headerlink" title="å‡†å¤‡ï¼š"></a>å‡†å¤‡ï¼š</h4><ul><li>Nintendo Switch</li><li>é—ªè¿ªï¼ˆSanDiskï¼‰200GB TFï¼ˆMicroSDï¼‰å­˜å‚¨å¡ U1 C10 A1</li><li>é«˜é€Ÿè¯»å¡å™¨ä¸€æš</li><li>PC</li></ul><h4 id="æ¢å¡æµç¨‹ï¼š"><a href="#æ¢å¡æµç¨‹ï¼š" class="headerlink" title="æ¢å¡æµç¨‹ï¼š"></a>æ¢å¡æµç¨‹ï¼š</h4><p><span id="inline-toc">1.</span> å–å¡ï¼šNS å…³æœºï¼ˆPower Offï¼‰ï¼Œå–å‡ºåŸæ¥çš„ MicroSD å¡ï¼Œå¹¶æŠŠMicroSDå¡å†…å®¹å¤‡ä»½åˆ°PC<br><span id="inline-toc">2.</span> NSæ’å…¥æ–°å¡ï¼ˆå¯èƒ½éœ€è¦æ›´æ–°ç³»ç»Ÿï¼‰<br><span id="inline-toc">3.</span> æ ¼å¼åŒ–æ–°å¡ï¼ˆå»ºè®®ï¼‰ï¼šè®¾ç½® - ç³»ç»Ÿè®¾ç½® - æ ¼å¼åŒ–é€‰é¡¹ - æ ¼å¼åŒ– microSD å¡ï¼Œæ ¼å¼åŒ–æ–°å¡ã€‚<br><span id="inline-toc">4.</span> æ‹·è´æ¸¸æˆæ–‡ä»¶ï¼šå°†æ–°å¡é‡Œçš„ Nintendo æ–‡ä»¶å¤¹åˆ é™¤ï¼ŒåŒæ—¶å°†æ—§å¡å¤‡ä»½åˆ°PCé‡Œçš„ Nintendo æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ–°å¡é‡Œ<br><span id="inline-toc">5.</span> æ’å…¥æ–°å¡ï¼šåœ¨å…³æœºçš„çŠ¶æ€ä¸‹æ’å…¥æ–°å¡ï¼Œç„¶åå¼€æœºï¼Œæ£€æŸ¥ä¸‹è½½å†…å®¹æ˜¯å¦å­˜åœ¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;NSå…¥æ‰‹ä¸€å¹´å¤šäº†ï¼Œä¸€ç›´æ‹¿å¼ 32Gçš„microSDå¡å‡‘åˆç€ï¼Œå› ä¸ºå…¥æ‰‹æ¸¸æˆä¸å¤šï¼Œåˆéƒ½æ˜¯å®ä½“ç‰ˆï¼Œæ‰€ä»¥ä¸‹è½½å‡ ä¸ªDLCä¹Ÿå®Œå…¨å¤Ÿäº†ï¼Œä¸è¿‡è€ƒè™‘åˆ°å®ä½“ç‰ˆæ¢å¡è¿˜æ˜¯éº»çƒ¦ï¼Œè€Œä¸”ä»Šå¹´æ„Ÿå…´è¶£çš„æ¸¸æˆä¹Ÿä¸å°‘ï¼Œæœ‰äº›ä¸æ‰“ç®—ä¹°å®ä½“äº†ï¼Œæ‰€ä»¥ä¸€ç›´æƒ³æ‰¾ä¸ªæœºä¼šæ¢å¼ å¤§ä¸€ç‚¹çš„microSDå¡ï¼Œæ­£å¥½ç‹—ä¸œ200Gé—ªè¿ªå¡æ´»åŠ¨195ï¼Œä»·æ ¼è¿˜ç®—OKï¼Œäºæ˜¯å…¥æ‰‹æ¢ä¹‹ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="ç”µå­äº§å“" scheme="https://www.elietio.xyz/categories/%E7%94%B5%E5%AD%90%E4%BA%A7%E5%93%81/"/>
    
    
      <category term="ç”µå­äº§å“" scheme="https://www.elietio.xyz/tags/%E7%94%B5%E5%AD%90%E4%BA%A7%E5%93%81/"/>
    
      <category term="Nintendo Switch" scheme="https://www.elietio.xyz/tags/Nintendo-Switch/"/>
    
      <category term="NS" scheme="https://www.elietio.xyz/tags/NS/"/>
    
  </entry>
  
  <entry>
    <title>TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹</title>
    <link href="https://www.elietio.xyz/posts/b86735db.html"/>
    <id>https://www.elietio.xyz/posts/b86735db.html</id>
    <published>2019-04-29T14:14:49.000Z</published>
    <updated>2020-06-13T08:18:25.216Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><code>TCPï¼ˆTransmission Control Protocoï¼‰</code>ï¼Œæ˜¯ä¸€ç§åŸºäºå­—èŠ‚æµé¢å‘è¿æ¥çš„ä¼ è¾“å±‚åè®®ã€‚æ•°æ®çš„ä¼ è¾“éœ€è¦é€šä¿¡åŒæ–¹å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼ŒTCPåè®®é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œé‡‡ç”¨ 4 æ¬¡æŒ¥æ‰‹æ¥å…³é—­ä¸€ä¸ªè¿æ¥ã€‚æ¯ä¸€ä¸ªTCPè¿æ¥éƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼Œå«ä½œå¥—æ¥å­—ï¼ˆsocketï¼‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºIPåœ°å€+ç«¯å£å·æ‹¼æ¥ã€‚</p><a id="more"></a><h3 id="TCP-IPåè®®æ¦‚å†µ"><a href="#TCP-IPåè®®æ¦‚å†µ" class="headerlink" title="TCP/IPåè®®æ¦‚å†µ"></a>TCP/IPåè®®æ¦‚å†µ</h3><ul><li>IPv4: ç½‘é™…åè®®ç‰ˆæœ¬4(Internet Protocol version 4), ä½¿ç”¨32ä½åœ°å€</li><li>IPv6: ç½‘é™…åè®®ç‰ˆæœ¬6(Internet Protocol version 6), ä½¿ç”¨128ä½åœ°å€ï¼Œæ˜¯IPv4æ›¿ä»£å“ï¼Œé€šå¸¸æŠŠå®ƒä¸¤è€…ç§°ä¸ºâ€IPâ€œ</li><li>TCP: ä¼ è¾“æ§åˆ¶åè®®(Transmission Control Protocol),TCPæ˜¯ä¸€ä¸ª<strong>é¢å‘è¿æ¥</strong>çš„åè®®,ä¸ºç”¨æˆ·è¿›ç¨‹æä¾›<strong>å¯é </strong>çš„<strong>å…¨åŒå·¥å­—èŠ‚æµ</strong>ï¼Œ TCPå¥—æ¥å­—æ˜¯ä¸€ç§<strong>æµå¥—æ¥å­—(stream sockte)</strong>, å…³å¿ƒ<strong>ç¡®è®¤</strong>, <strong>è¶…æ—¶</strong>, <strong>é‡ä¼ </strong>ç­‰ç»†èŠ‚</li><li>UDP: ç”¨æˆ·æ•°æ®æŠ¥åè®®(User Datagram Protocol), UDPæ˜¯ä¸€ä¸ª<strong>æ— è¿æ¥</strong>åè®®,UDPå¥—æ¥å­—æ˜¯ä¸€ç§<strong>æ•°æ®æŠ¥å¥—æ¥å­—(datagram socket)</strong></li><li>SCTPï¼šæµæ§åˆ¶ä¼ è¾“åè®®(Stream Control Transmission Protocol),SCTPæ˜¯ä¸€ä¸ªæä¾›<strong>å¯é å…¨åŒå·¥å…³è”çš„é¢å‘è¿æ¥çš„åè®®</strong></li><li>ICMPï¼šç½‘é™…æ§åˆ¶æ¶ˆæ¯åè®®(Internet Control Message Protocol),å¤„ç†åœ¨è·¯ç”±å™¨å’Œä¸»æœºä¹‹é—´æµé€šçš„é”™è¯¯å’Œæ§åˆ¶æ¶ˆæ¯</li><li>ICMPv6ï¼šç½‘é™…æ§åˆ¶æ¶ˆæ¯åè®®ç‰ˆæœ¬6</li><li>IGMP: ç½‘é™…ç»„ç®¡ç†åè®®,ç”¨äºå¤šæ’­</li><li>ARP: åœ°å€è§£æåè®®(Address Resolution Protocol),æŠŠIPv4åœ°å€æ˜ å°„æˆä¸€ä¸ªç¡¬ä»¶åœ°å€(å¦‚ä»¥å¤ªç½‘åœ°å€)</li><li>RARP: ååœ°å€è§£æåè®®(Reverse..), å°†ç¡¬ä»¶åœ°å€æ˜ å°„æˆIPv4åœ°å€</li><li>BPF: BSDåˆ†ç»„è¿‡æ»¤å™¨</li></ul><h3 id="TCPé€šä¿¡ä¸‰éƒ¨æ›²"><a href="#TCPé€šä¿¡ä¸‰éƒ¨æ›²" class="headerlink" title="TCPé€šä¿¡ä¸‰éƒ¨æ›²"></a>TCPé€šä¿¡ä¸‰éƒ¨æ›²</h3><ul><li>å»ºç«‹ï¼šä¸‰æ¬¡æ¡æ‰‹</li><li>ä¼ è¾“ï¼šè¶…æ—¶é‡ä¼ ã€å¿«é€Ÿé‡ä¼ ã€æµé‡æ§åˆ¶ã€æ‹¥å¡æ§åˆ¶ç­‰</li><li>æ–­å¼€ï¼šå››æ¬¡æŒ¥æ‰‹</li></ul><h4 id="TCPæœåŠ¡æ¨¡å‹"><a href="#TCPæœåŠ¡æ¨¡å‹" class="headerlink" title="TCPæœåŠ¡æ¨¡å‹"></a>TCPæœåŠ¡æ¨¡å‹</h4><p>ä¸€ä¸ª TCP è¿æ¥ç”±ä¸€ä¸ª 4 å…ƒç»„æ„æˆï¼Œåˆ†åˆ«æ˜¯ä¸¤ä¸ª IP åœ°å€å’Œä¸¤ä¸ªç«¯å£å·ã€‚ä¸€ä¸ª TCP è¿æ¥é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šå¯åŠ¨ã€æ•°æ®ä¼ è¾“ã€å…³é—­ã€‚</p><p>å½“ TCP æ¥æ”¶åˆ°å¦ä¸€ç«¯çš„æ•°æ®æ—¶ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ªç¡®è®¤ï¼Œä½†è¿™ä¸ªç¡®è®¤ä¸ä¼šç«‹å³å‘é€ï¼Œä¸€èˆ¬ä¼šå»¶è¿Ÿä¸€ä¼šå„¿ã€‚ACK æ˜¯ç´¯ç§¯çš„ï¼Œä¸€ä¸ªç¡®è®¤å­—èŠ‚å· N çš„ ACK è¡¨ç¤ºæ‰€æœ‰ç›´åˆ° N çš„å­—èŠ‚ï¼ˆä¸åŒ…æ‹¬ Nï¼‰å·²ç»æˆåŠŸè¢«æ¥æ”¶äº†ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯å¦‚æœä¸€ä¸ª ACK ä¸¢å¤±ï¼Œå¾ˆå¯èƒ½åç»­çš„ ACK å°±è¶³ä»¥ç¡®è®¤å‰é¢çš„æŠ¥æ–‡æ®µäº†ã€‚</p><p>ä¸€ä¸ªå®Œæ•´çš„ TCP è¿æ¥æ˜¯åŒå‘å’Œå¯¹ç§°çš„ï¼Œæ•°æ®å¯ä»¥åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šå¹³ç­‰åœ°æµåŠ¨ã€‚ç»™ä¸Šå±‚åº”ç”¨ç¨‹åºæä¾›ä¸€ç§åŒå·¥æœåŠ¡ã€‚ä¸€æ—¦å»ºç«‹äº†ä¸€ä¸ªè¿æ¥ï¼Œè¿™ä¸ªè¿æ¥çš„ä¸€ä¸ªæ–¹å‘ä¸Šçš„æ¯ä¸ª TCP æŠ¥æ–‡æ®µéƒ½åŒ…å«äº†ç›¸åæ–¹å‘ä¸Šçš„æŠ¥æ–‡æ®µçš„ä¸€ä¸ª ACKã€‚</p><p>åºåˆ—å·çš„ä½œç”¨æ˜¯ä½¿å¾—ä¸€ä¸ª TCP æ¥æ”¶ç«¯å¯ä¸¢å¼ƒé‡å¤çš„æŠ¥æ–‡æ®µï¼Œè®°å½•ä»¥æ‚ä¹±æ¬¡åºåˆ°è¾¾çš„æŠ¥æ–‡æ®µã€‚å› ä¸º TCP ä½¿ç”¨ IP æ¥ä¼ è¾“æŠ¥æ–‡æ®µï¼Œè€Œ IP ä¸æä¾›é‡å¤æ¶ˆé™¤æˆ–è€…ä¿è¯æ¬¡åºæ­£ç¡®çš„åŠŸèƒ½ã€‚å¦ä¸€æ–¹é¢ï¼ŒTCP æ˜¯ä¸€ä¸ªå­—èŠ‚æµåè®®ï¼Œç»ä¸ä¼šä»¥æ‚ä¹±çš„æ¬¡åºç»™ä¸Šå±‚ç¨‹åºå‘é€æ•°æ®ã€‚å› æ­¤ TCP æ¥æ”¶ç«¯ä¼šè¢«è¿«å…ˆä¿æŒå¤§åºåˆ—å·çš„æ•°æ®ä¸äº¤ç»™åº”ç”¨ç¨‹åºï¼Œç›´åˆ°ç¼ºå¤±çš„å°åºåˆ—å·çš„æŠ¥æ–‡æ®µè¢«å¡«æ»¡ã€‚</p><h4 id="TCPæŠ¥æ–‡å¤´éƒ¨"><a href="#TCPæŠ¥æ–‡å¤´éƒ¨" class="headerlink" title="TCPæŠ¥æ–‡å¤´éƒ¨"></a>TCPæŠ¥æ–‡å¤´éƒ¨</h4><p><img src="/img/tcp-handshake-wave/TCP-Header.jpg" alt="TCP-Header"></p><ul><li>æºç«¯å£å’Œç›®çš„ç«¯å£ï¼Œå„å 2ä¸ªå­—èŠ‚ï¼›</li><li>åºå·ï¼Œå 4ä¸ªå­—èŠ‚ï¼ŒTCPè¿æ¥ä¸­ä¼ é€çš„å­—èŠ‚æµä¸­çš„æ¯ä¸ªå­—èŠ‚éƒ½æŒ‰é¡ºåºç¼–å·ï¼›</li><li>ç¡®è®¤å·ï¼Œå 4ä¸ªå­—èŠ‚ï¼Œæ˜¯æœŸæœ›æ”¶åˆ°å¯¹æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡çš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·ï¼Œå³æœ€åè¢«æˆåŠŸæ¥æ”¶çš„æ•°æ®å­—èŠ‚åºåˆ—å·åŠ  1ï¼Œè¿™ä¸ªå­—æ®µåªæœ‰åœ¨ ACK ä½è¢«å¯ç”¨çš„æ—¶å€™æ‰æœ‰æ•ˆï¼›</li><li>æ•°æ®åç§»ï¼Œå 4ä½ï¼Œå®ƒæŒ‡å‡ºTCPæŠ¥æ–‡çš„æ•°æ®è·ç¦»TCPæŠ¥æ–‡æ®µçš„èµ·å§‹å¤„æœ‰å¤šè¿œï¼›</li><li>ä¿ç•™ï¼Œå 6ä½ï¼Œä¿ç•™ä»Šåä½¿ç”¨ï¼Œä½†ç›®å‰åº”éƒ½ä½0ï¼›</li><li>ç´§æ€¥URGï¼Œå½“URG=1ï¼Œè¡¨æ˜ç´§æ€¥æŒ‡é’ˆå­—æ®µæœ‰æ•ˆã€‚å‘Šè¯‰ç³»ç»Ÿæ­¤æŠ¥æ–‡æ®µä¸­æœ‰ç´§æ€¥æ•°æ®ï¼›</li><li>ç¡®è®¤ACKï¼Œä»…å½“ACK=1æ—¶ï¼Œç¡®è®¤å·å­—æ®µæ‰æœ‰æ•ˆã€‚TCPè§„å®šï¼Œåœ¨è¿æ¥å»ºç«‹åæ‰€æœ‰æŠ¥æ–‡çš„ä¼ è¾“éƒ½å¿…é¡»æŠŠACKç½®1ï¼›</li><li>æ¨é€PSHï¼Œå½“ä¸¤ä¸ªåº”ç”¨è¿›ç¨‹è¿›è¡Œäº¤äº’å¼é€šä¿¡æ—¶ï¼Œæœ‰æ—¶åœ¨ä¸€ç«¯çš„åº”ç”¨è¿›ç¨‹å¸Œæœ›åœ¨é”®å…¥ä¸€ä¸ªå‘½ä»¤åç«‹å³å°±èƒ½æ”¶åˆ°å¯¹æ–¹çš„å“åº”ï¼Œè¿™æ—¶å€™å°±å°†PSH=1ï¼›</li><li>å¤ä½RSTï¼Œå½“RST=1ï¼Œè¡¨æ˜TCPè¿æ¥ä¸­å‡ºç°ä¸¥é‡å·®é”™ï¼Œå¿…é¡»é‡Šæ”¾è¿æ¥ï¼Œç„¶åå†é‡æ–°å»ºç«‹è¿æ¥ï¼›</li><li>åŒæ­¥SYNï¼Œåœ¨è¿æ¥å»ºç«‹æ—¶ç”¨æ¥åŒæ­¥åºå·ã€‚å½“SYN=1ï¼ŒACK=0ï¼Œè¡¨æ˜æ˜¯è¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼Œè‹¥åŒæ„è¿æ¥ï¼Œåˆ™å“åº”æŠ¥æ–‡ä¸­åº”è¯¥ä½¿SYN=1ï¼ŒACK=1ï¼›</li><li>ç»ˆæ­¢FINï¼Œç”¨æ¥é‡Šæ”¾è¿æ¥ã€‚å½“FIN=1ï¼Œè¡¨æ˜æ­¤æŠ¥æ–‡çš„å‘é€æ–¹çš„æ•°æ®å·²ç»å‘é€å®Œæ¯•ï¼Œå¹¶ä¸”è¦æ±‚é‡Šæ”¾ï¼›</li><li>çª—å£ï¼Œå 2å­—èŠ‚ï¼ŒæŒ‡çš„æ˜¯é€šçŸ¥æ¥æ”¶æ–¹ï¼Œå‘é€æœ¬æŠ¥æ–‡ä½ éœ€è¦æœ‰å¤šå¤§çš„ç©ºé—´æ¥æ¥å—ï¼›</li><li>æ£€éªŒå’Œï¼Œå 2å­—èŠ‚ï¼Œæ ¡éªŒé¦–éƒ¨å’Œæ•°æ®è¿™ä¸¤éƒ¨åˆ†ï¼›</li><li>ç´§æ€¥æŒ‡é’ˆï¼Œå 2å­—èŠ‚ï¼ŒæŒ‡å‡ºæœ¬æŠ¥æ–‡æ®µä¸­çš„ç´§æ€¥æ•°æ®çš„å­—èŠ‚æ•°ï¼›</li></ul><h4 id="TCPçŠ¶æ€è½¬æ¢"><a href="#TCPçŠ¶æ€è½¬æ¢" class="headerlink" title="TCPçŠ¶æ€è½¬æ¢"></a>TCPçŠ¶æ€è½¬æ¢</h4><table><thead><tr><th>çŠ¶ æ€</th><th style="text-align:left">æ è¿°</th></tr></thead><tbody><tr><td>CLOSED</td><td style="text-align:left">å…³é—­çŠ¶æ€ï¼Œæ²¡æœ‰è¿æ¥æ´»åŠ¨æˆ–æ­£åœ¨è¿›è¡Œ</td></tr><tr><td>LISTEN</td><td style="text-align:left">ç›‘å¬çŠ¶æ€ï¼ŒæœåŠ¡å™¨æ­£åœ¨ç­‰å¾…è¿æ¥è¿›å…¥</td></tr><tr><td>SYN_RCVD</td><td style="text-align:left">æ”¶åˆ°ä¸€ä¸ªè¿æ¥è¯·æ±‚ï¼Œå°šæœªç¡®è®¤</td></tr><tr><td>SYN_SENT</td><td style="text-align:left">å·²ç»å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œç­‰å¾…ç¡®è®¤</td></tr><tr><td>ESTABLISHED</td><td style="text-align:left">è¿æ¥å»ºç«‹ï¼Œæ­£å¸¸æ•°æ®ä¼ è¾“çŠ¶æ€</td></tr><tr><td>FIN_WAIT_1</td><td style="text-align:left">ï¼ˆä¸»åŠ¨å…³é—­ï¼‰å·²ç»å‘é€å…³é—­è¯·æ±‚ï¼Œç­‰å¾…ç¡®è®¤</td></tr><tr><td>FIN_WAIT_2</td><td style="text-align:left">ï¼ˆä¸»åŠ¨å…³é—­ï¼‰æ”¶åˆ°å¯¹æ–¹å…³é—­ç¡®è®¤ï¼Œç­‰å¾…å¯¹æ–¹å…³é—­è¯·æ±‚</td></tr><tr><td>TIMED_WAIT</td><td style="text-align:left">å®ŒæˆåŒå‘å…³é—­ï¼Œç­‰å¾…æ‰€æœ‰åˆ†ç»„æ­»æ‰</td></tr><tr><td>CLOSING</td><td style="text-align:left">åŒæ–¹åŒæ—¶å°è¯•å…³é—­ï¼Œç­‰å¾…å¯¹æ–¹ç¡®è®¤</td></tr><tr><td>CLOSE_WAIT</td><td style="text-align:left">ï¼ˆè¢«åŠ¨å…³é—­ï¼‰æ”¶åˆ°å¯¹æ–¹å…³é—­è¯·æ±‚ï¼Œå·²ç»ç¡®è®¤</td></tr><tr><td>LAST_ACK</td><td style="text-align:left">ï¼ˆè¢«åŠ¨å…³é—­ï¼‰ç­‰å¾…æœ€åä¸€ä¸ªå…³é—­ç¡®è®¤ï¼Œå¹¶ç­‰å¾…æ‰€æœ‰åˆ†ç»„æ­»æ‰</td></tr></tbody></table><p><img src="/img/tcp-handshake-wave/tcp-ip-handshark.png" alt="tcp-ip-handshark"></p><p>é‚£ä¹ˆçŠ¶æ€è½¬æ¢ä¸ºä»€ä¹ˆè¦ç»å†ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</p><h4 id="TCPä¸‰æ¬¡æ¡æ‰‹"><a href="#TCPä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="TCPä¸‰æ¬¡æ¡æ‰‹"></a>TCPä¸‰æ¬¡æ¡æ‰‹</h4><ol><li>æœåŠ¡å™¨è¿›ç¨‹å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—TCBï¼Œæ—¶åˆ»å‡†å¤‡æ¥å—å®¢æˆ·è¿›ç¨‹çš„è¿æ¥è¯·æ±‚ï¼Œæ­¤æ—¶æœåŠ¡å™¨å°±è¿›å…¥äº†LISTENï¼ˆç›‘å¬ï¼‰çŠ¶æ€ï¼›</li><li>å®¢æˆ·ç«¯å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—TCBï¼Œç„¶åå‘æœåŠ¡å™¨å‘å‡ºè¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼ŒSYN=1ï¼Œè¡¨ç¤ºè¯·æ±‚å»ºç«‹è¿æ¥ï¼ŒåŒæ—¶é€‰æ‹©ä¸€ä¸ªåˆå§‹åºåˆ—å· seq=x ï¼Œæ­¤æ—¶ï¼ŒTCPå®¢æˆ·ç«¯è¿›ç¨‹è¿›å…¥äº† SYN_SENTï¼ˆåŒæ­¥å·²å‘é€çŠ¶æ€ï¼‰çŠ¶æ€ã€‚TCPè§„å®šï¼ŒSYNæŠ¥æ–‡æ®µï¼ˆSYN=1çš„æŠ¥æ–‡æ®µï¼‰ä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†éœ€è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚</li><li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡åï¼Œå¦‚æœåŒæ„è¿æ¥ï¼Œåˆ™å‘å‡ºç¡®è®¤æŠ¥æ–‡ã€‚ç¡®è®¤æŠ¥æ–‡ä¸­åº”è¯¥ ACK=1ï¼ŒSYN=1ï¼Œç¡®è®¤å·æ˜¯ack=x+1ï¼ŒåŒæ—¶ä¹Ÿè¦ä¸ºè‡ªå·±åˆå§‹åŒ–ä¸€ä¸ªåºåˆ—å· seq=yï¼Œæ­¤æ—¶ï¼ŒTCPæœåŠ¡å™¨è¿›ç¨‹è¿›å…¥äº†SYN_RCVDï¼ˆåŒæ­¥æ”¶åˆ°ï¼‰çŠ¶æ€ã€‚è¿™ä¸ªæŠ¥æ–‡ä¹Ÿä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†æ˜¯åŒæ ·è¦æ¶ˆè€—ä¸€ä¸ªåºå·ã€‚</li><li>Tå®¢æˆ·ç«¯æ”¶åˆ°ç¡®è®¤åï¼Œè¿˜è¦å‘æœåŠ¡å™¨ç»™å‡ºç¡®è®¤ã€‚ç¡®è®¤æŠ¥æ–‡çš„ACK=1ï¼Œack=y+1ï¼Œè‡ªå·±çš„åºåˆ—å·seq=x+1ï¼Œæ­¤æ—¶ï¼ŒTCPè¿æ¥å»ºç«‹ï¼Œå®¢æˆ·ç«¯è¿›å…¥ESTABLISHEDï¼ˆå·²å»ºç«‹è¿æ¥ï¼‰çŠ¶æ€ã€‚TCPè§„å®šï¼ŒACKæŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ï¼Œä½†æ˜¯å¦‚æœä¸æºå¸¦æ•°æ®åˆ™ä¸æ¶ˆè€—åºå·ã€‚</li><li>å½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ç¡®è®¤åä¹Ÿè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œä¸‰æ¬¡æ¡æ‰‹ç»“æŸï¼Œè¿æ¥å»ºç«‹ã€‚</li></ol><p><img src="/img/tcp-handshake-wave/tcp-three-handshake.gif" alt="tcp-three-handshake"></p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ç¬¬ä¸‰æ¬¡å®¢æˆ·ç«¯ACKï¼Ÿ</strong></p><div class="note info no-icon">            <p><code>ä¸‰æ¬¡æ¡æ‰‹</code>çš„ç›®çš„æ˜¯â€œ<strong>ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯</strong>ã€‚</p><p>ä¾‹å¦‚ç½‘ç»œå‡ºç°æŠ–åŠ¨å¯¼è‡´ç¬¬ä¸€æ¬¡SYN=1å¹¶æ²¡æœ‰åŠæ—¶åˆ°è¾¾æœåŠ¡ç«¯ï¼Œä»è€Œå®¢æˆ·ç«¯æ— æ³•æ”¶åˆ°æœåŠ¡ç«¯çš„ACKï¼Œä¼šè§¦å‘å®¢æˆ·ç«¯çš„é‡è¯•ã€‚å¦‚æœåªæœ‰ä¸¤æ¬¡æ¡æ‰‹ï¼Œç¬¬äºŒæ¬¡é‡å‘å»ºç«‹è¿æ¥åï¼Œç¬¬ä¸€æ¬¡å»¶è¿Ÿçš„è¯·æ±‚åˆšå¥½åˆ°è¾¾æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¼šå†æ¬¡å›åŒ…ACKï¼Œè¿™æ ·æœ¬æ¥æ— æ•ˆçš„è¯·æ±‚åˆä¼šå»ºç«‹æ–°çš„è¿æ¥ã€‚å¦‚æœæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯ACKå¹¶ä¸ä¼šå†æ¬¡å‘å‡ºç¡®è®¤ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰æ–°çš„è¿æ¥å»ºç«‹ã€‚</p>          </div><h4 id="TCPå››æ¬¡æŒ¥æ‰‹"><a href="#TCPå››æ¬¡æŒ¥æ‰‹" class="headerlink" title="TCPå››æ¬¡æŒ¥æ‰‹"></a>TCPå››æ¬¡æŒ¥æ‰‹</h4><p>ä»¥å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­ä¸ºä¾‹ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å…³é—­ï¼Œæ–¹å‘ä¸ä¸‹é¢ç›¸åã€‚</p><p><img src="/img/tcp-handshake-wave/tcp-four-wave.gif" alt="tcp-four-wave"></p><ol><li>å®¢æˆ·ç«¯è¿›ç¨‹å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼Œå¹¶ä¸”åœæ­¢å‘é€æ•°æ®ã€‚é‡Šæ”¾æ•°æ®æŠ¥æ–‡é¦–éƒ¨ï¼ŒFIN=1ï¼Œå…¶åºåˆ—å·ä¸ºseq=uï¼ˆç­‰äºå‰é¢å·²ç»ä¼ é€è¿‡æ¥çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1ï¼‰ï¼Œæ­¤æ—¶ï¼Œå®¢æˆ·ç«¯è¿›å…¥FIN_WAIT_1ï¼ˆç»ˆæ­¢ç­‰å¾…1ï¼‰çŠ¶æ€ã€‚ TCPè§„å®šï¼ŒFINæŠ¥æ–‡æ®µå³ä½¿ä¸æºå¸¦æ•°æ®ï¼Œä¹Ÿè¦æ¶ˆè€—ä¸€ä¸ªåºå·ã€‚</li><li>æœåŠ¡å™¨æ”¶åˆ°è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼Œå‘å‡ºç¡®è®¤æŠ¥æ–‡ï¼ŒACK=1ï¼Œack=u+1ï¼Œå¹¶ä¸”å¸¦ä¸Šè‡ªå·±çš„åºåˆ—å·seq=vï¼Œæ­¤æ—¶ï¼ŒæœåŠ¡ç«¯å°±è¿›å…¥äº†CLOSE_WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰çŠ¶æ€ã€‚TCPæœåŠ¡å™¨é€šçŸ¥é«˜å±‚çš„åº”ç”¨è¿›ç¨‹ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨çš„æ–¹å‘å°±é‡Šæ”¾äº†ï¼Œè¿™æ—¶å€™å¤„äºåŠå…³é—­çŠ¶æ€ï¼Œå³å®¢æˆ·ç«¯å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä½†æ˜¯æœåŠ¡å™¨è‹¥å‘é€æ•°æ®ï¼Œå®¢æˆ·ç«¯ä¾ç„¶è¦æ¥å—ã€‚è¿™ä¸ªçŠ¶æ€è¿˜è¦æŒç»­ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªCLOSE_WAITçŠ¶æ€æŒç»­çš„æ—¶é—´ã€‚</li><li>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„ç¡®è®¤è¯·æ±‚åï¼Œæ­¤æ—¶ï¼Œå®¢æˆ·ç«¯å°±è¿›å…¥FIN_WAIT_2ï¼ˆç»ˆæ­¢ç­‰å¾…2ï¼‰çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼ˆåœ¨è¿™ä¹‹å‰è¿˜éœ€è¦æ¥å—æœåŠ¡å™¨å‘é€çš„æœ€åçš„æ•°æ®ï¼‰ã€‚</li><li>æœåŠ¡å™¨å°†æœ€åçš„æ•°æ®å‘é€å®Œæ¯•åï¼Œå°±å‘å®¢æˆ·ç«¯å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼ŒFIN=1ï¼Œack=u+1ï¼Œç”±äºåœ¨åŠå…³é—­çŠ¶æ€ï¼ŒæœåŠ¡å™¨å¾ˆå¯èƒ½åˆå‘é€äº†ä¸€äº›æ•°æ®ï¼Œå‡å®šæ­¤æ—¶çš„åºåˆ—å·ä¸ºseq=wï¼Œæ­¤æ—¶ï¼ŒæœåŠ¡å™¨å°±è¿›å…¥äº†LAST_ACKï¼ˆæœ€åç¡®è®¤ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„ç¡®è®¤ã€‚</li><li>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡åï¼Œå¿…é¡»å‘å‡ºç¡®è®¤ï¼ŒACK=1ï¼Œack=w+1ï¼Œè€Œè‡ªå·±çš„åºåˆ—å·æ˜¯seq=u+1ï¼Œæ­¤æ—¶ï¼Œå®¢æˆ·ç«¯å°±è¿›å…¥äº†TIME_WAITï¼ˆæ—¶é—´ç­‰å¾…ï¼‰çŠ¶æ€ã€‚æ³¨æ„æ­¤æ—¶TCPè¿æ¥è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå¿…é¡»ç»è¿‡2*MSLï¼ˆæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ï¼‰çš„æ—¶é—´åï¼Œå½“å®¢æˆ·ç«¯æ’¤é”€ç›¸åº”çš„TCBåï¼Œæ‰è¿›å…¥CLOSEDçŠ¶æ€ã€‚</li><li>æœåŠ¡å™¨åªè¦æ”¶åˆ°äº†å®¢æˆ·ç«¯å‘å‡ºçš„ç¡®è®¤ï¼Œç«‹å³è¿›å…¥CLOSEDçŠ¶æ€ï¼Œæ’¤é”€TCBç»“æŸTCPè¿æ¥ã€‚</li></ol><p><strong>ä¸ºä»€ä¹ˆä¸»åŠ¨å…³é—­è¿æ¥æ–¹æœ€åéœ€è¦ç­‰å¾…2MSLï¼Ÿ</strong></p><div class="note info no-icon">            <p> MSLï¼ˆMaximum Segment Lifetimeï¼‰ï¼ŒæŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´ã€‚</p><ol><li>ä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡å™¨ï¼Œå¦‚æœå› ä¸ºç½‘ç»œåŸå› å¯¼è‡´æœåŠ¡å™¨æ²¡æ”¶åˆ°ï¼ŒæœåŠ¡å™¨ä¼šé‡æ–°å‘é€ä¸€æ¬¡FIN+ackè¯·æ±‚å…³é—­è¿æ¥ï¼Œå®¢æˆ·ç«¯å°±èƒ½æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„æŠ¥æ–‡å†æ¬¡ACKï¼Œå¹¶ä¸”é‡å¯2MSLè®¡æ—¶å™¨ã€‚</li><li>é˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯â€ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª2MSLæ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ï¼Œæ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨TIME_WAITçŠ¶æ€ æ—¶ä¸¤ç«¯çš„ç«¯å£ä¸èƒ½ä½¿ç”¨ï¼Œå®¢æˆ·ç«¯è¦ç­‰åˆ°2MSLæ—¶é—´ç»“æŸæ‰å¯ç»§ç»­ä½¿ç”¨ã€‚</li></ol>          </div><p><strong>ä¸ºä»€ä¹ˆå…³é—­è¿æ¥éœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Œæ¯”å»ºç«‹è¿æ¥å¤šä¸€æ¬¡å‘¢ï¼Ÿ</strong></p><div class="note info no-icon">            <p>å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œ æœåŠ¡å™¨åœ¨LISTENçŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„SYNæŠ¥æ–‡åï¼ŒæŠŠACKå’ŒSYNæ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚<br>è€Œå…³é—­è¿æ¥æ—¶ï¼ŒACKå’ŒSYNæ˜¯åˆ†å¼€å‘é€çš„ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯¹æ–¹çš„FINæŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚å…³é—­ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œè€Œä¸”æœåŠ¡å™¨çš„æ•°æ®å¯èƒ½ä¹Ÿæ²¡æœ‰å‘é€å®Œæ¯•ï¼Œæ‰€ä»¥æœåŠ¡å™¨å¯ä»¥é€‰æ‹©ç«‹å³å…³é—­FINä¹Ÿå¯ä»¥å†å‘é€ä¸€éƒ¨åˆ†æ•°æ®ç„¶åå†å‘é€FINæŠ¥æ–‡ç»™å®¢æˆ·ç«¯å…³é—­è¿æ¥ï¼Œç”±äºæœåŠ¡å™¨ACKå’ŒFINåˆ†å¼€å‘é€ï¼Œæ‰€ä»¥å¤šäº†ä¸€æ¬¡ã€‚</p>          </div><p><strong>å¦‚æœé€šä¿¡åŒæ–¹åŒæ—¶è¯·æ±‚è¿æ¥æˆ–åŒæ—¶è¯·æ±‚é‡Šæ”¾è¿æ¥ï¼Ÿ</strong></p><div class="note info no-icon">            <p>è¿™ç§æƒ…å†µè™½ç„¶å‘ç”Ÿçš„å¯èƒ½æ€§æå°ï¼Œä½†æ˜¯æ˜¯ç¡®å®å­˜åœ¨çš„ï¼ŒTCPä¹Ÿç‰¹æ„è®¾è®¡äº†ç›¸å…³æœºåˆ¶ï¼Œä½¿å¾—åœ¨è¿™ç§æƒ…å†µä¸‹åŒæ–¹ä»…å»ºç«‹ä¸€æ¡è¿æ¥ã€‚</p><ul><li>åŒæ–¹åŒæ—¶è¯·æ±‚è¿æ¥çš„æƒ…å†µä¸‹ï¼ŒåŒæ–¹åŒæ—¶å‘å‡ºè¯·æ±‚è¿æ¥æŠ¥æ–‡ï¼Œå¹¶è¿›å…¥SYN_SENTçŠ¶æ€ï¼›å½“æ”¶åˆ°å¯¹æ–¹çš„è¯·æ±‚è¿æ¥æŠ¥æ–‡åï¼Œä¼šå†æ¬¡å‘é€è¯·æ±‚è¿æ¥æŠ¥æ–‡ï¼Œç¡®è®¤å·ä¸ºå¯¹æ–¹çš„SYN+1ï¼Œå¹¶è¿›å…¥SYN_RCVDçŠ¶æ€ï¼›å½“æ”¶åˆ°å¯¹æ–¹ç¬¬äºŒæ¬¡å‘å‡ºçš„æºå¸¦ç¡®è®¤å·çš„è¯·æ±‚æŠ¥æ–‡ä¹‹åï¼Œä¼šè¿›å…¥ESTABLISHEDçŠ¶æ€ã€‚ </li><li>åŒæ–¹åŒæ—¶è¯·æ±‚é‡Šæ”¾è¿æ¥ä¹Ÿæ˜¯åŒæ ·çš„ï¼ŒåŒæ–¹åŒæ—¶å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼Œå¹¶è¿›å…¥FIN_WAIT_1çŠ¶æ€ï¼›åœ¨æ”¶åˆ°å¯¹æ–¹çš„æŠ¥æ–‡ä¹‹åï¼Œå‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œå¹¶è¿›å…¥CLOSINGçŠ¶æ€ï¼›åœ¨æ”¶åˆ°å¯¹æ–¹çš„ç¡®è®¤æŠ¥æ–‡åï¼Œè¿›å…¥TIME_WAITçŠ¶æ€ï¼Œç­‰å¾…2MSLä¹‹åå…³é—­è¿æ¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™è™½ç„¶ä¸ç”¨å†æ¬¡å‘é€ç¡®è®¤æŠ¥æ–‡å¹¶ç¡®è®¤å¯¹æ–¹æ”¶åˆ°ï¼ŒåŒæ–¹ä»éœ€ç­‰å¾…2MSLä¹‹åå†å…³é—­è¿æ¥ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€çš„å½±å“ã€‚</li></ul>          </div><p><strong>TIME_WAITçŠ¶æ€</strong><br><div class="note warning no-icon">            <p>é¦–å…ˆTIME_WAITçŠ¶æ€æ˜¯æ‰§è¡Œä¸»åŠ¨å…³é—­çš„é‚£ä¸€ç«¯äº§ç”Ÿçš„ï¼Œä»ä¸Šé¢2MSLä¸­æˆ‘ä»¬äº†è§£TIME_WAITçŠ¶æ€æœ‰ä¸¤ä¸ªå­˜åœ¨çš„ç†ç”±:</p><ol><li>å¯é åœ°å®ç°TCPå…¨åŒå·¥è¿æ¥çš„ç»ˆæ­¢ï¼Œå³æœ€åä¸€æ¬¡ACKå¦‚æœä¸¢å¤±ï¼Œå¯ä»¥é‡æ–°å‘é€FINå¹¶å†æ¬¡ACKï¼›</li><li>å…è®¸è€çš„é‡å¤åˆ†èŠ‚åœ¨ç½‘ç»œä¸­æ¶ˆé€ï¼Œæ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ï¼›</li></ol><p>åœ¨é«˜å¹¶å‘çŸ­è¿æ¥çš„TCPæœåŠ¡å™¨ä¸Šï¼Œå½“æœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚åç«‹åˆ»æŒ‰ç…§ä¸»åŠ¨æ­£å¸¸å…³é—­è¿æ¥ã€‚è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œä¼šå‡ºç°å¤§é‡socketå¤„äºTIME_WAITçŠ¶æ€ã€‚å¦‚æœå®¢æˆ·ç«¯çš„å¹¶å‘é‡æŒç»­å¾ˆé«˜ï¼Œå¤§é‡ç«¯å£å¤„äºTIME_WAITçŠ¶æ€ï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæ­¤æ—¶éƒ¨åˆ†å®¢æˆ·ç«¯å°±ä¼šæ˜¾ç¤ºè¿æ¥ä¸ä¸Šï¼Œæ‰€ä»¥éœ€è¦å¼•èµ·é‡è§†ã€‚</p>          </div></p><blockquote class="question"><br>å‚è€ƒğŸ“šï¼š<br><i class="fa fa-hand-o-right" aria-hidden="true"></i><a href="https://blog.csdn.net/qzcsu/article/details/72861891" target="_blank" rel="noopener">TCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹</a><br></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;TCPï¼ˆTransmission Control Protocoï¼‰&lt;/code&gt;ï¼Œæ˜¯ä¸€ç§åŸºäºå­—èŠ‚æµé¢å‘è¿æ¥çš„ä¼ è¾“å±‚åè®®ã€‚æ•°æ®çš„ä¼ è¾“éœ€è¦é€šä¿¡åŒæ–¹å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼ŒTCPåè®®é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œé‡‡ç”¨ 4 æ¬¡æŒ¥æ‰‹æ¥å…³é—­ä¸€ä¸ªè¿æ¥ã€‚æ¯ä¸€ä¸ªTCPè¿æ¥éƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼Œå«ä½œå¥—æ¥å­—ï¼ˆsocketï¼‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºIPåœ°å€+ç«¯å£å·æ‹¼æ¥ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="https://www.elietio.xyz/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="TCP" scheme="https://www.elietio.xyz/tags/TCP/"/>
    
      <category term="ç½‘ç»œ" scheme="https://www.elietio.xyz/tags/%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>hexoå’Œä¸»é¢˜å¤šè®¾å¤‡åŒæ­¥</title>
    <link href="https://www.elietio.xyz/posts/d00638d8.html"/>
    <id>https://www.elietio.xyz/posts/d00638d8.html</id>
    <published>2019-04-12T11:39:27.000Z</published>
    <updated>2020-06-13T08:18:25.216Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>ä½¿ç”¨hexoå¯ä»¥ç”Ÿæˆé™æ€ç½‘é¡µéƒ¨ç½²åˆ°GitHubå’ŒVPSä¸Šæ­å»ºä¸ªäººåšå®¢ï¼Œä½†æ˜¯hexoçš„éƒ¨ç½²éƒ½æ˜¯åœ¨æœ¬åœ°ï¼Œå¦‚æœæ¢äº†ä¸€å¥—ç¯å¢ƒå¦‚ä½•ä¹Ÿèƒ½å¤Ÿç¼–è¾‘å‘å¸ƒè‡ªå·±çš„åšå®¢ç½‘ç«™å‘¢ï¼Ÿ<br><a id="more"></a> </p><h2 id="åŒæ­¥æ–¹æ¡ˆ"><a href="#åŒæ­¥æ–¹æ¡ˆ" class="headerlink" title="åŒæ­¥æ–¹æ¡ˆ"></a>åŒæ­¥æ–¹æ¡ˆ</h2><p>ç”±äºéƒ¨ç½²åšå®¢å·²ç»ä½¿ç”¨äº†githubä»“åº“æ‰˜ç®¡ç½‘é¡µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ä¸ªæ¥åšhexoéƒ¨ç½²å‘å¸ƒç®¡ç†çš„ç‰ˆæœ¬æ§åˆ¶ï¼Œç”±äºéƒ¨ç½²çš„ç½‘ç«™é»˜è®¤ä½¿ç”¨äº†masteråˆ†æ”¯ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ–°çš„åˆ†æ”¯hexoæˆ–è€…æ–°å»ºä¸€ä¸ªä»“åº“æ¥ç®¡ç†ã€‚</p><p>ä¸‹é¢æ­¥éª¤é»˜è®¤å·²ç»å®‰è£…å¥½äº†hexoå¹¶ä¸”å·²ç»æˆåŠŸéƒ¨ç½²ç½‘ç«™ï¼Œé¦–å…ˆåˆ‡æ¢åˆ°hexoä¸»ç›®å½•ï¼Œgit initè¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœå·²ç»çº³å…¥gitç®¡ç†å¹¶ä¸”å…³è”äº†è¿œç¨‹ä»“åº“ï¼Œå¯èƒ½éœ€è¦åˆ é™¤é‡æ–°å…³è”ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> git åˆå§‹åŒ–</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git init</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å…³è”çš„è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote rm origin</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®æ–°çš„è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote add origin git@github.com:Elietio/Elietio.github.io.git</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> masteråˆ†æ”¯ä¼šä½œä¸ºç½‘ç«™éƒ¨ç½²åˆ†æ”¯ï¼Œå› æ­¤æˆ‘ä»¬åˆ‡æ¢ä¸€ä¸ªæ–°çš„åˆ†æ”¯hexo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout -b hexo</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¨é€è¿œç¨‹</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add .</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">""</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push -u origin hexo</span></span><br></pre></td></tr></table></figure><p>åˆ°è¿™ä¸€æ­¥ä¼¼ä¹å·²ç»å¤§åŠŸå‘Šæˆäº†ï¼Œç„¶è€Œï¼Œå¦‚æœä½ ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¹¶ä¸”æ˜¯ç›´æ¥git cloneï¼Œä½ ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œä¸Šä¼ çš„themes/ä¸‹é¢ä¸»é¢˜æ˜¯ç©ºç›®å½•ï¼Œå› ä¸ºgitæ— æ³•ç›´æ¥ç®¡ç†è¿™æ ·çš„åµŒå¥—æ¨¡å—ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæœ€æš´åŠ›ï¼Œç›´æ¥å–æ¶ˆä¸»é¢˜æ¨¡å—çš„gitç®¡ç†ï¼Œä½†æ˜¯è¿™æ ·åç»­ä¸»é¢˜æ¨¡å—çš„æ›´æ–°å°±æ˜¯ä¸€ä¸ªé—®é¢˜äº†ï¼Œæ‰€ä»¥ä¸æ¨èï¼Œå¥½åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡gitçš„submoduleæˆ–subtreeæ¥å®ç°ï¼Œå¯¹äºgit cloneå®‰è£…çš„å…¶å®ƒä¸»é¢˜å’Œæ’ä»¶éƒ½å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ€è·¯ã€‚</p><h2 id="git-submodule-vs-git-subtree"><a href="#git-submodule-vs-git-subtree" class="headerlink" title="git submodule vs git subtree"></a>git submodule vs git subtree</h2><p>ç®€å•æ¥è¯´ï¼Œsubmodule å’Œ subtree æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼Œsubmodule ä¿å­˜çš„æ˜¯å­ä»“åº“çš„ linkï¼Œè€Œ subtree ä¿å­˜çš„æ˜¯å­ä»“åº“çš„ copyã€‚</p><h3 id="git-submodule"><a href="#git-submodule" class="headerlink" title="git submodule"></a>git submodule</h3><p>child ç›®å½•è¢«å½“åšä¸€ä¸ªç‹¬ç«‹çš„ Git ä»“åº“ï¼Œæ‰€æœ‰çš„ Git å‘½ä»¤éƒ½å¯ä»¥åœ¨ child ç›®å½•ä»¥åŠä¸Šå±‚é¡¹ç›®ä¸‹ç‹¬ç«‹å·¥ä½œã€‚å°½ç®¡ child æ˜¯å­ç›®å½•ï¼Œå½“ä½ ä¸åœ¨ child ç›®å½•æ—¶å¹¶ä¸è®°å½•å®ƒçš„å†…å®¹ã€‚è€Œå½“ä½ åœ¨é‚£ä¸ªå­ç›®å½•é‡Œä¿®æ”¹å¹¶æäº¤æ—¶ï¼Œå­é¡¹ç›®ä¼šé€šçŸ¥é‚£é‡Œçš„ HEAD å·²ç»å‘ç”Ÿå˜æ›´å¹¶è®°å½•ä½ å½“å‰æ­£åœ¨å·¥ä½œçš„é‚£ä¸ªæäº¤ã€‚è€Œæ­¤æ—¶ä¸Šå±‚é¡¹ç›®ä¼šæ˜¾ç¤º child ç›®å½•ä¸‹çš„æ”¹åŠ¨ï¼Œå°†å®ƒè®°å½•æˆæ¥è‡ªé‚£ä¸ªä»“åº“çš„ä¸€ä¸ªç‰¹æ®Šçš„æäº¤ã€‚</p><p>è‹¥ä»–äººè¦å…‹éš†è¯¥é¡¹ç›®ï¼Œä¼šå‘ç° child ç›®å½•ä¸ºç©ºã€‚è¿™æ—¶éœ€è¦æ‰§è¡Œ git submodule init æ¥åˆå§‹åŒ–ä½ çš„æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œä»¥åŠ git submodule update æ‹‰å–æ•°æ®å¹¶åˆ‡æ¢åˆ°åˆé€‚çš„æäº¤ã€‚è€Œåæ¯æ¬¡ä»ä¸»é¡¹ç›®æ‹‰å–å­æ¨¡å—çš„å˜æ›´æ—¶ï¼Œç”±äºä¸»é¡¹ç›®åªæ›´æ–°äº†å­æ¨¡å—æäº¤çš„å¼•ç”¨è€Œæ²¡æœ‰æ›´æ–°å­æ¨¡å—ç›®å½•ä¸‹çš„ä»£ç ï¼Œå¿…é¡»æ‰§è¡Œ git submodule update æ¥æ›´æ–°å­æ¨¡å—ä»£ç ã€‚</p><h3 id="git-subtree"><a href="#git-subtree" class="headerlink" title="git subtree"></a>git subtree</h3><p>ä¸åŒäº git submoduleï¼Œæ­¤æ—¶çš„ child ä»…ä»…æ˜¯å«æœ‰ç›¸å…³ä»£ç çš„æ™®é€šç›®å½•ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ Git ä»“åº“ã€‚å› æ­¤å½“åœ¨ child è¿›è¡Œä¿®æ”¹æ—¶ï¼Œä¸Šå±‚é¡¹ç›®ä¼šç«‹åˆ»è®°å½•å…¶æ”¹åŠ¨ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰é‚£æ ·å…ˆåœ¨å­é¡¹ç›®ä¸­æäº¤æ‰èƒ½è¿›è¡Œè®°å½•ã€‚å…‹éš†ä¸Šå±‚ä»“åº“æ—¶ child ç›®å½•ä¹Ÿä¸å†ä¸ºç©ºã€‚ä½†åŒæ—¶ï¼Œchild ä¹Ÿä¸èƒ½å†æ‰§è¡Œç‹¬ç«‹çš„ Git å‘½ä»¤ï¼Œåªæœ‰ git subtree ç›¸å…³çš„æ“ä½œã€‚</p><p>è¿›è¡Œæ“ä½œå‰è¯·å…ˆå¤‡ä»½å·²æœ‰çš„nextä¸»é¢˜ç›®å½•ï¼Œæ ¹æ®ä¸åŒæƒ…å†µæ“ä½œä¸­å¯èƒ½éœ€è¦åˆ é™¤å¹¶ä¸”é‡æ–°cloneä¸‹æ¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆåœ¨è‡ªå·±çš„githubä¸Šforkä¸€ä»½nextæºç </span><br><span class="line">git@github.com:Elietio/hexo-theme-next.git     </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸ºhexoæ·»åŠ è¿œç¨‹ä»“åº“ </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> git remote add -f &lt;å­ä»“åº“å&gt; &lt;å­ä»“åº“åœ°å€&gt;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote add -f next git@github.com:Elietio/hexo-theme-next.git</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ subtree</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> git subtree add --prefix=&lt;å­ç›®å½•å&gt; &lt;å­ä»“åº“å&gt; &lt;åˆ†æ”¯&gt; squashæ„æ€æ˜¯æŠŠsubtreeçš„æ”¹åŠ¨åˆå¹¶æˆä¸€æ¬¡commit</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git subtree add --prefix=themes/next next master --squash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ›´æ–°å­é¡¹ç›®</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git fetch next master</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git subtree pull --prefix=themes/next next master --squash</span></span><br><span class="line">æ•´ä¸ªé¡¹ç›®çš„pullã€pushåŒæ ·ä¼šå¯¹å­é¡¹ç›®èµ·ä½œç”¨</span><br><span class="line"></span><br><span class="line">è€Œå¯¹nextå­é¡¹ç›®è¿›è¡Œpullã€pushæ“ä½œéœ€è¦ä½¿ç”¨subtree</span><br><span class="line"><span class="meta">#</span><span class="bash"> git subtree push --prefix=&lt;å­ç›®å½•å&gt; &lt;è¿œç¨‹åˆ†æ”¯å&gt; åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git subtree push --prefix=themes/next next master  </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> git subtree pull --prefix=&lt;å­ç›®å½•å&gt; &lt;è¿œç¨‹åˆ†æ”¯å&gt; åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git subtree pull --prefix=themes/yilia yilia master --squash</span></span><br></pre></td></tr></table></figure><h2 id="å…¶å®ƒè®¾å¤‡åŒæ­¥"><a href="#å…¶å®ƒè®¾å¤‡åŒæ­¥" class="headerlink" title="å…¶å®ƒè®¾å¤‡åŒæ­¥"></a>å…¶å®ƒè®¾å¤‡åŒæ­¥</h2><p>ä¸Šé¢æ“ä½œå·²ç»æŠŠhexoçš„æºç›®å½•åŒæ­¥åˆ°Gitï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦cloneï¼Œå¹¶ä¸”å®‰è£…node.jså’Œhexoç¯å¢ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> -b hexo git@github.com:Elietio/Elietio.github.io.git</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£… hexo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install hexo(npm install hexo-cli -g)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…ä¾èµ–åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…éƒ¨ç½²ç›¸å…³é…ç½®</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install hexo-deployer-git</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½¿ç”¨hexoå¯ä»¥ç”Ÿæˆé™æ€ç½‘é¡µéƒ¨ç½²åˆ°GitHubå’ŒVPSä¸Šæ­å»ºä¸ªäººåšå®¢ï¼Œä½†æ˜¯hexoçš„éƒ¨ç½²éƒ½æ˜¯åœ¨æœ¬åœ°ï¼Œå¦‚æœæ¢äº†ä¸€å¥—ç¯å¢ƒå¦‚ä½•ä¹Ÿèƒ½å¤Ÿç¼–è¾‘å‘å¸ƒè‡ªå·±çš„åšå®¢ç½‘ç«™å‘¢ï¼Ÿ&lt;br&gt;
    
    </summary>
    
      <category term="hexo" scheme="https://www.elietio.xyz/categories/hexo/"/>
    
    
      <category term="linux" scheme="https://www.elietio.xyz/tags/linux/"/>
    
      <category term="hexo" scheme="https://www.elietio.xyz/tags/hexo/"/>
    
      <category term="git" scheme="https://www.elietio.xyz/tags/git/"/>
    
      <category term="subtree" scheme="https://www.elietio.xyz/tags/subtree/"/>
    
  </entry>
  
  <entry>
    <title>linuxçš„awkå‘½ä»¤</title>
    <link href="https://www.elietio.xyz/posts/5bafe779.html"/>
    <id>https://www.elietio.xyz/posts/5bafe779.html</id>
    <published>2019-04-10T11:39:27.000Z</published>
    <updated>2020-06-13T08:18:25.216Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>awkæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ï¼Œç›¸å¯¹äºgrepçš„æŸ¥æ‰¾ï¼Œsedçš„ç¼–è¾‘ï¼Œawkåœ¨å…¶å¯¹æ•°æ®åˆ†æå¹¶ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œæ˜¾å¾—å°¤ä¸ºå¼ºå¤§ã€‚ç®€å•æ¥è¯´awkå°±æ˜¯æŠŠæ–‡ä»¶é€è¡Œçš„è¯»å…¥ï¼Œä»¥ç©ºæ ¼ä¸ºé»˜è®¤åˆ†éš”ç¬¦å°†æ¯è¡Œåˆ‡ç‰‡ï¼Œåˆ‡å¼€çš„éƒ¨åˆ†å†è¿›è¡Œå„ç§åˆ†æå¤„ç†ã€‚<br><a id="more"></a><br>awk å‘½ä»¤å’Œ sed å‘½ä»¤ç»“æ„ç›¸åŒï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œawk å°†æ¯ä¸ªè¾“å…¥è¡Œè§£é‡Šä¸ºä¸€æ¡è®°å½•è€Œæ¯ä¸€è¡Œä¸­çš„å†…å®¹ï¼ˆç”±ç©ºæ ¼æˆ–è€…åˆ¶è¡¨ç¬¦åˆ†éš”ï¼‰è§£é‡Šä¸ºæ¯ä¸€ä¸ªå­—æ®µï¼Œä¸€ä¸ªæˆ–è€…å¤šä¸ªè¿ç»­ç©ºæ ¼æˆ–è€…åˆ¶è¡¨ç¬¦çœ‹åšå®šç•Œç¬¦ã€‚awk ä¸­ <code>$0</code> ä»£è¡¨æ•´ä¸ªè®°å½•ã€‚</p><h2 id="linuxçš„awkå‘½ä»¤"><a href="#linuxçš„awkå‘½ä»¤" class="headerlink" title="linuxçš„awkå‘½ä»¤"></a>linuxçš„awkå‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk ' /MA/ &#123; print $1 &#125;' list</span><br></pre></td></tr></table></figure><p>è§£é‡Šï¼šæ‰“å°åŒ…å« MA çš„è¡Œä¸­çš„ç¬¬ä¸€ä¸ªå•è¯ã€‚å†ä¸¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œæ¯”å¦‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 'this is one world\nthat is another world' | awk '&#123;print $1&#125;'</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¾“å‡ºå°±æ˜¯ awk å¤„ç†ä¹‹åçš„æ¯ä¸€è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¹Ÿå°±æ˜¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">this</span><br><span class="line">that</span><br></pre></td></tr></table></figure><h3 id="åŸºæœ¬æ ¼å¼"><a href="#åŸºæœ¬æ ¼å¼" class="headerlink" title="åŸºæœ¬æ ¼å¼"></a>åŸºæœ¬æ ¼å¼</h3><p>awk å‘½ä»¤çš„åŸºæœ¬æ ¼å¼</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk [options] <span class="string">'script'</span> file</span><br></pre></td></tr></table></figure><p><code>options</code> è¿™ä¸ªè¡¨ç¤ºä¸€äº›å¯é€‰çš„å‚æ•°é€‰é¡¹ï¼Œ<code>script</code> è¡¨ç¤º awk çš„å¯æ‰§è¡Œè„šæœ¬ä»£ç ï¼ˆä¸€èˆ¬è¢«<code>{}</code> èŠ±æ‹¬å·åŒ…å›´ï¼‰ï¼Œè¿™ä¸ªæ˜¯å¿…é¡»çš„ã€‚<code>file</code> è¿™ä¸ªè¡¨ç¤º awk éœ€è¦å¤„ç†çš„æ–‡ä»¶ï¼Œæ³¨æ„éœ€è¦æ˜¯çº¯æ–‡æœ¬æ–‡ä»¶ï¼ˆæ„å‘³ç€ awk èƒ½å¤Ÿå¤„ç†ï¼‰ã€‚</p><h3 id="awk-è‡ªå®šä¹‰åˆ†éš”ç¬¦"><a href="#awk-è‡ªå®šä¹‰åˆ†éš”ç¬¦" class="headerlink" title="awk è‡ªå®šä¹‰åˆ†éš”ç¬¦"></a>awk è‡ªå®šä¹‰åˆ†éš”ç¬¦</h3><p>ä¹‹å‰æåˆ°çš„awk é»˜è®¤çš„åˆ†å‰²ç¬¦ä¸º<strong>ç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦</strong>ï¼Œawk ä¼šæ ¹æ®è¿™ä¸ªé»˜è®¤çš„åˆ†éš”ç¬¦å°†æ¯ä¸€è¡Œåˆ†ä¸ºè‹¥å¹²å­—æ®µï¼Œä¾æ¬¡ç”¨ <code>$1</code>, <code>$2</code>,<code>$3</code> æ¥è¡¨ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ <code>-F</code> å‚æ•°æ¥æŒ‡å®šåˆ†éš”ç¬¦</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F <span class="string">':'</span> <span class="string">'&#123;print $1&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure><p>è§£é‡Šï¼šä½¿ç”¨ <code>-F</code> æ¥æ”¹å˜åˆ†éš”ç¬¦ä¸º <code>:</code> ï¼Œæ¯”å¦‚ä¸Šé¢çš„å‘½ä»¤å°† /etc/passwd æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œç”¨å†’å· <code>:</code> åˆ†å‰²æˆå¤šä¸ªå­—æ®µï¼Œç„¶åç”¨ print å°†ç¬¬ 1 åˆ—å­—æ®µçš„å†…å®¹æ‰“å°è¾“å‡º</p><p>åœ¨ awk ä¸­åŒæ—¶æŒ‡å®šå¤šä¸ªåˆ†éš”ç¬¦ï¼Œæ¯”å¦‚ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªæ–‡ä»¶ some.log æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Grape(100g)1980</span><br><span class="line">raisins(500g)1990</span><br><span class="line">plum(240g)1997</span><br><span class="line">apricot(180g)2005</span><br><span class="line">nectarine(200g)2008</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æƒ³å°†ä¸Šé¢çš„ some.log æ–‡ä»¶ä¸­æŒ‰ç…§ â€œæ°´æœåç§°ï¼ˆé‡é‡ï¼‰å¹´ä»½â€ æ¥è¿›è¡Œåˆ†å‰²</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ awk -F <span class="string">'[()]'</span> <span class="string">'&#123;print $1, $2, $3&#125;'</span> some.log</span><br><span class="line">Grape 100g 1980</span><br><span class="line">raisins 500g 1990</span><br><span class="line">plum 240g 1997</span><br><span class="line">apricot 180g 2005</span><br><span class="line">nectarine 200g 2008</span><br></pre></td></tr></table></figure><p>åœ¨ <code>-F</code> å‚æ•°ä¸­ä½¿ç”¨ä¸€å¯¹æ–¹æ‹¬å·æ¥æŒ‡å®šå¤šä¸ªåˆ†éš”ç¬¦ï¼Œawk å¤„ç† some.log æ–‡ä»¶æ—¶å°±ä¼šä½¿ç”¨ â€œ(â€œ æˆ–è€… â€œ)â€ æ¥å¯¹æ–‡ä»¶çš„æ¯ä¸€è¡Œè¿›è¡Œåˆ†å‰²ã€‚</p><h3 id="awk-å†…ç½®å˜é‡çš„ä½¿ç”¨"><a href="#awk-å†…ç½®å˜é‡çš„ä½¿ç”¨" class="headerlink" title="awk å†…ç½®å˜é‡çš„ä½¿ç”¨"></a>awk å†…ç½®å˜é‡çš„ä½¿ç”¨</h3><p>awk é™¤äº† <code>$</code> å’Œæ•°å­—è¡¨ç¤ºå­—æ®µè¿˜æœ‰ä¸€äº›å…¶ä»–çš„å†…ç½®å˜é‡ï¼š</p><ul><li>$0 è¿™ä¸ªè¡¨ç¤ºæ–‡æœ¬å¤„ç†æ—¶çš„å½“å‰è¡Œï¼Œ$1 è¡¨ç¤ºæ–‡æœ¬è¡Œè¢«åˆ†éš”åçš„ç¬¬ 1 ä¸ªå­—æ®µåˆ—ï¼Œ$2 è¡¨ç¤ºæ–‡æœ¬è¡Œè¢«åˆ†å‰²åçš„ç¬¬ 2 ä¸ªå­—æ®µåˆ—ï¼Œ$3 è¡¨ç¤ºæ–‡æœ¬è¡Œè¢«åˆ†å‰²åçš„ç¬¬ 3 ä¸ªå­—æ®µåˆ—ï¼Œ$n è¡¨ç¤ºæ–‡æœ¬è¡Œè¢«åˆ†å‰²åçš„ç¬¬ n ä¸ªå­—æ®µåˆ—</li><li>NR è¡¨ç¤ºæ–‡ä»¶ä¸­çš„è¡Œå·ï¼Œè¡¨ç¤ºå½“å‰æ˜¯ç¬¬å‡ è¡Œ</li><li>NF è¡¨ç¤ºæ–‡ä»¶ä¸­çš„å½“å‰è¡Œè¢«åˆ†å‰²çš„åˆ—æ•°ï¼Œå¯ä»¥ç†è§£ä¸º MySQL æ•°æ®è¡¨é‡Œé¢æ¯ä¸€æ¡è®°å½•æœ‰å¤šå°‘ä¸ªå­—æ®µï¼Œæ‰€ä»¥ $NF å°±è¡¨ç¤ºæœ€åä¸€ä¸ªå­—æ®µï¼Œ$(NF-1) å°±è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªå­—æ®µ</li><li>FS è¡¨ç¤º awk çš„è¾“å…¥åˆ†éš”ç¬¦ï¼Œé»˜è®¤åˆ†éš”ç¬¦ä¸ºç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œè‡ªå®šä¹‰è®¾ç½®</li><li>OFS è¡¨ç¤º awk çš„è¾“å‡ºåˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥å¯¹å…¶è¿›è¡Œè‡ªå®šä¹‰è®¾ç½®</li><li>FILENAME è¡¨ç¤ºå½“å‰æ–‡ä»¶çš„æ–‡ä»¶åç§°ï¼Œå¦‚æœåŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶ï¼Œå®ƒä¹Ÿè¡¨ç¤ºå½“å‰æ–‡ä»¶åç§°</li><li>RS è¡Œåˆ†éš”ç¬¦ï¼Œç”¨äºåˆ†å‰²è¡Œï¼Œé»˜è®¤ä¸ºæ¢è¡Œç¬¦</li><li>ORS è¾“å‡ºè®°å½•çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºæ¢è¡Œç¬¦</li></ul><p>æ¯”å¦‚æˆ‘ä»¬æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ fruit.txt å†…å®¹å¦‚ä¸‹ï¼Œç”¨å®ƒæ¥æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ awk å‘½ä»¤å·¥å…·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">peach    100   Mar  1997   China</span><br><span class="line">Lemon    150   Jan  1986   America</span><br><span class="line">Pear     240   Mar  1990   Janpan</span><br><span class="line">avocado  120   Feb  2008   china</span><br><span class="line"></span><br><span class="line">awk <span class="string">'&#123;print $0&#125;'</span> fruit.txt   <span class="comment"># è¡¨ç¤ºæ‰“å°è¾“å‡ºæ–‡ä»¶çš„æ¯ä¸€æ•´è¡Œçš„å†…å®¹</span></span><br><span class="line">awk <span class="string">'&#123;print $1&#125;'</span> fruit.txt   <span class="comment"># è¡¨ç¤ºæ‰“å°è¾“å‡ºæ–‡ä»¶çš„æ¯ä¸€è¡Œçš„ç¬¬ 1 åˆ—å†…å®¹</span></span><br><span class="line">awk <span class="string">'&#123;print $1, $2&#125;'</span> fruit.txt</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶çš„æ¯ä¸€è¡Œçš„æ¯ä¸€åˆ—çš„å†…å®¹é™¤äº†å¯ä»¥ç”¨ print å‘½ä»¤æ‰“å°è¾“å‡ºä»¥å¤–ï¼Œè¿˜å¯ä»¥å¯¹å…¶è¿›è¡Œèµ‹å€¼</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;$2 = "***"; print $0&#125;'</span> fruit.txt</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­å°±æ˜¯è¡¨ç¤ºé€šè¿‡å¯¹ <code>$2</code> å˜é‡è¿›è¡Œé‡æ–°èµ‹å€¼ï¼Œæ¥éšè—æ¯ä¸€è¡Œçš„ç¬¬ 2 åˆ—å†…å®¹ï¼Œå¹¶ä¸”ç”¨æ˜Ÿå· <code>*</code> æ¥ä»£æ›¿å…¶è¾“å‡º</p><p>åœ¨å‚æ•°åˆ—è¡¨ä¸­åŠ å…¥ä¸€äº›å­—ç¬¦ä¸²æˆ–è€…è½¬ä¹‰å­—ç¬¦ä¹‹ç±»çš„ä¸œä¸œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;print $1 "\t" $2 "\t" $3&#125;'</span> fruit.txt</span><br></pre></td></tr></table></figure><p>åƒä¸Šé¢è¿™æ ·ï¼Œä½ å¯ä»¥åœ¨ print çš„å‚æ•°åˆ—è¡¨ä¸­åŠ å…¥ä¸€äº›å­—ç¬¦ä¸²æˆ–è€…è½¬ä¹‰å­—ç¬¦ä¹‹ç±»çš„ä¸œä¸œï¼Œè®©è¾“å‡ºçš„å†…å®¹æ ¼å¼æ›´æ¼‚äº®ï¼Œä½†ä¸€å®šè¦è®°ä½è¦ä½¿ç”¨åŒå¼•å·ã€‚</p><p>awk å†…ç½® NR å˜é‡è¡¨ç¤ºæ¯ä¸€è¡Œçš„è¡Œå·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;print NR "\t" $0&#125;'</span> fruit.txt</span><br><span class="line"></span><br><span class="line">1   peach    100   Mar  1997   China</span><br><span class="line">2   Lemon    150   Jan  1986   America</span><br><span class="line">3   Pear     240   Mar  1990   Janpan</span><br><span class="line">4   avocado  120   Feb  2008   china</span><br></pre></td></tr></table></figure><p>awk å†…ç½® <code>NF</code> å˜é‡è¡¨ç¤ºæ¯ä¸€è¡Œçš„åˆ—æ•°</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;print NF "\t" $0&#125;'</span> fruit.txt</span><br><span class="line"></span><br><span class="line">5   peach    100   Mar  1997   China</span><br><span class="line">5   Lemon    150   Jan  1986   America</span><br><span class="line">5   Pear     240   Mar  1990   Janpan</span><br><span class="line">5   avocado  120   Feb  2008   china</span><br></pre></td></tr></table></figure><p>awk ä¸­ <code>$NF</code> å˜é‡çš„ä½¿ç”¨</p><pre><code>awk &apos;{print $NF}&apos; fruit.txt</code></pre><p>ä¸Šé¢è¿™ä¸ª <code>$NF</code> å°±è¡¨ç¤ºæ¯ä¸€è¡Œçš„æœ€åä¸€åˆ—ï¼Œå› ä¸º <code>NF</code> è¡¨ç¤ºä¸€è¡Œçš„æ€»åˆ—æ•°ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œè¡¨ç¤ºæœ‰ 5 åˆ—ï¼Œç„¶ååœ¨å…¶å‰é¢åŠ ä¸Š <code>$</code> ç¬¦å·ï¼Œå°±å˜æˆäº† <code>$5</code> ï¼Œè¡¨ç¤ºç¬¬ 5 åˆ—</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;print $(NF - 1)&#125;'</span> fruit.txt</span><br><span class="line"></span><br><span class="line">1997</span><br><span class="line">1986</span><br><span class="line">1990</span><br><span class="line">2008</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ <code>$(NF-1)</code> è¡¨ç¤ºå€’æ•°ç¬¬ 2 åˆ—ï¼Œ <code>$(NF-2)</code> è¡¨ç¤ºå€’æ•°ç¬¬ 3 åˆ—ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'NR % 6'</span>        <span class="comment"># æ‰“å°å‡ºäº† 6 å€æ•°è¡Œä¹‹å¤–çš„å…¶ä»–è¡Œ</span></span><br><span class="line">awk <span class="string">'NR &gt; 5'</span>        <span class="comment"># æ‰“å°ç¬¬ 5 è¡Œä¹‹åå†…å®¹ï¼Œç±»ä¼¼ `tail -n +6` æˆ–è€… `sed '1,5d'`</span></span><br><span class="line">awk <span class="string">'NF &gt;= 6'</span>       <span class="comment"># æ‰“å°å¤§äºç­‰äº 6 åˆ—çš„è¡Œ</span></span><br><span class="line">awk <span class="string">'/foo/ &amp;&amp; /bar/'</span>    <span class="comment"># æ‰“å°åŒ¹é… `/foo/` å’Œ `/bar/` çš„è¡Œ</span></span><br><span class="line">awk <span class="string">'/foo/ &amp;&amp; !/bar/'</span>   <span class="comment"># æ‰“å°åŒ…å« `/foo/` ä¸åŒ…å« `/bar/` çš„è¡Œ</span></span><br><span class="line">awk <span class="string">'/foo/ || /bar/'</span>    <span class="comment"># æˆ–</span></span><br><span class="line">awk <span class="string">'/foo/,/bar/'</span>       <span class="comment"># æ‰“å°ä»åŒ¹é… `/foo/` å¼€å§‹çš„è¡Œåˆ° `/bar/` çš„è¡Œï¼ŒåŒ…å«è¿™ä¸¤è¡Œ</span></span><br></pre></td></tr></table></figure><h3 id="awk-å†…ç½®å‡½æ•°"><a href="#awk-å†…ç½®å‡½æ•°" class="headerlink" title="awk å†…ç½®å‡½æ•°"></a>awk å†…ç½®å‡½æ•°</h3><p>awk è¿˜æä¾›äº†ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚</p><ul><li><code>toupper()</code> ç”¨äºå°†å­—ç¬¦è½¬ä¸ºå¤§å†™</li><li><code>tolower()</code> å°†å­—ç¬¦è½¬ä¸ºå°å†™</li><li><code>length()</code> é•¿åº¦</li><li><code>substr()</code> å­å­—ç¬¦ä¸²</li><li><code>sin()</code> æ­£å¼¦</li><li><code>cos()</code> ä½™å¼¦</li><li><code>sqrt()</code> å¹³æ–¹æ ¹</li><li><code>rand()</code> éšæœºæ•°</li></ul><p>æ›´å¤šçš„æ–¹æ³•å¯ä»¥å‚è€ƒ <code>man awk</code></p><h3 id="awk-åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶"><a href="#awk-åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶" class="headerlink" title="awk åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶"></a>awk åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;print FILENAME "\t" $0&#125;'</span> demo1.txt demo2.txt</span><br></pre></td></tr></table></figure><p>å½“ä½ ä½¿ç”¨ awk åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå®ƒä¼šå°†å¤šä¸ªæ–‡ä»¶åˆå¹¶å¤„ç†ï¼Œå˜é‡<code>FILENAME</code> å°±è¡¨ç¤ºå½“å‰æ–‡æœ¬è¡Œæ‰€åœ¨çš„æ–‡ä»¶åç§°ã€‚</p><h3 id="BEGIN-å…³é”®å­—çš„ä½¿ç”¨"><a href="#BEGIN-å…³é”®å­—çš„ä½¿ç”¨" class="headerlink" title="BEGIN å…³é”®å­—çš„ä½¿ç”¨"></a>BEGIN å…³é”®å­—çš„ä½¿ç”¨</h3><p>åœ¨è„šæœ¬ä»£ç æ®µå‰é¢ä½¿ç”¨ BEGIN å…³é”®å­—æ—¶ï¼Œå®ƒä¼šåœ¨å¼€å§‹è¯»å–ä¸€ä¸ªæ–‡ä»¶ä¹‹å‰ï¼Œè¿è¡Œä¸€æ¬¡ <code>BEGIN</code>å…³é”®å­—åé¢çš„è„šæœ¬ä»£ç æ®µï¼Œ BEGIN åé¢çš„è„šæœ¬ä»£ç æ®µåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰§è¡Œå®Œä¹‹å awk ç¨‹åºå°±ä¼šé€€å‡º</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN &#123;print "Start read file"&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure><p>awk è„šæœ¬ä¸­å¯ä»¥ç”¨å¤šä¸ªèŠ±æ‹¬å·æ¥æ‰§è¡Œå¤šä¸ªè„šæœ¬ä»£ç ï¼Œå°±åƒä¸‹é¢è¿™æ ·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN &#123;print "Start read file"&#125; &#123;print $0&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure><h3 id="END-å…³é”®å­—ä½¿ç”¨æ–¹æ³•"><a href="#END-å…³é”®å­—ä½¿ç”¨æ–¹æ³•" class="headerlink" title="END å…³é”®å­—ä½¿ç”¨æ–¹æ³•"></a>END å…³é”®å­—ä½¿ç”¨æ–¹æ³•</h3><p>awk çš„ END æŒ‡ä»¤å’Œ BEGIN æ°å¥½ç›¸åï¼Œåœ¨ awk è¯»å–å¹¶ä¸”å¤„ç†å®Œæ–‡ä»¶çš„æ‰€æœ‰å†…å®¹è¡Œä¹‹åï¼Œæ‰ä¼šæ‰§è¡Œ<code>END</code>åé¢çš„è„šæœ¬ä»£ç æ®µ</p><pre><code>awk &apos;END {print &quot;End file&quot;}&apos; /etc/passwdawk &apos;BEGIN {print &quot;Start read file&quot;} {print $0} END {print &quot;End file&quot;}&apos; /etc/passwd</code></pre><h3 id="åœ¨-awk-ä¸­ä½¿ç”¨å˜é‡"><a href="#åœ¨-awk-ä¸­ä½¿ç”¨å˜é‡" class="headerlink" title="åœ¨ awk ä¸­ä½¿ç”¨å˜é‡"></a>åœ¨ awk ä¸­ä½¿ç”¨å˜é‡</h3><p>å¯ä»¥åœ¨ awk è„šæœ¬ä¸­å£°æ˜å’Œä½¿ç”¨å˜é‡</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;msg="hello world"; print msg&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure><p>awk å£°æ˜çš„å˜é‡å¯ä»¥åœ¨ä»»ä½•å¤šä¸ªèŠ±æ‹¬å·è„šæœ¬ä¸­ä½¿ç”¨</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN &#123;msg="hello world"&#125; &#123;print msg&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure><p>åœ¨ awk ä¸­ä½¿ç”¨æ•°å­¦è¿ç®—ï¼Œåœ¨ awk ä¸­ï¼Œåƒå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œå®ƒä¹Ÿæ”¯æŒä¸€äº›åŸºæœ¬çš„æ•°å­¦è¿ç®—æ“ä½œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;a = 12; b = 24; print a + b&#125;'</span> company.txt</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µè„šæœ¬è¡¨ç¤ºï¼Œå…ˆå£°æ˜ä¸¤ä¸ªå˜é‡ a = 12 å’Œ b = 24ï¼Œç„¶åç”¨ print æ‰“å°å‡º a åŠ ä¸Š b çš„ç»“æœã€‚</p><p>è¯·è®°ä½ awk æ˜¯é’ˆå¯¹æ–‡ä»¶çš„æ¯ä¸€è¡Œæ¥æ‰§è¡Œä¸€æ¬¡å•å¼•å· é‡Œé¢çš„è„šæœ¬ä»£ç ï¼Œæ¯è¯»å–åˆ°ä¸€è¡Œå°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæ–‡ä»¶é‡Œé¢æœ‰å¤šå°‘è¡Œå°±ä¼šæ‰§è¡Œå¤šå°‘æ¬¡ï¼Œä½† BEGIN å’Œ END å…³é”®å­—åè„šæœ¬ä»£ç é™¤å¤–ï¼Œå¦‚æœè¢«å¤„ç†çš„æ–‡ä»¶ä¸­ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£ awk å°±ä¸€æ¬¡éƒ½ä¸ä¼šæ‰§è¡Œã€‚</p><p>awk è¿˜æ”¯æŒå…¶ä»–çš„æ•°å­¦è¿ç®—ç¬¦</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ åŠ æ³•è¿ç®—ç¬¦</span><br><span class="line">- å‡æ³•è¿ç®—ç¬¦</span><br><span class="line">* ä¹˜æ³•è¿ç®—ç¬¦</span><br><span class="line">/ é™¤æ³•è¿ç®—ç¬¦</span><br><span class="line">% å–ä½™è¿ç®—ç¬¦</span><br></pre></td></tr></table></figure><p>åœ¨ awk ä¸­ä½¿ç”¨æ¡ä»¶åˆ¤æ–­</p><p>æ¯”å¦‚æœ‰ä¸€ä¸ªæ–‡ä»¶ company.txt å†…å®¹å¦‚ä¸‹</p><pre><code>yahoo   100 4500google  150 7500apple   180 8000twitter 120 5000</code></pre><p>å¦‚æœè¦åˆ¤æ–­æ–‡ä»¶çš„ç¬¬ 3 åˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å¹³å‡å·¥èµ„å°äº 5500 çš„å…¬å¸ï¼Œç„¶åå°†å…¶æ‰“å°è¾“å‡º</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 &lt; 5500 &#123;print $0&#125;'</span> company.txt</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å‘½ä»¤ç»“æœå°±æ˜¯å¹³å‡å·¥èµ„å°äº 5500 çš„å…¬å¸åå•ï¼Œ<code>$3 &lt; 5500</code> è¡¨ç¤ºå½“ç¬¬ 3 åˆ—å­—æ®µçš„å†…å®¹å°äº 5500 çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œåé¢çš„ {print $0} ä»£ç å—</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$1 == "yahoo" &#123;print $0&#125;'</span> company.txt</span><br></pre></td></tr></table></figure><p>awk è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ¡ä»¶æ“ä½œç¬¦å¦‚ä¸‹</p><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">&lt;</td><td style="text-align:left">å°äº</td></tr><tr><td style="text-align:left">&lt;=</td><td style="text-align:left">å°äºæˆ–ç­‰äº</td></tr><tr><td style="text-align:left">==</td><td style="text-align:left">ç­‰äº</td></tr><tr><td style="text-align:left">!=</td><td style="text-align:left">ä¸ç­‰äº</td></tr><tr><td style="text-align:left">&gt;</td><td style="text-align:left">å¤§äº</td></tr><tr><td style="text-align:left">&gt;=</td><td style="text-align:left">å¤§äºæˆ–ç­‰äº</td></tr><tr><td style="text-align:left">~</td><td style="text-align:left">åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td style="text-align:left">!~</td><td style="text-align:left">ä¸åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</td></tr></tbody></table><p>ä½¿ç”¨ if æŒ‡ä»¤åˆ¤æ–­æ¥å®ç°ä¸Šé¢åŒæ ·çš„æ•ˆæœ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;if ($3 &lt; 5500) print $0&#125;'</span> company.txt</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¡¨ç¤ºå¦‚æœç¬¬ 3 åˆ—å­—æ®µå°äº 5500 çš„æ—¶å€™å°±ä¼šæ‰§è¡Œåé¢çš„ print $0</p><h3 id="åœ¨-awk-ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼"><a href="#åœ¨-awk-ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="åœ¨ awk ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼"></a>åœ¨ awk ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</h3><p>æ¯”å¦‚ç°åœ¨æˆ‘ä»¬æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶ poetry.txt å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">This above all: to thine self be <span class="literal">true</span></span><br><span class="line">There is nothing either good or bad, but thinking makes it so</span><br><span class="line">Thereâ€™s a special providence <span class="keyword">in</span> the fall of a sparrow</span><br><span class="line">No matter how dark long, may eventually <span class="keyword">in</span> the day arrival</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å­—ç¬¦ä¸² â€œThereâ€ ï¼Œå°†åŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²çš„è¡Œæ‰“å°å¹¶è¾“å‡º</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/There/&#123;print $0&#125;'</span> poetry.txt</span><br><span class="line"></span><br><span class="line">There is nothing either good or bad, but thinking makes it so</span><br><span class="line">Thereâ€™s a special providence <span class="keyword">in</span> the fall of a sparrow</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼é…ä¸€ä¸ªåŒ…å«å­—æ¯ t å’Œå­—æ¯ e ï¼Œå¹¶ä¸” t å’Œ e ä¸­é—´åªèƒ½æœ‰ä»»æ„å•ä¸ªå­—ç¬¦çš„è¡Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/t.e/&#123;print $0&#125;'</span> poetry.txt</span><br><span class="line"></span><br><span class="line">There is nothing either good or bad, but thinking makes it so</span><br><span class="line">Thereâ€™s a special providence <span class="keyword">in</span> the fall of a sparrow</span><br><span class="line">No matter how dark long, may eventually <span class="keyword">in</span> the day arrival</span><br></pre></td></tr></table></figure><p>å¦‚æœåªæƒ³åŒ¹é…å•çº¯çš„å­—ç¬¦ä¸² â€œt.eâ€ï¼Œ é‚£æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯è¿™æ ·çš„ /t.e/ ï¼Œç”¨åæ–œæ æ¥è½¬ä¹‰ . ç¬¦å· å› ä¸º . åœ¨æ­£åˆ™è¡¨è¾¾å¼é‡Œé¢è¡¨ç¤ºä»»æ„å•ä¸ªå­—ç¬¦ã€‚</p><p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ‰€æœ‰ä»¥ â€œTheâ€ å­—ç¬¦ä¸²å¼€å¤´çš„è¡Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/^The/&#123;print $0&#125;'</span> poetry.txt</span><br></pre></td></tr></table></figure><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ <code>^</code>è¡¨ç¤ºä»¥æŸæŸå­—ç¬¦æˆ–è€…å­—ç¬¦ä¸²å¼€å¤´ã€‚</p><p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ‰€æœ‰ä»¥ â€œtrueâ€ å­—ç¬¦ä¸²ç»“å°¾çš„è¡Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/true$/&#123;print $0&#125;'</span> poetry.txt</span><br></pre></td></tr></table></figure><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ $ è¡¨ç¤ºä»¥æŸæŸå­—ç¬¦æˆ–è€…å­—ç¬¦ä¸²ç»“å°¾ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/m[a]t/&#123;print $0&#125;'</span> poetry.txt</span><br><span class="line"></span><br><span class="line">No matter how dark long, may eventually <span class="keyword">in</span> the day arrival</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ <code>/m[a]t/</code> è¡¨ç¤ºåŒ¹é…åŒ…å«å­—ç¬¦ m ï¼Œç„¶åæ¥ç€åé¢åŒ…å«ä¸­é—´æ–¹æ‹¬å·ä¸­è¡¨ç¤ºçš„å•ä¸ªå­—ç¬¦ a ï¼Œæœ€ååŒ…å«å­—ç¬¦ t çš„è¡Œï¼Œè¾“å‡ºç»“æœä¸­åªæœ‰å•è¯ â€œmatterâ€ ç¬¦åˆè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…ã€‚å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼ [a] æ–¹æ‹¬å·ä¸­è¡¨ç¤ºåŒ¹é…é‡Œé¢çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚</p><p>ç»§ç»­ä¸Šé¢çš„ä¸€ä¸ªæ–°ä¾‹å­å¦‚ä¸‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/^Th[ie]/&#123;print $0&#125;'</span> poetry.txt</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ /^Th[ie]/ è¡¨ç¤ºåŒ¹é…ä»¥å­—ç¬¦ä¸² â€œThiâ€ æˆ–è€… â€œTheâ€ å¼€å¤´çš„è¡Œï¼Œæ­£åˆ™è¡¨è¾¾å¼æ–¹æ‹¬å·ä¸­è¡¨ç¤ºåŒ¹é…å…¶ä¸­çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚</p><p>å†ç»§ç»­ä¸Šé¢çš„æ–°çš„ç”¨æ³•</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/s[a-z]/&#123;print $0&#125;'</span> poetry.txt</span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼ <code>/s[a-z]/</code> è¡¨ç¤ºåŒ¹é…åŒ…å«å­—ç¬¦ s ç„¶ååé¢è·Ÿç€ä»»æ„ a åˆ° z ä¹‹é—´çš„å•ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ â€œseâ€, â€œsoâ€, â€œspâ€ ç­‰ç­‰ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼ [] æ–¹æ‹¬å·ä¸­è¿˜æœ‰ä¸€äº›å…¶ä»–ç”¨æ³•æ¯”å¦‚ä¸‹é¢è¿™äº›</p><pre><code>[a-zA-Z]  è¡¨ç¤ºåŒ¹é…å°å†™çš„ a åˆ° z ä¹‹é—´çš„å•ä¸ªå­—ç¬¦ï¼Œæˆ–è€…å¤§å†™çš„ A åˆ° Z ä¹‹é—´çš„å•ä¸ªå­—ç¬¦[^a-z]    ç¬¦å· `^` åœ¨æ–¹æ‹¬å·é‡Œé¢è¡¨ç¤ºå–åï¼Œä¹Ÿå°±æ˜¯éçš„æ„æ€ï¼Œè¡¨ç¤ºåŒ¹é…ä»»ä½•é a åˆ° z ä¹‹é—´çš„å•ä¸ªå­—ç¬¦</code></pre><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„æ˜Ÿå· <code>*</code> å’ŒåŠ å· <code>+</code> çš„ä½¿ç”¨æ–¹æ³•ï¼Œ<code>*</code> è¡¨ç¤ºåŒ¹é…æ˜Ÿå·å‰å­—ç¬¦ä¸² 0 æ¬¡æˆ–è€…å¤šæ¬¡ï¼Œ<code>+</code> å’Œæ˜Ÿå·åŸç†å·®ä¸å¤šï¼Œåªæ˜¯åŠ å·è¡¨ç¤ºä»»æ„ 1 ä¸ªæˆ–è€… 1 ä¸ªä»¥ä¸Šï¼Œä¹Ÿå°±æ˜¯å¿…é¡»è‡³å°‘è¦å‡ºç°ä¸€æ¬¡ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼é—®å· ? çš„ä½¿ç”¨æ–¹æ³•ï¼Œæ­£åˆ™ä¸­çš„é—®å· <code>?</code> è¡¨ç¤ºå®ƒå‰é¢çš„å­—ç¬¦åªèƒ½å‡ºç° 0 æ¬¡ æˆ–è€… 1 æ¬¡ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ {} èŠ±æ‹¬å·ç”¨æ³•ï¼ŒèŠ±æ‹¬å· {} è¡¨ç¤ºè§„å®šå®ƒå‰é¢çš„å­—ç¬¦å¿…é¡»å‡ºç°çš„æ¬¡æ•°ï¼Œåƒè¿™ä¸ª /go{2}d/ å°±è¡¨ç¤ºåªåŒ¹é…å­—ç¬¦ä¸² â€œgoodâ€ï¼Œä¹Ÿå°±æ˜¯ä¸­é—´çš„å­—æ¯ â€œoâ€ å¿…é¡»è¦å‡ºç° 2 æ¬¡ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„èŠ±æ‹¬å·è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ç”¨æ³•å¦‚ä¸‹</p><pre><code>/go{2,10}d/   è¡¨ç¤ºå­—æ¯ &quot;o&quot; åªèƒ½å¯ä»¥å‡ºç° 2 æ¬¡ï¼Œ3 æ¬¡ï¼Œ4 æ¬¡ï¼Œ5 æ¬¡ï¼Œ6 æ¬¡ ... ä¸€ç›´åˆ° 10 æ¬¡/go{2,}d/     è¡¨ç¤ºå­—æ¯ &quot;o&quot; å¿…é¡»è‡³å°‘å‡ºç° 2 æ¬¡æˆ–ç€ 2 æ¬¡ä»¥ä¸Š</code></pre><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„åœ†æ‹¬å·è¡¨ç¤ºå°†å¤šä¸ªå­—ç¬¦å½“æˆä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡æ¥çœ‹å¾…ã€‚æ¯”å¦‚ /th(in){1}king/ å°±è¡¨ç¤ºå…¶ä¸­å­—ç¬¦ä¸² â€œinâ€ å¿…é¡»å‡ºç° 1 æ¬¡ã€‚è€Œå¦‚æœä¸åŠ åœ†æ‹¬å·å°±å˜æˆäº† /thin{1}king/ è¿™ä¸ªå°±è¡¨ç¤ºå…¶ä¸­å­—ç¬¦ â€œnâ€ å¿…é¡»å‡ºç° 1 æ¬¡ã€‚</p><h3 id="ä¸€äº›ç»„åˆä½¿ç”¨"><a href="#ä¸€äº›ç»„åˆä½¿ç”¨" class="headerlink" title="ä¸€äº›ç»„åˆä½¿ç”¨"></a>ä¸€äº›ç»„åˆä½¿ç”¨</h3><p>ä½¿ç”¨ awk è¿‡æ»¤ history è¾“å‡ºï¼Œæ‰¾åˆ°æœ€å¸¸ç”¨çš„å‘½ä»¤<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span> | awk <span class="string">'&#123;a[$2]++&#125;END&#123;for(i in a)&#123;print a[i] " " i&#125;&#125;'</span> | sort -rn | head</span><br></pre></td></tr></table></figure></p><p>è¿‡æ»¤æ–‡ä»¶ä¸­é‡å¤è¡Œ<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'!x[$0]++'</span> &lt;file&gt;</span><br></pre></td></tr></table></figure></p><p>å°†ä¸€è¡Œé•¿åº¦è¶…è¿‡ 72 å­—ç¬¦çš„è¡Œæ‰“å°<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'length&gt;72'</span> file</span><br></pre></td></tr></table></figure></p><p>æŸ¥çœ‹æœ€è¿‘å“ªäº›ç”¨æˆ·ä½¿ç”¨ç³»ç»Ÿ<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last | grep -v <span class="string">"^$"</span> | awk <span class="string">'&#123; print $1 &#125;'</span> | sort -nr | uniq -c</span><br></pre></td></tr></table></figure></p><p>å‡è®¾æœ‰ä¸€ä¸ªæ–‡æœ¬ï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ª int æ•°å€¼ï¼Œæƒ³è¦è®¡ç®—è¿™ä¸ªæ–‡ä»¶æ¯ä¸€è¡Œçš„å’Œï¼Œå¯ä»¥ä½¿ç”¨<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;s+=$1&#125; ENG &#123;printf "%.0f", s&#125;'</span> /path/to/file</span><br></pre></td></tr></table></figure></p><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><blockquote><ul><li><a href="http://www.ruanyifeng.com/blog/2018/11/awk.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2018/11/awk.html</a></li></ul></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;awkæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ï¼Œç›¸å¯¹äºgrepçš„æŸ¥æ‰¾ï¼Œsedçš„ç¼–è¾‘ï¼Œawkåœ¨å…¶å¯¹æ•°æ®åˆ†æå¹¶ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œæ˜¾å¾—å°¤ä¸ºå¼ºå¤§ã€‚ç®€å•æ¥è¯´awkå°±æ˜¯æŠŠæ–‡ä»¶é€è¡Œçš„è¯»å…¥ï¼Œä»¥ç©ºæ ¼ä¸ºé»˜è®¤åˆ†éš”ç¬¦å°†æ¯è¡Œåˆ‡ç‰‡ï¼Œåˆ‡å¼€çš„éƒ¨åˆ†å†è¿›è¡Œå„ç§åˆ†æå¤„ç†ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="linux" scheme="https://www.elietio.xyz/categories/linux/"/>
    
      <category term="shell" scheme="https://www.elietio.xyz/categories/linux/shell/"/>
    
    
      <category term="linux" scheme="https://www.elietio.xyz/tags/linux/"/>
    
      <category term="shell" scheme="https://www.elietio.xyz/tags/shell/"/>
    
      <category term="awk" scheme="https://www.elietio.xyz/tags/awk/"/>
    
  </entry>
  
  <entry>
    <title>å¯¹äºå«æœ‰æ³›å‹çš„ç±»,å¦‚ä½•åœ¨ç±»ä¸­è·å–æ³›å‹çš„classå¯¹è±¡ï¼Ÿ</title>
    <link href="https://www.elietio.xyz/posts/eb59d595.html"/>
    <id>https://www.elietio.xyz/posts/eb59d595.html</id>
    <published>2018-05-04T16:00:00.000Z</published>
    <updated>2020-06-13T08:18:25.216Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>å¯¹äºå«æœ‰æ³›å‹çš„ç±»,å¦‚ä½•åœ¨ç±»ä¸­è·å–æ³›å‹çš„classå¯¹è±¡ï¼Ÿ</p><p>å¦‚æœå­ç±»ç»§æ‰¿è¯¥ç±»çš„æ—¶å€™ä¼ é€’äº†æ³›å‹ï¼Œæ‰€ä»¥ç¼–è¯‘æœŸè¯¥ç±»çš„æ³›å‹å…¶å®å·²ç»æŒ‡å®šäº†ã€‚é‚£ä¹ˆåœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªClasså¯¹è±¡ï¼Œç„¶åé€šè¿‡æ„é€ ä»£ç å—ï¼ŒthisæŒ‡å‘çš„æ˜¯å½“å‰è°ƒç”¨çš„å­ç±»</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Class&lt;T&gt; clazz;</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// è·å–å½“å‰ç±»ä¸Šçš„æ³›å‹(thisæŒ‡å‘å½“å‰å­ç±»)</span></span><br><span class="line">   ParameterizedType type =(ParameterizedType)<span class="keyword">this</span>.getClass().getGenericSuperclass();</span><br><span class="line">   clazz = (Class&lt;T&gt;) type.getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºæ²¡æœ‰ç»§æ‰¿è¯¥ç±»çš„å­ç±»ï¼Œå¯ä»¥é‡‡ç”¨newçš„æ—¶å€™æœ‰å‚æ„é€ å‡½æ•°ä¼ é€’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Class&lt;T&gt; clazz;</span><br><span class="line"><span class="comment">//é€šè¿‡æ„é€ å‡½æ•°æŒ‡å®šå…ƒç´ ç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">classname</span><span class="params">(Class&lt;T&gt; clazz)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">super</span>();</span><br><span class="line">      <span class="keyword">this</span>.clazz = clazz;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯¹äºå«æœ‰æ³›å‹çš„ç±»,å¦‚ä½•åœ¨ç±»ä¸­è·å–æ³›å‹çš„classå¯¹è±¡ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚æœå­ç±»ç»§æ‰¿è¯¥ç±»çš„æ—¶å€™ä¼ é€’äº†æ³›å‹ï¼Œæ‰€ä»¥ç¼–è¯‘æœŸè¯¥ç±»çš„æ³›å‹å…¶å®å·²ç»æŒ‡å®šäº†ã€‚é‚£ä¹ˆåœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªClasså¯¹è±¡ï¼Œç„¶åé€šè¿‡æ„é€ ä»£ç å—ï¼ŒthisæŒ‡å‘çš„æ˜¯å½“å‰è°ƒç”¨çš„å­ç±»&lt;/p&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="Java" scheme="https://www.elietio.xyz/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>HashMapæ¢ç©¶ä»¥åŠConcurrentHashMap</title>
    <link href="https://www.elietio.xyz/posts/582417c6.html"/>
    <id>https://www.elietio.xyz/posts/582417c6.html</id>
    <published>2017-11-02T07:48:18.000Z</published>
    <updated>2020-06-13T08:18:25.216Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>HashMapæ˜¯ä¸€ç§ç»“æ„éå¸¸å·§å¦™çš„é›†åˆå®¹å™¨ã€‚HashMapæ˜¯å­˜å‚¨é”®å€¼å¯¹çš„ç»“æ„ï¼Œkeyå’Œvalueä¸€ä¸€å¯¹åº”ï¼Œkeyå¿…é¡»ä¿è¯å”¯ä¸€ï¼Œå­˜å‚¨æ— åºï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œè¿™æ˜¯å®ƒçš„ä¸€äº›åŸºæœ¬ç‰¹ç‚¹ã€‚åœ¨javaä¸­ï¼Œæœ€åŸºæœ¬çš„ç»“æ„å°±æ˜¯ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æ¨¡æ‹ŸæŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰ï¼Œæ‰€æœ‰çš„æ•°æ®ç»“æ„éƒ½å¯ä»¥ç”¨è¿™ä¸¤ä¸ªåŸºæœ¬ç»“æ„æ¥æ„é€ çš„ï¼Œhashmapä¹Ÿä¸ä¾‹å¤–ã€‚<br><a id="more"></a></p><p>Hashmapå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆä½“ï¼ˆåœ¨æ•°æ®ç»“æ„ä¸­ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œé“¾è¡¨æ•£åˆ—â€œï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º <img src="http://dl2.iteye.com/upload/attachment/0017/7479/3f05dd61-955e-3eb2-bf8e-31da8a361148.jpg" alt="Hashmapæ„æˆ"></p><p>å½“æ–°å»ºä¸€ä¸ªHashMapçš„æ—¶å€™ï¼Œä¼šåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//The table, resized as necessary. Length MUST Always be a power of two. </span></span><br><span class="line"><span class="comment">//FIXME è¿™é‡Œéœ€è¦æ³¨æ„è¿™å¥è¯ï¼Œè‡³äºåŸå› åé¢ä¼šè®²åˆ°  </span></span><br><span class="line"><span class="keyword">transient</span> Entry[ ] table;  </span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;  </span><br><span class="line">        <span class="keyword">final</span> K key;  </span><br><span class="line">        V value;  </span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> hash;  </span><br><span class="line">        Entry&lt;K,V&gt; next;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Entry&lt;K,V&gt;å°±æ˜¯å­˜å‚¨åœ¨æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œæ„æˆäº†ä¸€ä¸ªå•å‘é“¾è¡¨ã€‚ å½“æˆ‘ä»¬å¾€hashmapä¸­putå…ƒç´ çš„æ—¶å€™ï¼Œå…ˆæ ¹æ®keyçš„hashå€¼å¾—åˆ°è¿™ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼ˆå³ä¸‹æ ‡ï¼‰ï¼Œç„¶åå°±å¯ä»¥æŠŠè¿™ä¸ªå…ƒç´ æ”¾åˆ°å¯¹åº”çš„ä½ç½®ä¸­äº†ã€‚å¦‚æœè¿™ä¸ªå…ƒç´ æ‰€åœ¨çš„ä½å­ä¸Šå·²ç»å­˜æ”¾æœ‰å…¶ä»–å…ƒç´ äº†ï¼Œæ ¹æ®equalsæ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼Œæœ‰ç›¸ç­‰çš„åˆ™è¦†ç›–æ‰ï¼Œæ²¡æœ‰ç›¸å½“çš„é‚£ä¹ˆå°†ä»¥é“¾è¡¨çš„å½¢å¼å­˜æ”¾ï¼Œæ–°åŠ å…¥çš„æ”¾åœ¨é“¾å¤´ï¼Œæœ€å…ˆåŠ å…¥çš„æ”¾åœ¨é“¾å°¾ã€‚ä»hashmapä¸­getå…ƒç´ æ—¶ï¼Œé¦–å…ˆè®¡ç®—keyçš„hashcodeï¼Œæ‰¾åˆ°æ•°ç»„ä¸­å¯¹åº”ä½ç½®çš„æŸä¸€å…ƒç´ ï¼Œç„¶åé€šè¿‡keyçš„equalsæ–¹æ³•åœ¨å¯¹åº”ä½ç½®çš„é“¾è¡¨ä¸­æ‰¾åˆ°éœ€è¦çš„å…ƒç´ ã€‚</p><h3 id="1-Hashç®—æ³•"><a href="#1-Hashç®—æ³•" class="headerlink" title="1.Hashç®—æ³•"></a>1.Hashç®—æ³•</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨hashmapä¸­è¦æ‰¾åˆ°æŸä¸ªå…ƒç´ ï¼Œéœ€è¦æ ¹æ®keyçš„hashå€¼æ¥æ±‚å¾—å¯¹åº”æ•°ç»„ä¸­çš„ä½ç½®ã€‚å¦‚ä½•è®¡ç®—è¿™ä¸ªä½ç½®å°±æ˜¯hashç®—æ³•ã€‚å‰é¢è¯´è¿‡hashmapçš„æ•°æ®ç»“æ„æ˜¯æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆï¼Œæ‰€ä»¥å¦‚æœhashmapé‡Œé¢çš„å…ƒç´ ä½ç½®å°½é‡çš„åˆ†å¸ƒå‡åŒ€äº›ï¼Œå°½é‡ä½¿å¾—æ¯ä¸ªä½ç½®ä¸Šçš„å…ƒç´ æ•°é‡åªæœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆæŸ¥æ‰¾çš„æ—¶å€™æ— éœ€éå†é“¾è¡¨ï¼Œé€Ÿåº¦å°±ä¼šå¾ˆå¿«ã€‚Javaä¸­æ˜¯è¿™æ ·å®ç°çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">indexFor</span><span class="params">(<span class="keyword">int</span> h, <span class="keyword">int</span> length)</span> </span>&#123;  </span><br><span class="line">       <span class="keyword">return</span> h &amp; (length-<span class="number">1</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç®—å¾—keyå¾—hashcodeå€¼ï¼Œç„¶åè·Ÿæ•°ç»„çš„é•¿åº¦-1åšä¸€æ¬¡â€œä¸â€è¿ç®—ï¼ˆ&amp;ï¼‰ã€‚HashMapé»˜è®¤çš„åˆå§‹åŒ–æ•°ç»„é•¿åº¦æ˜¯16ï¼Œå¹¶ä¸”æ— è®ºåˆ›å»ºå¤šå¤§çš„HashMapï¼Œå®ƒçš„æ•°ç»„é•¿åº¦éƒ½æ˜¯2çš„næ¬¡æ–¹ï¼Œè¿™æ˜¯ä¸ºä½•å‘¢ï¼Ÿ çœ‹ä¸‹å›¾ï¼Œå·¦è¾¹ä¸¤ç»„æ˜¯æ•°ç»„é•¿åº¦ä¸º16ï¼ˆ2çš„4æ¬¡æ–¹ï¼‰ï¼Œå³è¾¹ä¸¤ç»„æ˜¯æ•°ç»„é•¿åº¦ä¸º15ã€‚ä¸¤ç»„çš„hashcodeå‡ä¸º8å’Œ9ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾ï¼Œå½“å®ƒä»¬å’Œ1110â€œä¸â€çš„æ—¶å€™ï¼Œäº§ç”Ÿäº†ç›¸åŒçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬ä¼šå®šä½åˆ°æ•°ç»„ä¸­çš„åŒä¸€ä¸ªä½ç½®ä¸Šå»ï¼Œè¿™å°±äº§ç”Ÿäº†ç¢°æ’ï¼Œ8å’Œ9ä¼šè¢«æ”¾åˆ°åŒä¸€ä¸ªé“¾è¡¨ä¸Šï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„æ—¶å€™å°±éœ€è¦éå†è¿™ä¸ªé“¾è¡¨ï¼Œå¾—åˆ°8æˆ–è€…9ï¼Œè¿™æ ·å°±é™ä½äº†æŸ¥è¯¢çš„æ•ˆç‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°ï¼Œå½“æ•°ç»„é•¿åº¦ä¸º15çš„æ—¶å€™ï¼Œhashcodeçš„å€¼ä¼šä¸14ï¼ˆ1110ï¼‰è¿›è¡Œâ€œä¸â€ï¼Œé‚£ä¹ˆæœ€åä¸€ä½æ°¸è¿œæ˜¯0ï¼Œè€Œ0001ï¼Œ0011ï¼Œ0101ï¼Œ1001ï¼Œ1011ï¼Œ0111ï¼Œ1101è¿™å‡ ä¸ªä½ç½®æ°¸è¿œéƒ½ä¸èƒ½å­˜æ”¾å…ƒç´ äº†ï¼Œç©ºé—´æµªè´¹ç›¸å½“å¤§ï¼Œæ›´ç³Ÿçš„æ˜¯è¿™ç§æƒ…å†µä¸­ï¼Œæ•°ç»„å¯ä»¥ä½¿ç”¨çš„ä½ç½®æ¯”æ•°ç»„é•¿åº¦å°äº†å¾ˆå¤šï¼Œè¿™æ„å‘³ç€è¿›ä¸€æ­¥å¢åŠ äº†ç¢°æ’çš„å‡ ç‡ï¼Œå‡æ…¢äº†æŸ¥è¯¢çš„æ•ˆç‡ï¼ <img src="http://dl2.iteye.com/upload/attachment/0017/7481/4b3732d6-fb5f-369b-b50d-e8b8325c69d4.jpg" alt> </p><p>å› æ­¤ï¼Œå½“æ•°ç»„çš„é•¿åº¦ä¸º2çš„næ¬¡æ–¹çš„æ—¶å€™ï¼Œèƒ½å¤Ÿå°½é‡ä¿è¯å…ƒç´ åˆ†å¸ƒå‡åŒ€ã€‚é‚£ä¹ˆæˆ‘ä»¬æƒ³è¦å­˜æ”¾1000ä¸ªå…ƒç´ ï¼Œnew HashMap(1000),javaä¼šè‡ªåŠ¨å°†HashMapçš„æ•°ç»„é•¿åº¦è®¾ä¸º1024ï¼Œè¿™æ ·åˆ°åº•åˆé€‚å—ï¼Ÿå®é™…ä¸Šå¹¶ä¸åˆé€‚ï¼ŒHashMapä¸­è¿˜æœ‰ä¸€ä¸ªè£…è½½å› å­LoadFactorã€‚</p><h3 id="HashMapçš„æ‰©å®¹"><a href="#HashMapçš„æ‰©å®¹" class="headerlink" title="HashMapçš„æ‰©å®¹"></a>HashMapçš„æ‰©å®¹</h3><p>HashMapå«æœ‰ä¸€ä¸ªé˜ˆå€¼ï¼Œå½“è¾¾åˆ°è¿™ä¸ªé˜ˆå€¼ï¼ŒHashMapå°±ä¼šæ‰©å®¹ï¼Œé‡æ–°è®¡ç®—æ¯ä¸€ä¸ªå…ƒç´ çš„Hashï¼Œæ”¾åˆ°æ–°çš„ä½ç½®ï¼Œé»˜è®¤æ‰©å®¹ä¸€å€ã€‚æ‰©å®¹ä¹Ÿæ˜¯ä¸ºäº†å‡å°‘å…ƒç´ ç¢°æ’çš„æœºç‡ï¼Œé˜ˆå€¼=æ•°ç»„é•¿åº¦xLoadFactorï¼Œé»˜è®¤LoadFactorä¸º0.75ã€‚å› æ­¤ï¼Œå›åˆ°ä¸Šé¢ï¼Œå½“æˆ‘ä»¬æƒ³è¦å­˜å‚¨1000ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œå¦‚æœè®¾ç½®HashMapå¤§å°ä¸º1024ï¼Œé‚£ä¹ˆé˜ˆå€¼ä¸º1024x0.75=768ï¼Œå³è¶…è¿‡768å°±ä¼šå‘ç”Ÿæ‰©å®¹ï¼Œä¼šå°†æ•°ç»„é•¿åº¦æ‰©å¤§åˆ°2048ï¼Œç„¶åé‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æ¶ˆè€—èµ„æºçš„æ“ä½œï¼Œå› æ­¤æ­£ç¡®çš„åšæ³•æ˜¯åº”è¯¥new HashMap(2048)æ¯”è¾ƒåˆé€‚ã€‚æˆ‘ä»¬è¯´é“HashMapæ˜¯ä¸å®‰å…¨çš„ï¼Œå®ƒçš„ä¸å®‰å…¨ä¹Ÿä¸»è¦ä½“ç°åœ¨æ‰©å®¹çš„æ—¶å€™ã€‚</p><h3 id="HashMapçš„å®‰å…¨é—®é¢˜"><a href="#HashMapçš„å®‰å…¨é—®é¢˜" class="headerlink" title="HashMapçš„å®‰å…¨é—®é¢˜"></a>HashMapçš„å®‰å…¨é—®é¢˜</h3><p>åœ¨å¤šçº¿ç¨‹æ“ä½œæ—¶ï¼Œæ‰©å®¹çš„æ—¶å€™å¦‚æœå¤šçº¿ç¨‹éƒ½è¿›è¡ŒreHashæ“ä½œï¼Œé‚£ä¹ˆæœ‰å¯èƒ½é€ æˆé“¾è¡¨ä¸­çš„å…ƒç´ ç›¸äº’å¼•ç”¨ï¼Œå³Açš„ä¸‹ä¸€ä¸ªæŒ‡å‘Bï¼ŒBçš„ä¸‹ä¸€ä¸ªæŒ‡å‘Aï¼Œé€ æˆäº†æ­»å¾ªç¯ï¼Œä»è€Œå¯¼è‡´çº¿ç¨‹ä¸å®‰å…¨ã€‚å¦‚ä½•è®©HashMapå˜æˆå®‰å…¨çš„ï¼Ÿæœ‰ä¸‰ç§æ–¹æ³•ã€‚ </p><ol><li>æ›¿æ¢æˆHashtableï¼ŒHashtableé€šè¿‡å¯¹æ•´ä¸ªè¡¨ä¸Šé”å®ç°çº¿ç¨‹å®‰å…¨ï¼Œå› æ­¤æ•ˆç‡æ¯”è¾ƒä½ </li><li><p>ä½¿ç”¨Collectionsç±»çš„synchronizedMapæ–¹æ³•åŒ…è£…ä¸€ä¸‹ã€‚æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">Map&lt;K,V&gt; <span class="title">synchronizedMap</span><span class="params">(Map&lt;K,V&gt; m)</span></span></span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ConcurrentHashMapï¼Œå®ƒä½¿ç”¨åˆ†æ®µé”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ é€šè¿‡å‰ä¸¤ç§æ–¹å¼è·å¾—çš„çº¿ç¨‹å®‰å…¨çš„HashMapåœ¨è¯»å†™æ•°æ®çš„æ—¶å€™ä¼šå¯¹æ•´ä¸ªå®¹å™¨ä¸Šé”ï¼Œè€ŒConcurrentHashMapå¹¶ä¸éœ€è¦å¯¹æ•´ä¸ªå®¹å™¨ä¸Šé”ï¼Œå®ƒåªéœ€è¦é”ä½è¦ä¿®æ”¹çš„éƒ¨åˆ†å°±è¡Œäº†ã€‚ CHMå¼•å…¥äº†åˆ†å‰²ï¼Œå¹¶æä¾›äº†HashTableæ”¯æŒçš„æ‰€æœ‰çš„åŠŸèƒ½ã€‚åœ¨CHMä¸­ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¯¹Mapåšè¯»æ“ä½œï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•çš„<a href="http://javarevisited.blogspot.com/2012/02/what-is-blocking-methods-in-java-and.html" target="_blank" rel="noopener">blocking</a>ã€‚è¿™å¾—ç›ŠäºCHMå°†Mapåˆ†å‰²æˆäº†ä¸åŒçš„éƒ¨åˆ†ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶åªé”ä½ä¸€éƒ¨åˆ†ã€‚æ ¹æ®é»˜è®¤çš„å¹¶å‘çº§åˆ«(<code>concurrency level</code>)ï¼ŒMapè¢«åˆ†å‰²æˆ16ä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”ç”±ä¸åŒçš„é”æ§åˆ¶ã€‚è¿™æ„å‘³ç€ï¼ŒåŒæ—¶æœ€å¤šå¯ä»¥æœ‰16ä¸ªå†™çº¿ç¨‹æ“ä½œMapã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œç”±åªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥å˜æˆåŒæ—¶å¯ç”±16ä¸ªå†™çº¿ç¨‹åŒæ—¶è¿›å…¥(è¯»çº¿ç¨‹å‡ ä¹ä¸å—é™åˆ¶)ï¼Œæ€§èƒ½çš„æå‡æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†ç”±äºä¸€äº›æ›´æ–°æ“ä½œï¼Œå¦‚put(),remove(),putAll(),clear()åªé”ä½æ“ä½œçš„éƒ¨åˆ†ï¼Œæ‰€ä»¥åœ¨æ£€ç´¢æ“ä½œä¸èƒ½ä¿è¯è¿”å›çš„æ˜¯æœ€æ–°çš„ç»“æœã€‚ å¦ä¸€ä¸ªé‡è¦ç‚¹æ˜¯åœ¨è¿­ä»£éå†CHMæ—¶ï¼ŒkeySetè¿”å›çš„iteratoræ˜¯å¼±ä¸€è‡´å’Œ<a href="http://javarevisited.blogspot.in/2012/02/fail-safe-vs-fail-fast-iterator-in-java.html" target="_blank" rel="noopener">fail-safe</a>çš„ï¼Œå¯èƒ½ä¸ä¼šè¿”å›æŸäº›æœ€è¿‘çš„æ”¹å˜ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå·²ç»éå†çš„æ•°ç»„ä¸Šçš„å†…å®¹å˜åŒ–äº†ï¼Œä¸ä¼šæŠ›å‡ºConcurrentModificationExceptoinçš„å¼‚å¸¸ã€‚ CHMé»˜è®¤çš„å¹¶å‘çº§åˆ«æ˜¯16ï¼Œä½†å¯ä»¥åœ¨åˆ›å»ºCHMæ—¶é€šè¿‡æ„é€ å‡½æ•°æ”¹å˜ã€‚æ¯«æ— ç–‘é—®ï¼Œå¹¶å‘çº§åˆ«ä»£è¡¨ç€å¹¶å‘æ‰§è¡Œæ›´æ–°æ“ä½œçš„æ•°ç›®ï¼Œæ‰€ä»¥å¦‚æœåªæœ‰å¾ˆå°‘çš„çº¿ç¨‹ä¼šæ›´æ–°Mapï¼Œé‚£ä¹ˆå»ºè®®è®¾ç½®ä¸€ä¸ªä½çš„å¹¶å‘çº§åˆ«ã€‚å¦å¤–ï¼ŒCHMè¿˜ä½¿ç”¨äº†ReentrantLockæ¥å¯¹segmentsåŠ é”ã€‚</p></li></ol><h3 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap</h3><p>CHMé€‚ç”¨äºè¯»è€…æ•°é‡è¶…è¿‡å†™è€…æ—¶ï¼Œå½“å†™è€…æ•°é‡å¤§äºç­‰äºè¯»è€…æ—¶ï¼ŒCHMçš„æ€§èƒ½æ˜¯ä½äºHashtableå’Œsynchronized Mapçš„ã€‚è¿™æ˜¯å› ä¸ºå½“é”ä½äº†æ•´ä¸ªMapæ—¶ï¼Œè¯»æ“ä½œè¦ç­‰å¾…å¯¹åŒä¸€éƒ¨åˆ†æ‰§è¡Œå†™æ“ä½œçš„çº¿ç¨‹ç»“æŸã€‚CHMé€‚ç”¨äºåšcache,åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œä¹‹åå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚çº¿ç¨‹è®¿é—®ã€‚æ­£å¦‚Javadocè¯´æ˜çš„é‚£æ ·ï¼ŒCHMæ˜¯HashTableä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£ï¼Œä½†è¦è®°ä½ï¼ŒCHMçš„æ¯”HashTableçš„åŒæ­¥æ€§ç¨å¼±ã€‚</p><ul><li>CHMå…è®¸å¹¶å‘çš„è¯»å’Œçº¿ç¨‹å®‰å…¨çš„æ›´æ–°æ“ä½œ</li><li>åœ¨æ‰§è¡Œå†™æ“ä½œæ—¶ï¼ŒCHMåªé”ä½éƒ¨åˆ†çš„Map</li><li>å¹¶å‘çš„æ›´æ–°æ˜¯é€šè¿‡å†…éƒ¨æ ¹æ®å¹¶å‘çº§åˆ«å°†Mapåˆ†å‰²æˆå°éƒ¨åˆ†å®ç°çš„</li><li>é«˜çš„å¹¶å‘çº§åˆ«ä¼šé€ æˆæ—¶é—´å’Œç©ºé—´çš„æµªè´¹ï¼Œä½çš„å¹¶å‘çº§åˆ«åœ¨å†™çº¿ç¨‹å¤šæ—¶ä¼šå¼•èµ·çº¿ç¨‹é—´çš„ç«äº‰</li><li>CHMçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨</li><li>CHMè¿”å›çš„è¿­ä»£å™¨æ˜¯å¼±ä¸€è‡´æ€§ï¼Œfail-safeå¹¶ä¸”ä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸</li><li>CHMä¸å…è®¸nullçš„é”®å€¼</li><li>å¯ä»¥ä½¿ç”¨CHMä»£æ›¿HashTableï¼Œä½†è¦è®°ä½CHMä¸ä¼šé”ä½æ•´ä¸ªMap</li></ul><p>å‚è€ƒï¼š<a href="http://www.importnew.com/21388.html" target="_blank" rel="noopener">http://www.importnew.com/21388.html</a> <a href="http://www.importnew.com/21388.html" target="_blank" rel="noopener">http://www.importnew.com/21388.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HashMapæ˜¯ä¸€ç§ç»“æ„éå¸¸å·§å¦™çš„é›†åˆå®¹å™¨ã€‚HashMapæ˜¯å­˜å‚¨é”®å€¼å¯¹çš„ç»“æ„ï¼Œkeyå’Œvalueä¸€ä¸€å¯¹åº”ï¼Œkeyå¿…é¡»ä¿è¯å”¯ä¸€ï¼Œå­˜å‚¨æ— åºï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œè¿™æ˜¯å®ƒçš„ä¸€äº›åŸºæœ¬ç‰¹ç‚¹ã€‚åœ¨javaä¸­ï¼Œæœ€åŸºæœ¬çš„ç»“æ„å°±æ˜¯ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æ¨¡æ‹ŸæŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰ï¼Œæ‰€æœ‰çš„æ•°æ®ç»“æ„éƒ½å¯ä»¥ç”¨è¿™ä¸¤ä¸ªåŸºæœ¬ç»“æ„æ¥æ„é€ çš„ï¼Œhashmapä¹Ÿä¸ä¾‹å¤–ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="HashMap" scheme="https://www.elietio.xyz/tags/HashMap/"/>
    
  </entry>
  
  <entry>
    <title>Java Webâ€”â€”Servletå¼€å‘å…¥é—¨</title>
    <link href="https://www.elietio.xyz/posts/3d37fb53.html"/>
    <id>https://www.elietio.xyz/posts/3d37fb53.html</id>
    <published>2017-08-11T08:07:18.000Z</published>
    <updated>2020-06-13T08:18:25.215Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="Servletæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Servletæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Servletæ˜¯ä»€ä¹ˆï¼Ÿ"></a>Servletæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Servletï¼ŒServer Applet,æ˜¯ä¸€ä¸ªJavaç¼–å†™çš„å°ç¨‹åºï¼Œå¯ä»¥åœ¨WebæœåŠ¡å™¨ä¸Šè¿è¡Œï¼ˆå¦‚Tomcatï¼‰ï¼Œå®ƒé€šè¿‡HTTPåè®®æ¥å—å’Œå“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚å®¢æˆ·ç«¯å‘é€è¯·æ±‚ç»™WebæœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†è¯·æ±‚ä¿¡æ¯å‘é€ç»™Servletï¼ŒServletç”Ÿæˆå“åº”ï¼Œä¼ é€’ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å†å“åº”è‡³å®¢æˆ·ç«¯ã€‚Servletåœ¨Javaä¸­æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç”¨äºå®šä¹‰è§„åˆ™å’Œæ‹“å±•åŠŸèƒ½ã€‚<br><a id="more"></a></p><h3 id="Servletç”Ÿå‘½å‘¨æœŸ"><a href="#Servletç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Servletç”Ÿå‘½å‘¨æœŸ"></a>Servletç”Ÿå‘½å‘¨æœŸ</h3><ol><li><p>åˆå§‹åŒ–init<br>å®¢æˆ·ç«¯å‘é€è¯·æ±‚è®¿é—®servletç¨‹åºï¼ŒTomcatä¼šåœ¨å†…å­˜ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨è¯¥servletçš„å¯¹è±¡ï¼Œå¦‚ä¸å­˜åœ¨ï¼Œåˆ™è°ƒç”¨initæ–¹æ³•åˆ›å»ºservletå¯¹è±¡ï¼Œå¦‚å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ã€‚</p></li><li><p>è¿è¡Œservice<br>Tomcatä¸ºè¯·æ±‚åˆ›å»ºServletRequestå¯¹è±¡å’ŒServletResponseå¯¹è±¡ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡serviceæ–¹æ³•éƒ½ä»ServletRequestä¸­è·å–è¯·æ±‚å‚æ•°ï¼Œé€šè¿‡ServletResponseå‘é€å“åº”ç»™å®¢æˆ·ç«¯ã€‚</p></li><li><p>é”€æ¯destory<br>å½“æœåŠ¡å™¨å…³é—­æˆ–è€…Webé¡¹ç›®ç§»é™¤æ—¶ï¼Œservletä¼šå…³é—­ï¼ŒTomatè°ƒç”¨servletçš„destoryæ–¹æ³•è¿›è¡Œé”€æ¯ï¼Œé‡Šæ”¾èµ„æºã€‚</p></li></ol><h3 id="HttpServlet"><a href="#HttpServlet" class="headerlink" title="HttpServlet"></a>HttpServlet</h3><p>Servletæ˜¯ä¸€ä¸ªæ— åè®®çš„æ¥å£ï¼Œå®šä¹‰äº†æœåŠ¡å™¨å’Œjavaç¨‹åºä¹‹é—´è§„åˆ™ã€‚HttpServletæ˜¯å®ƒçš„ä¸€ä¸ªå­ç±»ï¼Œå…·æœ‰Httpåè®®ï¼Œå®ƒçš„serviceæ–¹æ³•ä¼šå¯¹è¯·æ±‚åˆ¤æ–­æ˜¯æ‰§è¡ŒdoGetæ–¹æ³•è¿˜æ˜¯doPostæ–¹æ³•ï¼Œå› æ­¤ä¹¦å†™Servletç¨‹åºéœ€è¦ç»§æ‰¿HttpServletç±»ï¼Œå¹¶å¤å†™doGetæ–¹æ³•å’ŒdoPostæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> $&#123;enclosing_package&#125;;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> $</span>&#123;primary\_type\_name&#125; extends HttpServlet &#123;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="web-xmlé…ç½®Servlet"><a href="#web-xmlé…ç½®Servlet" class="headerlink" title="web.xmlé…ç½®Servlet"></a>web.xmlé…ç½®Servlet</h3><p>é€šè¿‡web.xmlé…ç½®ï¼Œè®©urlè·¯å¾„è®¿é—®å¯¹åº”çš„servletç¨‹åº</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servletåç§°<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servletç¨‹åºçš„ç»å¯¹è·¯å¾„<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servletåç§°ï¼Œä¸ä¸Šé¢ä¿æŒä¸€è‡´å»ºç«‹æ˜ å°„<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>è®¿é—®è·¯å¾„ï¼Œæ ¼å¼ä¸º"/å…·ä½“å†…å®¹"ï¼Œè¡¨ç¤ºçš„URLä¸ºlocalhost:8080/webé¡¹ç›®å/å…·ä½“å†…å®¹<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„"><a href="#ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„" class="headerlink" title="ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„"></a>ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„</h3><ol><li><p>å®¢æˆ·ç«¯çš„è·¯å¾„ï¼Œæ¯”å¦‚åˆ©ç”¨é¡µé¢è®¿é—®ï¼Œä¸€èˆ¬ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œåé¢åŠ ä¸Šé¡¹ç›®åç§°<br>/:æŒ‡çš„çš„æ˜¯ç»å¯¹è·¯å¾„ï¼Œè¡¨ç¤ºhttpï¼š//ip:port<br>ä¸å¸¦/è¡¨ç¤ºç›¸å¯¹è·¯å¾„ï¼Œè¡¨ç¤ºå½“å‰æ–‡ä»¶æ‰€åœ¨çš„çˆ¶ç›®å½•çš„è·¯å¾„</p></li><li><p>æœåŠ¡ç«¯è·¯å¾„ï¼Œæ¯”å¦‚web.xml<br>/,ç»å¯¹è·¯å¾„ï¼Œä»£è¡¨httpï¼š/ip:port/é¡¹ç›®åç§°</p></li></ol><h3 id="ServletConfig"><a href="#ServletConfig" class="headerlink" title="ServletConfig"></a>ServletConfig</h3><p>åœ¨å¼€å‘ä¸­ï¼Œservletåˆ›å»ºæœ‰æ—¶éœ€è¦ç»™å®šä¸€äº›åˆå§‹åŒ–å‚æ•°ï¼ŒwebæœåŠ¡å™¨ä¼šæŠŠè¿™äº›åˆå§‹åŒ–ä¿¡æ¯å°è£…åˆ°ServletConfigä¸­ï¼Œåˆ›å»ºservletæ—¶è°ƒç”¨çš„initæ–¹æ³•æ—¶ï¼Œä¼šå°†åˆå§‹åŒ–ä¿¡æ¯ä¼ é€’ç»™servletï¼Œå› æ­¤å¯ä»¥çœ‹ä½œwebç¨‹åºçš„å±€éƒ¨é…ç½®ã€‚</p><p>åˆå§‹åŒ–ä¿¡æ¯åœ¨web.xmlä¸­çš„servletæ ‡ç­¾ä¸­ï¼Œä»¥keyå’Œvalueçš„å½¢å¼è®¾ç½®ã€‚è·å–åˆå§‹åŒ–ä¿¡æ¯é€šè¿‡API getInitParameter(String name) æ ¹æ®keyè·å–valueå’Œ getInitParameterNames() è¿”å›æ‰€æœ‰keyçš„æšä¸¾</p><h3 id="ServletContext"><a href="#ServletContext" class="headerlink" title="ServletContext"></a>ServletContext</h3><p>æ¯ä¸€ä¸ªwebé¡¹ç›®éƒ½æ˜¯è¿è¡Œåœ¨javaè™šæ‹Ÿæœºä¸­çš„ä¸€ä¸ªwebç¨‹åºï¼Œå®ƒæ‹¥æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå³ServletContextï¼Œå®ƒå¯ä»¥æä¾›webç¨‹åºä¸­æ‰€æœ‰servletå…±äº«çš„ä¿¡æ¯ï¼Œå³webç¨‹åºçš„å…¨å±€é…ç½®ã€‚</p><ol><li>ServletContextçš„è®¾ç½®æ˜¯åœ¨web.xmlçš„æ ¹ç›®å½•ä¸­,æƒ³è¦è·å–é…ç½®ä¿¡æ¯éœ€è¦å…ˆè·å–ServletContextå¯¹è±¡ã€‚è·å–ServeltContextå¯ä»¥é€šè¿‡ServletConfigä¸­çš„getServetContext()è·å–ï¼Œæˆ–è€…é€šè¿‡ç»§æ‰¿çš„GenericServletä¸­çš„getServletContext()æ–¹æ³•ç›´æ¥è·å–.ç„¶åé€šè¿‡ServetContextä¸­çš„getInitParameterNames()æˆ–getInitParameterNames()è·å–å…¨å±€é…ç½®ä¿¡æ¯.</li><li>ServletContextå¯ä»¥çœ‹ä½œwebç¨‹åºçš„ä¸€ä¸ªå…¬å…±å®¹å™¨ï¼Œä¸€ä¸ªwebç¨‹åºæ‰€æœ‰servletéƒ½å¯ä»¥è·å–å…¶ä¸­çš„æ•°æ®ã€‚<br> å¢åŠ ï¼šsetAttribute(String name,Object object)<br> åˆ é™¤ï¼šremoveAttribute(String name<br> è·å–ï¼šgetAttribute(String name)</li><li>ServeltContextè¯»å–æ–‡ä»¶è·¯å¾„<br> getRealPath(String path)    è¿”å›çš„æ˜¯ç»å¯¹è·¯å¾„ï¼Œå·¥ç¨‹å‘å¸ƒåï¼Œåœ¨ç”µè„‘ä¸­çš„çš„å®é™…è·¯å¾„<br> getContextPath()        è·å–é¡¹ç›®çš„ç›¸å¯¹è·¯å¾„</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Servletæ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a href=&quot;#Servletæ˜¯ä»€ä¹ˆï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;Servletæ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;/a&gt;Servletæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;&lt;p&gt;Servletï¼ŒServer Applet,æ˜¯ä¸€ä¸ªJavaç¼–å†™çš„å°ç¨‹åºï¼Œå¯ä»¥åœ¨WebæœåŠ¡å™¨ä¸Šè¿è¡Œï¼ˆå¦‚Tomcatï¼‰ï¼Œå®ƒé€šè¿‡HTTPåè®®æ¥å—å’Œå“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚å®¢æˆ·ç«¯å‘é€è¯·æ±‚ç»™WebæœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†è¯·æ±‚ä¿¡æ¯å‘é€ç»™Servletï¼ŒServletç”Ÿæˆå“åº”ï¼Œä¼ é€’ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å†å“åº”è‡³å®¢æˆ·ç«¯ã€‚Servletåœ¨Javaä¸­æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç”¨äºå®šä¹‰è§„åˆ™å’Œæ‹“å±•åŠŸèƒ½ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="servet" scheme="https://www.elietio.xyz/tags/servet/"/>
    
  </entry>
  
  <entry>
    <title>JAVAå•ä¾‹æ¨¡å¼çš„ä¸ƒç§å†™æ³•</title>
    <link href="https://www.elietio.xyz/posts/7a9cc514.html"/>
    <id>https://www.elietio.xyz/posts/7a9cc514.html</id>
    <published>2017-06-25T16:29:32.000Z</published>
    <updated>2020-06-13T08:18:25.215Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>JAVAå•ä¾‹æ¨¡å¼çš„ä¸ƒç§å†™æ³•<br><a id="more"></a></p><ul><li>ç¬¬ä¸€ç§ï¼ˆæ‡’æ±‰ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123; </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125; </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line"><span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;  </span><br><span class="line">    instance = <span class="keyword">new</span> Singleton();  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">return</span> instance;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‡’åŠ è½½ï¼Œä½†æ˜¯å¤šçº¿ç¨‹å•ä¾‹ä¼šå¤±è´¥ã€‚</p><ul><li>ç¬¬äºŒç§ï¼ˆæ‡’æ±‰ï¼Œçº¿ç¨‹å®‰å…¨ï¼‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;  </span><br><span class="line">        instance = <span class="keyword">new</span> Singleton();  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡ä½ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¸éœ€è¦åŒæ­¥ã€‚</p><ul><li>ç¬¬ä¸‰ç§ï¼ˆé¥¿æ±‰ï¼‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¿å…äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†æ˜¯instanceåœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å®ä¾‹åŒ–äº†ï¼Œä¸èƒ½è¾¾åˆ°æ‡’åŠ è½½çš„æ•ˆæœã€‚</p><ul><li>ç¬¬å››ç§ï¼ˆé¥¿æ±‰ï¼Œå˜ç§ï¼‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> Singleton instance = <span class="keyword">null</span>;  </span><br><span class="line">    <span class="keyword">static</span> &#123;  </span><br><span class="line">    instance = <span class="keyword">new</span> Singleton();  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œç¬¬ä¸‰ç§å®é™…ä¸Šå·®ä¸å¤šã€‚ç±»åˆå§‹åŒ–çš„æ—¶å€™å®ä¾‹äº†instance</p><ul><li>ç¬¬äº”ç§ï¼ˆé™æ€å†…éƒ¨ç±»ï¼‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> SingletonHolder.INSTANCE;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼åŒæ ·åˆ©ç”¨äº†classloderçš„æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–instanceæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒè·Ÿç¬¬ä¸‰ç§å’Œç¬¬å››ç§æ–¹å¼ä¸åŒçš„æ˜¯ï¼šç¬¬ä¸‰ç§å’Œç¬¬å››ç§æ–¹å¼æ˜¯åªè¦Singletonç±»è¢«è£…è½½äº†ï¼Œé‚£ä¹ˆinstanceå°±ä¼šè¢«å®ä¾‹åŒ–ï¼ˆæ²¡æœ‰è¾¾åˆ°lazy loadingæ•ˆæœï¼‰ï¼Œè€Œè¿™ç§æ–¹å¼æ˜¯Singletonç±»è¢«è£…è½½äº†ï¼Œinstanceä¸ä¸€å®šè¢«åˆå§‹åŒ–ã€‚å› ä¸ºSingletonHolderç±»æ²¡æœ‰è¢«ä¸»åŠ¨ä½¿ç”¨ï¼Œåªæœ‰æ˜¾ç¤ºé€šè¿‡è°ƒç”¨getInstanceæ–¹æ³•æ—¶ï¼Œæ‰ä¼šæ˜¾ç¤ºè£…è½½SingletonHolderç±»ï¼Œä»è€Œå®ä¾‹åŒ–instanceã€‚</p><p>é™æ€å†…éƒ¨ç±»å’Œéé™æ€å†…éƒ¨ç±»ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨è¢«è°ƒç”¨æ—¶æ‰ä¼šè¢«åŠ è½½ã€‚å½“åªè°ƒç”¨å¤–éƒ¨ç±»çš„é™æ€å˜é‡ï¼Œé™æ€æ–¹æ³•æ—¶ï¼Œæ˜¯ä¸ä¼šè®©é™æ€å†…éƒ¨ç±»çš„è¢«åŠ è½½ã€‚</p><p>ä¸è¿‡åœ¨åŠ è½½é™æ€å†…éƒ¨ç±»çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šåŠ è½½å¤–éƒ¨ç±»ã€‚</p><ul><li>ç¬¬å…­ç§ï¼ˆæšä¸¾ï¼‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Singleton &#123;  </span><br><span class="line">    INSTANCE;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whateverMethod</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œjdk1.5ä»¥ä¸Šæ”¯æŒ</p><ul><li>ç¬¬ä¸ƒç§ï¼ˆåŒé‡æ ¡éªŒé”ï¼‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton singleton;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;  </span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">            singleton = <span class="keyword">new</span> Singleton();  </span><br><span class="line">        &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> singleton;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> åªé”å®šsingleton==nullçš„æƒ…å†µï¼Œä¸€æ—¦å®ä¾‹åŒ–åå°±ä¸å†åŒæ­¥ã€‚ä½†æ˜¯åœ¨singleton=new Singleton();è¿™ä¸€æ­¥jvmæ‰§è¡Œæ˜¯æ— åºçš„ï¼Œå¯èƒ½å…ˆè®¾ç½®äº†singletonä¸ºéç©ºï¼Œå†æ„é€ äº†Singletonï¼Œè‹¥æ­¤æ—¶å…¶å®ƒçº¿ç¨‹è¿›å…¥äº†åˆ¤æ–­ï¼Œsingletonï¼=nullï¼Œè¿”å›çš„singletonå¹¶ä¸æ˜¯Singletonçš„å®ä¾‹ã€‚ </p><p>åœ¨è¿™é‡Œç”¨åˆ°äº†volatileå…³é”®å­—ï¼Œä¸€æ—¦ä¸€ä¸ªå…±äº«å˜é‡ï¼ˆç±»çš„æˆå‘˜å˜é‡ã€ç±»çš„é™æ€æˆå‘˜å˜é‡ï¼‰è¢«volatileä¿®é¥°ä¹‹åï¼Œé‚£ä¹ˆå°±å…·å¤‡äº†ä¸¤å±‚è¯­ä¹‰ï¼š</p><ul><li>ä¿è¯äº†ä¸åŒçº¿ç¨‹å¯¹è¿™ä¸ªå˜é‡è¿›è¡Œæ“ä½œæ—¶çš„å¯è§æ€§ï¼Œå³ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†æŸä¸ªå˜é‡çš„å€¼ï¼Œè¿™æ–°å€¼å¯¹å…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯ç«‹å³å¯è§çš„ã€‚</li><li>ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;JAVAå•ä¾‹æ¨¡å¼çš„ä¸ƒç§å†™æ³•&lt;br&gt;
    
    </summary>
    
      <category term="Java" scheme="https://www.elietio.xyz/categories/Java/"/>
    
    
      <category term="Java" scheme="https://www.elietio.xyz/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>ç›˜ç‚¹æˆ‘çš„2016ç”µå­äº§å“æ¶ˆè´¹</title>
    <link href="https://www.elietio.xyz/posts/ba9462e4.html"/>
    <id>https://www.elietio.xyz/posts/ba9462e4.html</id>
    <published>2016-12-31T09:52:26.000Z</published>
    <updated>2020-06-13T08:18:25.215Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>2016å¹´12æœˆ31ï¼Œæ¯•ä¸šå·²ç»ä¸€å¹´åŠã€‚æˆ‘ç®—æ˜¯ä¸ªå–œæ¬¢æ£é¼“ç”µå­äº§å“çš„äººï¼Œå¤§å­¦çš„æ—¶å€™æ˜¯ä¸ªç©·å­¦ç”Ÿï¼Œå›Šè‚¿ç¾æ¶©ï¼Œå¾ˆå¤šå–œæ¬¢çš„ç”µå­äº§å“åªèƒ½ç½‘ä¸Šçœ‹çœ‹æ­¢æ¸´ï¼Œç° åœ¨å·¥ä½œä¸€å¹´å¤šï¼Œä¹Ÿç®—æ˜¯æœ‰äº†ä¸€ç‚¹ç‚¹ç»æµæ”¶å…¥ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹è‡ªå·±é’Ÿæƒ…å·²ä¹…çš„ä¸€äº›å°ç©æ„ï¼Œåœ¨2016å¹´çš„æœ€åä¸€å¹´ï¼Œç›˜ç‚¹ä¸€ä¸‹è¿™ä¸€å¹´å‰æ‰‹çš„ç”µå­äº§å“ã€‚<br><a id="more"></a></p><h2 id="2016å¹´å‰æ‰‹äº§å“"><a href="#2016å¹´å‰æ‰‹äº§å“" class="headerlink" title="2016å¹´å‰æ‰‹äº§å“"></a>2016å¹´å‰æ‰‹äº§å“</h2><h3 id="1-NOKIA-N1"><a href="#1-NOKIA-N1" class="headerlink" title="1.NOKIA N1"></a>1.<a href="https://item.jd.com/1860108.html" target="_blank" rel="noopener">NOKIA N1</a></h3><p><img src="http://wx3.sinaimg.cn/mw690/8bf96619gy1fgz2g6dhn7j20b40b475x.jpg" alt>   </p><p>è¯º åŸºäºšï¼ˆNokiaï¼‰N1å¹³æ¿, 7.9è‹±å¯¸ ç«å±±ç°,å¹´åˆ3æœˆè´­äºäº¬ä¸œã€‚æˆ‘ä»¬è¿™ä¸ªå¹´é¾„çš„å¹´è½»äººä»¬éƒ½æ˜¯ç»å†äº†è¯ºåŸºäºšçš„æ—¶ä»£è¿‡æ¥çš„ï¼Œå¤šå¤šå°‘å°‘å¯¹è¯ºåŸºäºšéƒ½æœ‰ä¸€ä»½æƒ…æ€€ï¼Œæˆ‘ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¯æƒœè¿™ä¸ªå¹³æ¿åªæ˜¯è´´äº†è¯ºåŸº äºšçš„ç‰Œè€Œå·²ï¼Œå®é™…ä¸Šç”±å¯Œå£«åº·ç”Ÿäº§ï¼Œä¸è¿‡å…¶ç´ è´¨è¿˜ç®—å¯åœˆå¯ç‚¹ã€‚2Kçš„åˆ†è¾¨ç‡ã€7.9è‹±å¯¸å…¨é‡‘å±æœºèº«ï¼Œè™½ç„¶ä¸æ”¯æŒæ‰©å±•å­˜å‚¨ï¼Œä½†æ˜¯æœºèº«å­˜å‚¨32Gä¹Ÿç®—å¤Ÿç”¨ï¼Œä¸»è¦ æ˜¯ä»·æ ¼è¶³å¤Ÿå¸å¼•äººã€‚ç®—èµ·æ¥å®ƒçš„çŸ­æ¿ä¹Ÿä¸å°‘ï¼Œé…ç½®æ¸£æ¸£ï¼Œç³»ç»Ÿä¸‡å¹´5.0ï¼Œ4ï¼š3çš„æ¯”ä¾‹çœ‹èµ·è§†é¢‘æ¥é»‘è¾¹å®åœ¨ç¢çœ¼ï¼Œå¥½åœ¨é¢œå€¼ä¸ä½ï¼Œè€Œä¸”æˆ‘çš„éœ€æ±‚ä¹Ÿåªæ˜¯ç”¨æ¥çœ‹æ¼«ç”» å’ŒPDF,è¿™ä¸¤ç‚¹å¯ä»¥è¯´æ˜¯ç›¸å½“ä»¤æˆ‘æ»¡æ„ã€‚2Kçš„åˆ†è¾¨ç‡ç›¸å½“ç»†è…»ï¼Œé…åˆPerfect Viewerçœ‹çœ‹æ¼«ç”»ï¼Œçœ‹çœ‹PDFæ–‡æ¡£ï¼Œå½“ç„¶è¿˜æœ‰å®‰å“ç¥å™¨EhViewerï¼Œç©æ¸¸æˆæ—¶å€™æŸ¥æŸ¥æ”»ç•¥ï¼Œä¸è¿‡ä»Šå¹´åŠ ç­ä¸€ç›´æ¯”è¾ƒå¤šï¼Œå¯¼è‡´N1åƒç°çš„æ—¶é—´ä¹Ÿä¸å°‘ã€‚</p><h3 id="2-AOC-P2491VWHE"><a href="#2-AOC-P2491VWHE" class="headerlink" title="2.AOC P2491VWHE"></a>2.<a href="https://item.jd.com/2168838.html" target="_blank" rel="noopener">AOC P2491VWHE</a></h3><p><img src="http://wx1.sinaimg.cn/mw690/8bf96619gy1fgz2g74deqj20e80aowhx.jpg" alt> </p><p>AOC P2491VWHE/BWï¼Œ 23.6è‹±å¯¸1.6mm PLSæ˜¾ç¤ºå™¨ï¼Œ4æœˆè´­äºäº¬ä¸œã€‚è¿™ä¸ªæ˜¯ä»Šå¹´æˆ‘æ„Ÿè§‰ä¹°çš„éå¸¸å€¼çš„ä¸œè¥¿äº†ï¼Œç»ˆäºä¸ç”¨å†å¿å—ç¬”è®°æœ¬é‚£æ¸£æ¸£çš„åˆ†è¾¨ç‡å’Œå°æ˜¾ç¤ºå±äº†ï¼Œçœ‹ç”µå½±åˆ·ç½‘é¡µï¼Œçˆ½çš„é£èµ·ï¼ŒçœŸæ˜¯æ—©å°± è¯¥æ’¸ä¸€ä¸ªçˆ½çˆ½äº†ã€‚è€Œå…¶æœ¬èº«æ€§ä»·æ¯”å’Œè´¨é‡ã€æ˜¾ç¤ºæ•ˆæœåªèƒ½è¯´ä¸€èˆ¬èˆ¬ï¼Œæ²¡æœ‰å†…ç½®éŸ³ç®±ï¼Œä¹Ÿæ²¡æœ‰éŸ³é¢‘è¾“å‡ºæ¥å£ï¼Œä¸è¿‡å¯¹äºä¹ æƒ¯äº†ç¬”è®°æœ¬åæ”¹ç”¨è¿™ä¸ªæ‰€å¸¦æ¥çš„æ„Ÿå®˜ä½“éªŒè¿˜æ˜¯ å¾ˆæ£’çš„ï¼Œè‡ªä»å…¥äº†è¿™ä¸ªï¼Œä¸‹ç”µå½±åŸºæœ¬éƒ½æ˜¯1080Päº†ï¼Œè¿™æ ·æ‰å¤Ÿçˆ½ã€‚</p><h3 id="3-ATH-IM50"><a href="#3-ATH-IM50" class="headerlink" title="3.ATH-IM50"></a>3.<a href="https://item.jd.com/1029008.html" target="_blank" rel="noopener">ATH-IM50</a></h3><p><a href="http://wx2.sinaimg.cn/large/8bf96619gy1fgz2g9j86zj20b40b4wgn.jpg" target="_blank" rel="noopener"><img src="http://ww2.sinaimg.cn/large/8bf96619gy1fgz2g9j86zj20b40b4wgn.jpg" alt></a> </p><p>é“ ä¸‰è§’ ATH-IM50 åŒåŠ¨åœˆå…¥è€³è€³æœºï¼Œäº¬ä¸œ618æ´»åŠ¨å…¥ï¼Œç”¨äº†å‡100åˆ¸328å…¥æ‰‹ã€‚åœ¨æ­¤ä¹‹å‰æˆ‘ä¸€ç›´å¾ˆæ’æ–¥å…¥è€³å¼è€³æœºï¼Œæˆ‘è€³è…”æ¯”è¾ƒå°ï¼Œå…¥è€³å¼çš„è€³æœºæ„Ÿè§‰å¸¦ç€å¾ˆä¸èˆ’æœï¼Œä½†æ˜¯å…¥äº† è¿™ä¸ªä¹‹åæ”¹å˜äº†æˆ‘å¯¹å…¥è€³å¼è€³æœºçš„çœ‹æ³•ï¼Œå¸¦ç€çœŸæ˜¯å¾ˆèˆ’æœï¼Œè€³æŒ‚å¼çš„è®¾è®¡ä¹Ÿå¾ˆå¥½ï¼Œè™½ç„¶åªæ˜¯å…¥é—¨çº§çš„äº§å“ï¼ŒåŒåŠ¨åœˆçš„ä½“éªŒå·²ç»è®©æˆ‘è¿™ä¸ªæœ¨è€³å…šæ„Ÿè§‰éå¸¸æƒŠè‰³äº†ï¼Œå…¥äº† è¿™ä¸ªä¹‹åï¼Œæ‰‹é‡Œçš„é“ä¸‰è§’SQ505ã€T400ã€æ½œ39_ã€_ä»¿314Pçš„èœ‚é¸Ÿæˆ‘åŸºæœ¬éƒ½æ²¡å†å¬è¿‡ã€‚ç”±äºæœ¨è€³ï¼Œå°±ä¸å¯¹ç„å­¦æ–¹é¢å‘è¡¨è¿‡å¤šè¯„ä»·äº†ï¼Œåæ­£æ•ˆæœçœŸçš„å¾ˆæ£’ï¼Œç”šè‡³åæ‚”å½“åˆä¸ºå•¥æ²¡é€‰IM70ï¼Œå½“åˆæ„Ÿè§‰ç¨è´µè€Œä¸”çº¢è‰²å®åœ¨å¤ªéªšéš¾ä»¥é©¾é©­ï¼Œç°åœ¨è§‰å¾—è¦æ˜¯å…¥äº†IM70åªä¼šæ›´çˆ½å•Šï¼Œåªèƒ½æš—ç¤ºè‡ªå·±åæ­£æˆ‘æ˜¯æœ¨è€³ï¼Œæ²¡å•¥åŒºåˆ«å–½ï¼</p><h3 id="4-å»ºå…´T9-128G-SSD"><a href="#4-å»ºå…´T9-128G-SSD" class="headerlink" title="4.å»ºå…´T9 128G SSD"></a>4.<a href="https://item.jd.com/2210087.html" target="_blank" rel="noopener">å»ºå…´T9 128G SSD</a></h3><p><img src="http://wx2.sinaimg.cn/large/8bf96619gy1fgz2g7f7yjj20e70aqgsa.jpg" alt> </p><p>å»º å…´(LITEON) ç¿é€Ÿç³»åˆ— T9 128G SATA3 å›ºæ€ç¡¬ç›˜ï¼Œä¸»æ§Marvell 88SS9187ï¼Œ eMLCé¢—ç²’ã€‚8æœˆè´­äºäº¬ä¸œï¼Œè‡ªå·±è£…äº†ç¬”è®°æœ¬ä¹‹ååˆå¸®åŒäº‹ä¹°äº†ä¸€å—æ¢ä¸Šã€‚å…¶å®æƒ³ä¸ŠSSDå¾ˆä¹…äº†ï¼Œä½†æ˜¯æ‡’ç™Œå‘ä½œä¸€ç›´æ‡’å¾—åŠ¨ï¼Œè€Œä¸”ç¬”è®°æœ¬æ€§èƒ½åˆå¤ªæ¸£ï¼Œæ„Ÿè§‰ä¸Šäº† æ•ˆæœä¹Ÿæ˜¯æ‰“æŠ˜æ‰£ï¼Œä½†æ˜¯è¶Šæ¥è¶Šå—ä¸äº†ç«ç‹é‚£é¾Ÿé€Ÿçš„å¯åŠ¨é€Ÿåº¦ï¼Œpotplayçœ‹äº†ç”µå½±è¿˜å¾—ç­‰äº†2Sï¼Œæ„Ÿè§‰éå¸¸ä¸çˆ½ï¼Œäºæ˜¯ä¸€æ€’æœæ–­ä¸Šäº†SSD,å»ºå…´è¿™ä¸ªç®—æ˜¯æœ€ä¾¿ å®œçš„ä¸€æ¬¾MLC SSDäº†ï¼Œæ€»ä½“æ¥è¯´è¿˜æ˜¯ä»¤äººæ»¡æ„çš„ï¼Œè™½ç„¶ç¬”è®°æœ¬è¿˜æ˜¯æ¸£æ¸£ï¼Œä½†æ˜¯å„ç§è½¯ä»¶å¯åŠ¨é€Ÿåº¦è¿˜æ˜¯å¤§å¤§å¾—åˆ°äº†æå‡ï¼Œæ— å¥ˆç¬”è®°æœ¬æ€§èƒ½æœ‰é™ï¼Œæ²¡æ³•å¼„å‡ ä¸ª3Aå¤§ä½œè¯»æ¡çˆ½ä¸€æŠŠ äº†ã€‚</p><h3 id="5-SONY-PS4"><a href="#5-SONY-PS4" class="headerlink" title="5.SONY PS4"></a>5.<a href="https://item.taobao.com/item.htm?spm=a1z09.2.0.0.s3I2fM&amp;id=36675389855&amp;_u=vuk25d4e8c0" target="_blank" rel="noopener">SONY PS4</a></h3><p><img src="http://wx3.sinaimg.cn/mw690/8bf96619gy1fgz2g84uyhj20e70aqn0x.jpg" alt><img src="http://wx1.sinaimg.cn/mw690/8bf96619gy1fgz2g908dlj20e70aqtdv.jpg" alt><img src="http://wx2.sinaimg.cn/large/8bf96619gy1fgz2g87n6yj20e70aq0yh.jpg" alt> </p><p>SONY PlayStation 4 æ¸¯ç‰ˆ 500G 1206å‹ï¼Œ9æœˆåœ¨æ·˜å® S1ç‰ˆä¸»çš„åº—é‡Œä¹°çš„ï¼Œç´¢å°¼å¤§æ³•å¥½ï¼æ€»ç®—æ˜¯å……å€¼äº†ä¿¡ä»°ï¼Œåœ†äº†ä¸€ä¸ªæ¢¦ã€‚å¿ƒåŠ¨PS4å¾ˆä¹…äº†ï¼Œå´ä¸€ç›´æ²¡ä¸‹å®šå†³å¿ƒä¹°ã€‚æœ€åˆæ˜¯æœ‰æ„PSVçš„ï¼Œå¤§å­¦PSVç©çš„é—ªè½¨ï¼Œä¸ºäº† ç©åˆ°ä¸‹ä¸€éƒ¨è½¨è¿¹ï¼Œè€ƒè™‘è¿‡PSV,ä½†æ˜¯æš´æ­»Vå®åœ¨æ˜¯æ²¡å¤ªå¤šæ¸¸æˆå¯ç©ï¼Œè€Œä¸”æ„Ÿè§‰Falcomä¹Ÿè¯¥ä¸ŠPS4ï¼Œä½†æ˜¯è½¨è¿¹çš„æ¶ˆæ¯ä¸€ç›´è¿Ÿè¿Ÿæœªå‡ºï¼Œä¸œäº¬è¿·åŸå’Œä¼Šè‹8ç›¸ç»§ å‘å”®ï¼Œè€Œä¸”éƒ½ä¼šç™»å½•PS4ï¼Œæ‰€ä»¥ä¸€ç›´åœ¨è§‚æœ›çŠ¶æ€ã€‚ä¸€ç›´åˆ°9æœˆï¼Œæ„Ÿè§‰é‚£æ®µæ—¶é—´å¿ƒåŠ›æ†”æ‚´ï¼Œæƒ³æ‰¾ä¸ªå‘æ³„å£ï¼Œå¤§åŠå¹´éƒ½æ²¡å†çœ‹åŠ¨ç”»äº†ï¼Œæ‰¾äº†å‡ éƒ¨ä¹Ÿæä¸èµ·å…´è¶£ï¼Œäºæ˜¯å†³ å®šå…¥å°PS4å……å€¼ä¿¡ä»°ï¼Œå½“æ—¶Slimå·²ç»æ³„æ¼,Proï¼Œä¸å¯¹é‚£ä¸ªæ—¶å€™ä»£å·è¿˜æ˜¯NEOçš„å„ç§è°£è¨€æ»¡å¤©é£ï¼Œslimçš„å¤–è§‚æ„Ÿè§‰æ²¡æœ‰è€ç‰ˆæ¼‚äº®ï¼Œäºæ˜¯ç›´æ¥å…¥äº†æ¸¯ç‰ˆ PS4ï¼Œç¬¬ä¸€ä¸ªå…¥æ‰‹çš„æ¸¸æˆæ˜¯ç¥ç§˜æµ·åŸŸ4ï¼Œä¹Ÿæ˜¯æ·˜å®ä¹°çš„å®ä½“ç‰ˆï¼Œå½“æ—¶çœŸçš„æ˜¯è¢«ç”»é¢å’Œæ¼”å‡ºç»™éœ‡æƒŠåˆ°äº†ï¼Œæ¸¸æˆå…¨ç¨‹çœŸçš„éå¸¸äº«å—ï¼Œå¦‚åŒæ¬£èµä¸€éƒ¨æ³¢æ¾œèµ·ä¼çš„æ•…äº‹ï¼Œè€Œ è¿™ä¸ªæ•…äº‹æ˜¯ç”±æˆ‘è‡ªå·±äº²è‡ªæ“æ§çš„ï¼ŒçœŸæ˜¯å¸¦æ¥äº†ä¸ä¸€æ ·ä½“éªŒï¼Œæˆ‘æ˜¯ä¸€ä¸ªåŠ¨ä½œæ¸¸æˆè‹¦æ‰‹ï¼Œä¹Ÿå°±åªèƒ½ç©ç©é¬¼æ³£å’Œæš—é»‘è¡€ç»Ÿè¿™äº›åŠ¨ä½œæ¸¸æˆï¼Œå¤§å¤šæ•°éƒ½æ˜¯åœ¨ç©RPGå’Œä¸€äº› ARPGï¼Œç¥æµ·4è®©æˆ‘æˆä¸ºäº†é¡½çš®ç‹—ç²‰ï¼Œäºæ˜¯åæ¥é™†é™†ç»­ç»­è¡¥äº†é¡½çš®è´­çš„ç¾å›½æœ«æ—¥ã€ç¥æµ·1ã€2ã€3,å¹¶ä¸”æ¥ä¸‹æ¥æœŸå¾…ç€ç¥æµ·4DLCå’Œç¾æœ«2ã€‚ä¸è¿‡PSNæ¸¸æˆä»· æ ¼å’ŒSteamæ¯”èµ·æ¥çœŸæ˜¯è´µäº†å¥½å¤šï¼Œè™½ç„¶å®ä½“ç‰ˆå¯ä»¥äºŒæ‰‹å›è¡€ï¼Œä½†æ˜¯å¾€å¾€æ•°å­—ç‰ˆæœ‰æ‰“æŠ˜æ´»åŠ¨ï¼Œè€Œä¸”æ”¶è—ç™–å‘ä½œå®åœ¨ä¸å¿å¿ƒå–äºŒæ‰‹ï¼Œæ‰€ä»¥ä¹°æ¸¸æˆåªèƒ½èµ¶ä¸Šæ‰“æŠ˜æˆ–è€…é å¸¸å¿ƒåŠ¨æ‰èˆå¾—å…¥æ‰‹ã€‚å‰é¢ä¹Ÿè¯´äº†ç¬”è®°æœ¬å¤ªæ¸£ï¼Œå¤§å­¦æ¯•ä¸šä¹‹ååŸºæœ¬å°±æ²¡ç©è¿‡å•¥å•æœºæ¸¸æˆäº†ï¼Œå…¥äº†PS4ä¹‹åæ€»ç®—é‡æ‹¾äº†èµ·æ¥ï¼Œä¸‹ç­ä¹‹åç©ä¼šæ¸¸æˆæ”¾æ¾ä¸€ä¸‹ï¼Œåˆ·åˆ·å¥–æ¯ä¹ æ­¤ä¸ç–²ï¼Œè¯·è®©æˆ‘é«˜å‘¼ä¸€å£°ï¼šç´¢å°¼å¤§æ³•å¥½å•Šï¼è€Œæ˜å¹´é—ªè½¨ä¸‰ä¹Ÿè¦å‘å”®ï¼ŒPS4ç‹¬å ï¼Œåªèƒ½å¯¹Vå…¬ä¸»è¯´ä¸€å£°å¯æƒœäº† </p><h3 id="6-The-Witcher-3-Game-of-the-Year-Edition-PS4"><a href="#6-The-Witcher-3-Game-of-the-Year-Edition-PS4" class="headerlink" title="6.The Witcher 3 Game of the Year Edition (PS4)"></a>6.<a href="https://www.amazon.co.uk/Witcher-Game-Year-PS4/dp/B01JYW2F1G/ref=sr_1_1?ie=UTF8&amp;qid=1480087688&amp;sr=8-1&amp;keywords=The+Witcher+3" target="_blank" rel="noopener">The Witcher 3 Game of the Year Edition (PS4)</a></h3><p><img src="http://wx4.sinaimg.cn/large/8bf96619gy1fgz2g5ppi6j20b60e8tgz.jpg" alt> </p><p>å·« å¸ˆä¸‰â€”ç‹‚çŒå¹´åº¦ç‰ˆã€‚ä¹‹æ‰€ä»¥æŠŠè¿™ä¸ªå•ç‹¬æ‹¿å‡ºæ¥è¯´ï¼Œæ˜¯å› ä¸ºè¿™ä¸ªæ¯”è¾ƒç‰¹æ®Šï¼Œæˆ‘çš„ç¬¬ä¸€æ¬¡æµ·æ·˜ï¼Œ11æœˆåº•è´­äºè‹±å›½äºšé©¬é€Šï¼Œç®—ä¸Šé‚®è´¹ä¸€å…±Â£19.87ï¼Œå‰å‰ååèŠ±äº†åŠ ä¸ªæœˆå¤šæ‰åˆ°æ‰‹ã€‚å¤§å­¦çš„æ—¶å€™å¿å—ç€20å¤šå¸§ç©äº†å·«å¸ˆäºŒï¼Œä¹…ä¹…éš¾ä»¥å¿˜æ€€ï¼Œåæ¥ç‹‚çŒå‘å”®ï¼Œå¥½è¯„å¦‚æ½®ï¼Œä½†æ˜¯æ²¡æœ‰è®¾å¤‡å¯ä»¥ä½“éªŒï¼Œå¿ƒç†ç—’ç—’ä¸å·²ï¼Œå…¥äº†PS4åç»ˆäºå¯ä»¥ å¼¥è¡¥ä¸€ä¸‹ã€‚æ­£å¥½é»‘äº”é‚£æ®µæ—¶é—´è‹±äºšå·«å¸ˆä¸‰ä¸€ç›´æ‰“æŠ˜ï¼Œè€Œä¸”è‡ªå¸¦ç¹ä½“ä¸­æ–‡ï¼Œä»·æ ¼ä¹Ÿå¤Ÿä¾¿å®œï¼Œæ¯”æ¸¯æœå½“æ—¶çš„æ´»åŠ¨6æŠ˜è¿˜è¦ä¾¿å®œå‡ åå—ï¼Œæ­£å¥½å‰æ®µæ—¶é—´ä¿¡ç”¨å¡ä¹Ÿç”³è¯·æˆåŠŸï¼Œ äºæ˜¯æœæ–­ä¸‹å•ã€‚ä¸å¾—ä¸è¯´æ—¶é—´çœŸçš„æŒºé•¿çš„ï¼Œä»è·å…°çš„é˜¿å§†æ–¯ç‰¹ä¸¹å‘è´§åˆ°æˆ‘è¿™å¤§éƒ‘å§†æ–¯ç‰¹ä¸¹ï¼ŒçœŸæ˜¯ç­‰äº†å¥½ä¹…ã€‚ä¸Šæ‰‹ä¹‹åæ„Ÿè§‰æ³¢å…°äººçœŸæ˜¯åšé“ï¼Œè¿™æ¸¸æˆç¡®å®å¯ä»¥ç§°å¾—ä¸Šæ˜¯ æ³¢å…°äººçš„éª„å‚²ï¼Œä¸å¤šè¯´äº†ï¼Œæ¥å±€æ˜†ç‰¹ç›˜å§ï¼</p><h3 id="7-å¸Œæ·-1Tç¬”è®°æœ¬ç¡¬ç›˜"><a href="#7-å¸Œæ·-1Tç¬”è®°æœ¬ç¡¬ç›˜" class="headerlink" title="7.å¸Œæ· 1Tç¬”è®°æœ¬ç¡¬ç›˜"></a>7.å¸Œæ· 1Tç¬”è®°æœ¬ç¡¬ç›˜</h3><p><img src="http://wx2.sinaimg.cn/large/8bf96619gy1fgz2g94rhgj208y06rdhz.jpg" alt> </p><p>å¸Œ æ·(SEAGATE)1T 5400è½¬128M SATA3 ç¬”è®°æœ¬ç¡¬ç›˜(ST1000LM035)ï¼Œè¿™ä¸ªæ²¡å•¥å¥½è¯´äº†ï¼Œç»™PS4æ¢çš„ã€‚ä¸€ç›´åœ¨è§‚æœ›æƒ³ä¹°ä¸ª1Tæˆ–è€…2Tçš„ç¡¬ç›˜ç»™PS4æ¢ä¸Šï¼Œç»“æœç¡¬ç›˜ä»·æ ¼æ¶¨çš„å¥½å‰å®³ï¼Œç¢°åˆ° åŒ12äº¬ä¸œæ€»ç®—èˆå¾—æ‰“æŠ˜ï¼Œäºæ˜¯å…¥äº†å—1Tçš„ã€‚ä¸å¾—ä¸è¯´ç°åœ¨è¿™PS4æ¸¸æˆçœŸæ˜¯è›®å¤§çš„ï¼Œå³ä½¿æ˜¯å®ä½“ç‰ˆä¹Ÿæ˜¯è¦æŠŠæ¸¸æˆæ‹·è´åˆ°æœºèº«é‡Œï¼Œå…‰ç›˜åªæ˜¯ä¸€ä¸ªéªŒè¯çš„ä½œç”¨ï¼Œç¥æµ· å›› 58Gã€GTA5 65G ã€å·«å¸ˆä¸‰ 48Gâ€¦â€¦æƒ³æƒ³å‡ å¹´å‰ç©çš„æ¸¸æˆï¼Œå˜åŒ–çœŸæ˜¯å¤§ã€‚</p><h2 id="2016å¹´æƒ³ä½“éªŒçš„äº§å“â€”â€”VRã€AR"><a href="#2016å¹´æƒ³ä½“éªŒçš„äº§å“â€”â€”VRã€AR" class="headerlink" title="2016å¹´æƒ³ä½“éªŒçš„äº§å“â€”â€”VRã€AR"></a>2016å¹´æƒ³ä½“éªŒçš„äº§å“â€”â€”VRã€AR</h2><p><img src="http://wx1.sinaimg.cn/large/8bf96619gy1fgz2g6js5nj20a506bmxu.jpg" alt> </p><p>VR åœ¨16å¹´ç‚’å¾—çœŸæ˜¯éå¸¸ç«çˆ†ï¼Œä½ç«¯å…¥é—¨çš„å„ç§ç›’å­ã€çœ¼é•œï¼Œä¸­é«˜ç«¯çš„ç´¢å°¼PlayStation VRã€HTC Viveã€Oculus Riftï¼Œä¼¼ä¹ä»¥å‰ç§‘å¹»ç”µå½±ä¸­çš„æŠ€æœ¯ä¸€ä¸‹å­èµ°åˆ°äº†æˆ‘ä»¬ç”Ÿæ´»ä¸­ï¼Œè‡³äºVRçš„å‰æ™¯å’Œå„å¤§å‚å•†äº§å“çš„ä¼˜åŠ£åœ¨è¿™é‡Œä¸åœ¨å¤šè¯´ï¼Œæˆ‘ä¸ªäººè€Œè¨€è¿˜æ˜¯å¾ˆå¸Œæœ›è¿™ä¸ªæŠ€æœ¯èƒ½å¤Ÿè‰¯å¥½ çš„å‘å±•ä¸‹å»ï¼Œæœ€ç»ˆèƒ½ç‚¹å‡ºè„‘åæ’ç®¡çš„é»‘ç§‘æŠ€ã€‚è™½ç„¶æŠ€æœ¯çš„ä¸æˆç†Ÿã€æ¸¸æˆçš„å•è°ƒä¸ç¼ºä¹ï¼Œå³ä½¿æ˜¯è¯„ä»·æœ€å¥½çš„PS VRä¹Ÿæ¸æ¸ä¸åœ¨å¸å¼•äººä»¬çš„çœ¼çƒï¼Œæˆ‘è¿˜æ˜¯å¯¹VRå……æ»¡ç€ä¿¡å¿ƒï¼ŒåŒç†å¾®è½¯çš„AR HoloLensä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¸Œæœ›17å¹´èƒ½æœ‰æœºä¼šäº²è‡ªä½“éªŒä¸€ä¸‹ã€‚</p><h2 id="2017å¹´æœŸå¾…äº§å“â€”â€”Nintendo-Switch"><a href="#2017å¹´æœŸå¾…äº§å“â€”â€”Nintendo-Switch" class="headerlink" title="2017å¹´æœŸå¾…äº§å“â€”â€”Nintendo Switch"></a>2017å¹´æœŸå¾…äº§å“â€”â€”Nintendo Switch</h2><p><img src="http://wx4.sinaimg.cn/large/8bf96619gy1fgz2g5xk6zj20ao0e80xb.jpg" alt> </p><p>ä¸ å¾—ä¸è¯´ï¼Œä»»å¤©å ‚çš„ SwitchçœŸæ˜¯è®©äººæ„Ÿè§‰åˆ°æƒŠè‰³ï¼ŒæŒæœºä¾¿æºä½†æ˜¯æ€§èƒ½ã€æ˜¾ç¤ºæ•ˆæœæœ‰é™ï¼Œä¸»æœºä½“éªŒæ•ˆæœå¥½ä½†æ˜¯ä¾¿æºæ€§æ‰“äº†å¤§å¤§çš„æŠ˜æ‰£ï¼Œè€ŒSwitchè®©äºŒè€…åˆäºŒä¸ºä¸€çš„è®¾è®¡å¯ä»¥è¯´ æ˜¯ç©å®¶ä¸€ç›´ä»¥æ¥çš„ä¸€ä¸ªæ¢¦æƒ³ã€‚è™½ç„¶ç°åœ¨å·²ç»æ›å…‰äº†å¾ˆå¤šä¿¡æ¯ï¼Œè‡³äºåˆ°åº•å…¶å®é™…ä½“éªŒæ•ˆæœä¼šå¦‚ä½•ï¼Œè¿˜æ˜¯æœŸå¾…æ˜å¹´3æœˆçš„å‘å¸ƒä¼šï¼Œå¸Œæœ›ä»»å¤©å ‚èƒ½å¸¦æ¥æƒŠå–œï¼Œå†åˆ›ä¸€ä¸ªä¼  å¥‡ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2016å¹´12æœˆ31ï¼Œæ¯•ä¸šå·²ç»ä¸€å¹´åŠã€‚æˆ‘ç®—æ˜¯ä¸ªå–œæ¬¢æ£é¼“ç”µå­äº§å“çš„äººï¼Œå¤§å­¦çš„æ—¶å€™æ˜¯ä¸ªç©·å­¦ç”Ÿï¼Œå›Šè‚¿ç¾æ¶©ï¼Œå¾ˆå¤šå–œæ¬¢çš„ç”µå­äº§å“åªèƒ½ç½‘ä¸Šçœ‹çœ‹æ­¢æ¸´ï¼Œç° åœ¨å·¥ä½œä¸€å¹´å¤šï¼Œä¹Ÿç®—æ˜¯æœ‰äº†ä¸€ç‚¹ç‚¹ç»æµæ”¶å…¥ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹è‡ªå·±é’Ÿæƒ…å·²ä¹…çš„ä¸€äº›å°ç©æ„ï¼Œåœ¨2016å¹´çš„æœ€åä¸€å¹´ï¼Œç›˜ç‚¹ä¸€ä¸‹è¿™ä¸€å¹´å‰æ‰‹çš„ç”µå­äº§å“ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="ç”µå­äº§å“" scheme="https://www.elietio.xyz/categories/%E7%94%B5%E5%AD%90%E4%BA%A7%E5%93%81/"/>
    
    
      <category term="ç”µå­äº§å“" scheme="https://www.elietio.xyz/tags/%E7%94%B5%E5%AD%90%E4%BA%A7%E5%93%81/"/>
    
  </entry>
  
</feed>
